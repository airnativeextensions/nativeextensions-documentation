"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[81368],{24103:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"permissions/system-settings","title":"System Settings","description":"Some permissions are controlled through the system settings dialogs and cannot be requested through the normal permission request process.","source":"@site/docs/permissions/system-settings.md","sourceDirName":"permissions","slug":"/permissions/system-settings","permalink":"/docs/permissions/system-settings","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"System Settings","sidebar_label":"System Settings"},"sidebar":"permissions","previous":{"title":"File and Folder Access","permalink":"/docs/permissions/file-folder-access"},"next":{"title":"Device Settings","permalink":"/docs/permissions/device-settings"}}');var t=n(74848),r=n(28453);const a={title:"System Settings",sidebar_label:"System Settings"},o=void 0,c={},l=[{value:"Write Settings",id:"write-settings",level:2},{value:"All Files Permission",id:"all-files-permission",level:2},{value:"Request All files access",id:"request-all-files-access",level:3},{value:"Request App All files access",id:"request-app-all-files-access",level:3},{value:"Check Granted",id:"check-granted",level:3}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"Some permissions are controlled through the system settings dialogs and cannot be requested through the normal permission request process."}),"\n",(0,t.jsx)(s.h2,{id:"write-settings",children:"Write Settings"}),"\n",(0,t.jsxs)(s.p,{children:["The permission to read and write to the system settings (",(0,t.jsx)(s.code,{children:"android.permission.WRITE_SETTINGS"}),") from Android API 23 now requires a user to explicitly grant this permission to an application through a permission management screen."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-xml",children:'<uses-permission android:name="android.permission.WRITE_SETTINGS" />\n'})}),"\n",(0,t.jsx)(s.p,{children:"You cannot request this permission but you can check the current state and show the screen for the user to change the setting."}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsx)(s.p,{children:"This permission is required for when you need to change system settings, such as the screen brightness as performed in the Application extension."})}),"\n",(0,t.jsxs)(s.p,{children:["To check the state of the permission use the ",(0,t.jsx)(s.code,{children:"canWrite"})," property on the ",(0,t.jsx)(s.code,{children:"settings"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-actionscript",children:"if (Permissions.instance.settings.canWrite)\n{\n    // App can write to system settings\n}\n"})}),"\n",(0,t.jsxs)(s.p,{children:["To display the permission management screen for the user to change this state, call the ",(0,t.jsx)(s.code,{children:"showManageSettingsScreen()"})," method:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-actionscript",children:"Permissions.instance.settings.showManageSettingsScreen();\n"})}),"\n",(0,t.jsxs)(s.p,{children:["There is also an event dispatched (",(0,t.jsx)(s.code,{children:"SettingsEvent.MANAGE_SETTINGS_CLOSED"}),") when this screen is closed:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-actionscript",children:"Permissions.instance.settings.addEventListener( \n    SettingsEvent.MANAGE_SETTINGS_CLOSED, \n    manageSettingsClosedHandler\n);\n\nPermissions.instance.settings.showManageSettingsScreen();\n\nfunction manageSettingsClosedHandler( event:SettingsEvent ):void \n{\n    // screen closed\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"all-files-permission",children:"All Files Permission"}),"\n",(0,t.jsx)(s.p,{children:"The majority of apps that require shared storage access can follow the best practices for sharing media files and sharing non-media files. However, some apps have a core use case that requires broad access of files on a device, but cannot do so efficiently using the privacy-friendly storage best practices. Android provides a special app access called All files access for these situations."}),"\n",(0,t.jsxs)(s.p,{children:["For more information on this permission see the Android documentation section on ",(0,t.jsx)(s.a,{href:"https://developer.android.com/training/data-storage/manage-all-files",children:"managing all files"}),"."]}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsxs)(s.p,{children:["For API versions < 30 don't require this additional permission and the following will always fail and ",(0,t.jsx)(s.code,{children:"isExternalStorageManager()"})," will always return ",(0,t.jsx)(s.code,{children:"true"})," indicating the application already has access."]})}),"\n",(0,t.jsx)(s.h3,{id:"request-all-files-access",children:"Request All files access"}),"\n",(0,t.jsx)(s.p,{children:"An app can request All files access from the user by doing the following:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Declare the ",(0,t.jsx)(s.code,{children:"android.permission.MANAGE_EXTERNAL_STORAGE"})," permission in the manifest."]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-xml",children:'<uses-permission android:name="android.permission.MANAGE_EXTERNAL_STORAGE" />\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Use the ",(0,t.jsx)(s.code,{children:"ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION"})," intent action to direct users to a system settings page where they can enable the following option for your app: Allow access to manage all files."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["With this extension you can trigger the ",(0,t.jsx)(s.code,{children:"ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION"})," by calling:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-actionscript",children:"Permissions.instance.settings\n    .showManageAllFileAccessPermission();\n"})}),"\n",(0,t.jsxs)(s.p,{children:["This will return ",(0,t.jsx)(s.code,{children:"true"})," if the intent was found and launched."]}),"\n",(0,t.jsxs)(s.p,{children:["Additionally you can listen for the ",(0,t.jsx)(s.code,{children:"SettingsEvent.MANAGE_ALL_FILES_ACCESS_PERMISSION_CLOSED"})," event to be notified of when the dialog is closed and focus returned to your application."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-actionscript",children:'Permissions.instance.settings.addEventListener( \n    SettingsEvent.MANAGE_ALL_FILES_ACCESS_PERMISSION_CLOSED, \n    closedHandler \n);\n\nfunction closedHandler( event:SettingsEvent ):void\n{\n    trace( "closed" );\n}\n'})}),"\n",(0,t.jsx)(s.h3,{id:"request-app-all-files-access",children:"Request App All files access"}),"\n",(0,t.jsxs)(s.p,{children:["You can also trigger the ",(0,t.jsx)(s.code,{children:"ACTION_MANAGE_APP_ALL_FILES_ACCESS_PERMISSION"})," intent which will direct the user straight to your application setting if available."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-actionscript",children:"Permissions.instance.settings\n    .showManageAppAllFileAccessPermission();\n"})}),"\n",(0,t.jsxs)(s.p,{children:["This will return ",(0,t.jsx)(s.code,{children:"true"})," if the intent was found and launched."]}),"\n",(0,t.jsxs)(s.p,{children:["Additionally you can listen for the ",(0,t.jsx)(s.code,{children:"SettingsEvent.MANAGE_APP_ALL_FILES_ACCESS_PERMISSION_CLOSED"})," event to be notified of when the dialog is closed and focus returned to your application."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-actionscript",children:'Permissions.instance.settings.addEventListener( \n    SettingsEvent.MANAGE_APP_ALL_FILES_ACCESS_PERMISSION_CLOSED, \n    closedHandler \n);\n\nfunction closedHandler( event:SettingsEvent ):void\n{\n    trace( "closed" );\n}\n'})}),"\n",(0,t.jsx)(s.h3,{id:"check-granted",children:"Check Granted"}),"\n",(0,t.jsxs)(s.p,{children:["To determine whether your app has been granted the ",(0,t.jsx)(s.code,{children:"MANAGE_EXTERNAL_STORAGE"})," permission, call ",(0,t.jsx)(s.code,{children:"Environment.isExternalStorageManager()"}),"."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-actionscript",children:"var granted:Boolean = \n    Permissions.instance.environment.isExternalStorageManager();\n"})})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>o});var i=n(96540);const t={},r=i.createContext(t);function a(e){const s=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);