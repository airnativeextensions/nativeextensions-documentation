(window.webpackJsonp=window.webpackJsonp||[]).push([[598],{1284:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/windows_redist_dlls_list_example-402034d4d3bdf33ba798f0481b8a2e95.png"},653:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return u}));var i=n(2),a=n(6),r=(n(0),n(853)),o={title:"Windows - Add the Extension",sidebar_label:"Add the Extension"},l={unversionedId:"pushnotifications/windows/add-the-extension",id:"pushnotifications/windows/add-the-extension",isDocsHomePage:!1,title:"Windows - Add the Extension",description:"There are several additional things to consider on Windows:",source:"@site/docs/pushnotifications/windows/add-the-extension.md",slug:"/pushnotifications/windows/add-the-extension",permalink:"/docs/pushnotifications/windows/add-the-extension",version:"current",sidebar_label:"Add the Extension",sidebar:"pushnotifications",previous:{title:"Migrating to v10.2",permalink:"/docs/pushnotifications/migrating-to-v10.2"},next:{title:"Windows Notification Service",permalink:"/docs/pushnotifications/windows/windows-notification-service"}},s=[{value:"Dependencies",id:"dependencies",children:[{value:".Net Framework",id:"net-framework",children:[]},{value:"C++ Redistributable",id:"c-redistributable",children:[]},{value:"Creating an Installer",id:"creating-an-installer",children:[]},{value:"Packaging DLLs",id:"packaging-dlls",children:[]}]}],c={rightToc:s};function u(e){var t=e.components,o=Object(a.a)(e,["components"]);return Object(r.b)("wrapper",Object(i.a)({},c,o,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"There are several additional things to consider on Windows:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"/docs/tutorials/windows-appx-packaging"}),"Appx Packaging")),Object(r.b)("li",{parentName:"ul"},"Additional Dll ",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"#dependencies"}),"Dependencies"))),Object(r.b)("h2",{id:"dependencies"},"Dependencies"),Object(r.b)("h3",{id:"net-framework"},".Net Framework"),Object(r.b)("p",null,"This extension requires v4.6 or higher of the .Net framework. This should come preinstalled on any Windows 10 or higher machine so if you are targetting those you should not have to do anything. If however you are targetting older versions of Windows you must ensure .Net v4.6 or higher is installed either manually or as part of an installer."),Object(r.b)("h3",{id:"c-redistributable"},"C++ Redistributable"),Object(r.b)("p",null,"The native code has a dependency on the Visual C++ 2017 Redistributable package. This package contains code that is required to run code developed using C++ in Visual Studio and is very common amongst Windows applications."),Object(r.b)("p",null,"There are two ways to ensure this is available to your application:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Create an installer that includes the redistributable installer;"),Object(r.b)("li",{parentName:"ul"},"Package the required DLL files from the redistributable with your application;")),Object(r.b)("p",null,"The first is the suggested method. Installing the redistributable via an installer allows it to be put into the windows update process, allowing bug fixes and security updates to be handled automatically."),Object(r.b)("p",null,"The second method is only advised if you need a complete standalone application, where you don't (or cannot) use an installation process. This requires you to package DLLs from the redistributable with your application. "),Object(r.b)("h3",{id:"creating-an-installer"},"Creating an Installer"),Object(r.b)("p",null,"There are many methods to create application installers and many tutorials available. We suggest you find a method suitable to your environment and application and utilise the tutorials online. "),Object(r.b)("p",null,"Some methods include:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"http://www.jrsoftware.org/isinfo.php"}),"Inno Setup")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"http://wixtoolset.org/"}),"Wix"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"http://wixedit.sourceforge.net"}),"WixEdit"))))),Object(r.b)("p",null,"Tutorials:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"http://www.adobe.com/devnet/air/articles/customize-setup-for-AIR-app-with-captive-runtime.html"}),"Generating a Windows installer"))),Object(r.b)("p",null,"You need to include the x86 c++ 2017 redistributable in the installer, there are many examples and documentation online to achieve this."),Object(r.b)("h3",{id:"packaging-dlls"},"Packaging DLLs"),Object(r.b)("p",null,"Packaging the DLLs into your application involves copying the DLLs specified below into your application root and including in your application package."),Object(r.b)("p",null,"The best option is to install Visual Studio 2017 and locate the ",Object(r.b)("inlineCode",{parentName:"p"},"Program Files[ (x86)]\\Microsoft Visual Studio\\2017\\edition\\VC\\Redist\\MSVC\\lib-version")," folder, eg: ",Object(r.b)("inlineCode",{parentName:"p"},"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Redist\\MSVC\\14.16.27012\\x86\\Microsoft.VC141.CRT")),Object(r.b)("p",null,"Alternatively, download and install the x86 redistributable from the ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads"}),"Microsoft website"),". This should install the DLLs into ",Object(r.b)("inlineCode",{parentName:"p"},"C:\\Windows\\System32")," folder. "),Object(r.b)("p",null,"Open the folder and copy the following DLLs to your application:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"msvcp140.dll")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"vcruntime140.dll"))),Object(r.b)("p",null,"If you are having issues locating these files, feel free to contact us for help."),Object(r.b)("p",null,Object(r.b)("img",{src:n(1284).default})),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"You should ensure you are allowed to package these files as per the Microsoft Software License terms but generally these are safe to redistribute subject to the license terms. More information here: ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/cpp/windows/redistributing-visual-cpp-files"}),"Redistributing Visual C++ Files")),Object(r.b)("p",{parentName:"blockquote"},"You should get legal advice if you are unsure. ")))}u.isMDXComponent=!0},853:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var i=n(0),a=n.n(i);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=a.a.createContext({}),u=function(e){var t=a.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=u(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(n),b=i,h=d["".concat(o,".").concat(b)]||d[b]||p[b]||r;return n?a.a.createElement(h,l(l({ref:t},c),{},{components:n})):a.a.createElement(h,l({ref:t},c))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=b;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var c=2;c<r;c++)o[c]=n[c];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);