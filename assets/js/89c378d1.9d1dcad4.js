"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[25444],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(n),h=a,m=d["".concat(l,".").concat(h)]||d[h]||p[h]||o;return n?i.createElement(m,r(r({ref:t},c),{},{components:n})):i.createElement(m,r({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var u=2;u<o;u++)r[u]=n[u];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2401:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return p}});var i=n(87462),a=n(63366),o=(n(67294),n(3905)),r=["components"],s={title:"Request Authorisation",sidebar_label:"Request Authorisation"},l=void 0,u={unversionedId:"camerarollextended/request-authorisation",id:"camerarollextended/request-authorisation",title:"Request Authorisation",description:"When you are going to be accessing the user's media you must check that your application has been allowed access.",source:"@site/docs/camerarollextended/request-authorisation.md",sourceDirName:"camerarollextended",slug:"/camerarollextended/request-authorisation",permalink:"/docs/camerarollextended/request-authorisation",draft:!1,tags:[],version:"current",frontMatter:{title:"Request Authorisation",sidebar_label:"Request Authorisation"},sidebar:"camerarollextended",previous:{title:"Add the Extension",permalink:"/docs/camerarollextended/add-the-extension"},next:{title:"Browse for an Asset",permalink:"/docs/camerarollextended/browse-for-an-asset"}},c={},p=[{value:"Limited Authorisation",id:"limited-authorisation",level:2},{value:"Usage Description",id:"usage-description",level:2},{value:"Device Settings",id:"device-settings",level:2}],d={toc:p};function h(e){var t=e.components,s=(0,a.Z)(e,r);return(0,o.kt)("wrapper",(0,i.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"When you are going to be accessing the user's media you must check that your application has been allowed access.\nTo this end the extension provides several helpers to check and request access to the camera roll.\nNormal permission rules apply here."),(0,o.kt)("p",null,"On Android these permissions are listed through the manifest additions.\nOn older versions of Android these permissions are accepted when the user installs the application.\nMore modern versions (Marshmallow 6 ","[v23]","+) require that you request the permissions similar to iOS.\nYou will still need to list them in your manifest and then follow the same code below as for iOS,\nexcept that on Android you will be able to ask multiple times.\nYou should respect the ",(0,o.kt)("inlineCode",{parentName:"p"},"SHOULD_EXPLAIN")," status by displaying additional information to your user\nabout why you require this functionality."),(0,o.kt)("p",null,"On iOS the user must be asked at runtime, which you only get one chance to ask,\nafter which you must direct the user to manually change the permissions in the settings."),(0,o.kt)("p",null,"The following code will work across both platforms:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},"CameraRollExtended.service.addEventListener( AuthorisationEvent.CHANGED, authorisationChangedHandler );\n\nswitch (CameraRollExtended.service.authorisationStatus())\n{\n    case AuthorisationStatus.SHOULD_EXPLAIN:\n    case AuthorisationStatus.NOT_DETERMINED:\n        // REQUEST AUTHORISATION: This will display the permission dialog\n        CameraRollExtended.service.requestAuthorisation();\n        return;\n    \n    case AuthorisationStatus.DENIED:\n    case AuthorisationStatus.UNKNOWN:\n    case AuthorisationStatus.RESTRICTED:\n        // ACCESS DENIED: You should inform your user appropriately\n        return;\n        \n    case AuthorisationStatus.AUTHORISED:\n    case AuthorisationStatus.LIMITED:\n        // AUTHORISED: Media access is available\n        // LIMITED: Media access is available for a subset of the library\n        break;                      \n}\n\n\nfunction authorisationChangedHandler( event:AuthorisationEvent ):void\n{\n    switch (event.status)\n    {\n        case AuthorisationStatus.SHOULD_EXPLAIN:\n            // Should display a reason you need this feature\n            break;\n            \n        case AuthorisationStatus.AUTHORISED:\n        case AuthorisationStatus.LIMITED:\n            // AUTHORISED: Media access is available\n            // LIMITED: Media access is available for a subset of the library\n            break;\n            \n        case AuthorisationStatus.RESTRICTED:\n        case AuthorisationStatus.DENIED:\n            // ACCESS DENIED: You should inform your user appropriately\n            break;\n    }\n}\n")),(0,o.kt)("h2",{id:"limited-authorisation"},"Limited Authorisation"),(0,o.kt)("p",null,"With iOS 14+ users' can now select a range of assets that your application has access to. This results in an authorisation status of ",(0,o.kt)("inlineCode",{parentName:"p"},"LIMITED"),". This still allows you to access photo data, however only for a subset of the users' entire library."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(36292).Z,width:"370",height:"800"})),(0,o.kt)("p",null,'When the user selects "Select Photos..." they are presented with a dialog that allows them to select the assets your application can access:'),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(40823).Z,width:"370",height:"800"})),(0,o.kt)("p",null,"When your application has this ",(0,o.kt)("inlineCode",{parentName:"p"},"LIMITED")," authorisation you can present the above selection dialog by calling ",(0,o.kt)("inlineCode",{parentName:"p"},"requestAuthorisation()"),". This gives your user the opportunity to change their selection giving you access to different assets."),(0,o.kt)("h2",{id:"usage-description"},"Usage Description"),(0,o.kt)("p",null,"You can customise the usage description messages as you see fit to suit your application. These messages are displayed in the main body area of the iOS authorisation dialog with the title and buttons being standard (and not customisable)."),(0,o.kt)("p",null,"The image below is an example of the authorisation dialog. The content ",(0,o.kt)("em",{parentName:"p"},'"Access to photo library is required to save images."')," is the usage description message you can set."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(85454).Z,width:"300",height:"209"})),(0,o.kt)("p",null,"You set these values through adding the usage description keys to your info additions or simply by setting up your configuration options in your ",(0,o.kt)("inlineCode",{parentName:"p"},"apm")," project. "),(0,o.kt)("p",null,"The text is controlled via the ",(0,o.kt)("inlineCode",{parentName:"p"},"NSPhotoLibraryUsageDescription")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"NSPhotoLibraryAddUsageDescription")," keys or their equivalent ",(0,o.kt)("inlineCode",{parentName:"p"},"apm")," config parameters. "),(0,o.kt)("h2",{id:"device-settings"},"Device Settings"),(0,o.kt)("p",null,"If your user has denied permission you can direct them to the device application settings to change them, particularly in the iOS case where you cannot force the request dialog to appear again."),(0,o.kt)("p",null,"To do this you use the ",(0,o.kt)("inlineCode",{parentName:"p"},"openDeviceSettings()")," function."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (CameraRollExtended.service.canOpenDeviceSettings)\n{\n    CameraRollExtended.service.openDeviceSettings();\n}\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"canOpenDeviceSettings")," property allows you to ensure the device and platform supports opening the settings and inform your user appropriately."))}h.isMDXComponent=!0},36292:function(e,t,n){t.Z=n.p+"assets/images/ios-permission-dialog-limited-7ed134560b3542fe67d0ce07f6080ede.png"},40823:function(e,t,n){t.Z=n.p+"assets/images/ios-permission-dialog-selection-4bfec4b7f8c3640b584ba25152cc293b.png"},85454:function(e,t,n){t.Z=n.p+"assets/images/ios-permission-dialog-ecb65e5a967ba94e0c5d02f886b944a6.png"}}]);