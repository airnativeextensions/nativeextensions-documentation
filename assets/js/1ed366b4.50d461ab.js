"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[98389],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),u=p(n),m=a,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||o;return n?i.createElement(h,s(s({ref:t},c),{},{components:n})):i.createElement(h,s({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=u;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r.mdxType="string"==typeof e?e:a,s[1]=r;for(var p=2;p<o;p++)s[p]=n[p];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},28047:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return r},metadata:function(){return p},toc:function(){return d}});var i=n(83117),a=n(80102),o=(n(67294),n(3905)),s=["components"],r={title:"Add the Extension - Windows",sidebar_label:"Add the Extension - Windows"},l=void 0,p={unversionedId:"notifications/add-the-extension---windows",id:"notifications/add-the-extension---windows",title:"Add the Extension - Windows",description:"There are several additional things to consider on Windows:",source:"@site/docs/notifications/add-the-extension---windows.md",sourceDirName:"notifications",slug:"/notifications/add-the-extension---windows",permalink:"/docs/notifications/add-the-extension---windows",draft:!1,tags:[],version:"current",frontMatter:{title:"Add the Extension - Windows",sidebar_label:"Add the Extension - Windows"},sidebar:"notifications",previous:{title:"Add the Extension",permalink:"/docs/notifications/add-the-extension"},next:{title:"Request Authorisation",permalink:"/docs/notifications/request-authorisation"}},c={},d=[{value:"Dependencies",id:"dependencies",level:2},{value:".Net Framework",id:"net-framework",level:3},{value:"C++ Redistributable",id:"c-redistributable",level:3},{value:"Creating an Installer",id:"creating-an-installer",level:3},{value:"Packaging DLLs",id:"packaging-dlls",level:3},{value:"AppxManifest",id:"appxmanifest",level:2}],u={toc:d};function m(e){var t=e.components,r=(0,a.Z)(e,s);return(0,o.kt)("wrapper",(0,i.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"There are several additional things to consider on Windows:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/tutorials/windows-appx-packaging"},"Appx Packaging")),(0,o.kt)("li",{parentName:"ul"},"Additional Dll ",(0,o.kt)("a",{parentName:"li",href:"#dependencies"},"Dependencies")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#appxmanifest"},"AppxManifest additions"))),(0,o.kt)("h2",{id:"dependencies"},"Dependencies"),(0,o.kt)("h3",{id:"net-framework"},".Net Framework"),(0,o.kt)("p",null,"This extension requires v4.6 or higher of the .Net framework. This should come preinstalled on any Windows 10 or higher machine so if you are targetting those you should not have to do anything. If however you are targetting older versions of Windows you must ensure .Net v4.6 or higher is installed either manually or as part of an installer."),(0,o.kt)("h3",{id:"c-redistributable"},"C++ Redistributable"),(0,o.kt)("p",null,"The native code has a dependency on the Visual C++ 2017 Redistributable package. This package contains code that is required to run code developed using C++ in Visual Studio and is very common amongst Windows applications."),(0,o.kt)("p",null,"There are two ways to ensure this is available to your application:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create an installer that includes the redistributable installer;"),(0,o.kt)("li",{parentName:"ul"},"Package the required DLL files from the redistributable with your application;")),(0,o.kt)("p",null,"The first is the suggested method. Installing the redistributable via an installer allows it to be put into the windows update process, allowing bug fixes and security updates to be handled automatically."),(0,o.kt)("p",null,"The second method is only advised if you need a complete standalone application, where you don't (or cannot) use an installation process. This requires you to package DLLs from the redistributable with your application. "),(0,o.kt)("h3",{id:"creating-an-installer"},"Creating an Installer"),(0,o.kt)("p",null,"There are many methods to create application installers and many tutorials available. We suggest you find a method suitable to your environment and application and utilise the tutorials online. "),(0,o.kt)("p",null,"Some methods include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://www.jrsoftware.org/isinfo.php"},"Inno Setup")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://wixtoolset.org/"},"Wix"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://wixedit.sourceforge.net"},"WixEdit"))))),(0,o.kt)("p",null,"Tutorials:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://www.adobe.com/devnet/air/articles/customize-setup-for-AIR-app-with-captive-runtime.html"},"Generating a Windows installer"))),(0,o.kt)("p",null,"You need to include the x86 c++ 2017 redistributable in the installer, there are many examples and documentation online to achieve this."),(0,o.kt)("h3",{id:"packaging-dlls"},"Packaging DLLs"),(0,o.kt)("p",null,"Packaging the DLLs into your application involves copying the DLLs specified below into your application root and including in your application package."),(0,o.kt)("p",null,"The best option is to install Visual Studio 2017 and locate the ",(0,o.kt)("inlineCode",{parentName:"p"},"Program Files[ (x86)]\\Microsoft Visual Studio\\2017\\edition\\VC\\Redist\\MSVC\\lib-version")," folder, eg: ",(0,o.kt)("inlineCode",{parentName:"p"},"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Redist\\MSVC\\14.16.27012\\x86\\Microsoft.VC141.CRT")),(0,o.kt)("p",null,"Alternatively, download and install the x86 redistributable from the ",(0,o.kt)("a",{parentName:"p",href:"https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads"},"Microsoft website"),". This should install the DLLs into ",(0,o.kt)("inlineCode",{parentName:"p"},"C:\\Windows\\System32")," folder. "),(0,o.kt)("p",null,"Open the folder and copy the following DLLs to your application:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"msvcp140.dll")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"vcruntime140.dll"))),(0,o.kt)("p",null,"If you are having issues locating these files, feel free to contact us for help."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(87856).Z,width:"168",height:"247"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"You should ensure you are allowed to package these files as per the Microsoft Software License terms but generally these are safe to redistribute subject to the license terms. More information here: ",(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/cpp/windows/redistributing-visual-cpp-files"},"Redistributing Visual C++ Files")),(0,o.kt)("p",{parentName:"blockquote"},"You should get legal advice if you are unsure. ")),(0,o.kt)("h2",{id:"appxmanifest"},"AppxManifest"),(0,o.kt)("p",null,"The windows notifications UWP support requires a couple of additions to your AppxManifest in order to receive notification events when the user interacts with the notification."),(0,o.kt)("p",null,'You will need to use the "Sign Separately" method to package your ',(0,o.kt)("inlineCode",{parentName:"p"},"appx")," as described ",(0,o.kt)("a",{parentName:"p",href:"/docs/tutorials/windows-appx-packaging-method1"},"here"),". "),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"If you don't make these changes then your application will not receive all the notification events."))),(0,o.kt)("p",null,'During the "Update Content" step you will need to edit the ',(0,o.kt)("inlineCode",{parentName:"p"},"AppxManifest.xml")," file contained in the pacakged files directory and add the following:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Declaration for ",(0,o.kt)("inlineCode",{parentName:"li"},"xmlns:com")),(0,o.kt)("li",{parentName:"ul"},"Declaration for ",(0,o.kt)("inlineCode",{parentName:"li"},"xmlns:desktop")),(0,o.kt)("li",{parentName:"ul"},"In the ",(0,o.kt)("inlineCode",{parentName:"li"},"IgnorableNamespaces")," attribute, ",(0,o.kt)("inlineCode",{parentName:"li"},"com")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"desktop")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"com:Extension")," for the COM activator"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"desktop:Extension")," for ",(0,o.kt)("inlineCode",{parentName:"li"},"windows.toastNotificationActivation")," to declare your toast activator")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<Package\n  ...\n  xmlns:com="http://schemas.microsoft.com/appx/manifest/com/windows10"\n  xmlns:desktop="http://schemas.microsoft.com/appx/manifest/desktop/windows10"\n  IgnorableNamespaces="... com desktop">\n  ...\n  <Applications>\n    <Application>\n      ...\n      <Extensions>\n\n        \x3c!--Register COM CLSID LocalServer32 registry key--\x3e\n        <com:Extension Category="windows.comServer">\n          <com:ComServer>\n            <com:ExeServer Executable="YOURAPPLICATION.exe" Arguments="-ToastActivated" DisplayName="Toast activator">\n              <com:Class Id="4db090a5-b5c9-4cbf-97a6-dd6a431f8749" DisplayName="Toast activator"/>\n            </com:ExeServer>\n          </com:ComServer>\n        </com:Extension>\n\n        \x3c!--Specify which CLSID to activate when toast clicked--\x3e\n        <desktop:Extension Category="windows.toastNotificationActivation">\n          <desktop:ToastNotificationActivation ToastActivatorCLSID="4db090a5-b5c9-4cbf-97a6-dd6a431f8749" /> \n        </desktop:Extension>\n\n      </Extensions>\n    </Application>\n  </Applications>\n </Package>\n')),(0,o.kt)("p",null,"You also need to replace ",(0,o.kt)("inlineCode",{parentName:"p"},"YOURAPPLICATION")," with the name of the ",(0,o.kt)("inlineCode",{parentName:"p"},"Executable")," attribute in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Application")," node."),(0,o.kt)("p",null,"For example, this is the entire ",(0,o.kt)("inlineCode",{parentName:"p"},"AppxManifest.xml")," for the distriqt test application:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="utf-8"?>\n<Package\n  xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10" \n  xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10" \n  xmlns:uap2="http://schemas.microsoft.com/appx/manifest/uap/windows10/2" \n  xmlns:uap3="http://schemas.microsoft.com/appx/manifest/uap/windows10/3" \n  xmlns:uap4="http://schemas.microsoft.com/appx/manifest/uap/windows10/4" \n  xmlns:rescap="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities" \n  xmlns:rescap3="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities/3" \n  xmlns:desktop="http://schemas.microsoft.com/appx/manifest/desktop/windows10" \n  xmlns:desktop2="http://schemas.microsoft.com/appx/manifest/desktop/windows10/2" \n  xmlns:desktop3="http://schemas.microsoft.com/appx/manifest/desktop/windows10/3" \n  xmlns:com="http://schemas.microsoft.com/appx/manifest/com/windows10" \n  xmlns:wincap3="http://schemas.microsoft.com/appx/manifest/foundation/windows10/windowscapabilities/3" \n  IgnorableNamespaces="uap4 wincap3 rescap3 desktop desktop2 desktop3 com">\n  <Identity Name="distriqt.airnativeextensions" ProcessorArchitecture="x86" Publisher="CN=38CAD93E-B1A7-480F-B65D-3545798BA205" Version="1.0.0.0" />\n  <Properties>\n    <DisplayName>distriqt.airnativeextensions</DisplayName>\n    <PublisherDisplayName>distriqt</PublisherDisplayName>\n    <Logo>Assets\\StoreLogo.png</Logo>\n  </Properties>\n  <Resources>\n    <Resource Language="en-us" />\n    <Resource uap:Scale="100" />\n    <Resource uap:Scale="125" />\n    <Resource uap:Scale="150" />\n    <Resource uap:Scale="200" />\n    <Resource uap:Scale="400" />\n  </Resources>\n  <Dependencies>\n    <TargetDeviceFamily Name="Windows.Desktop" MinVersion="10.0.14393.0" MaxVersionTested="10.0.16299.15" />\n  </Dependencies>\n  <Capabilities>\n    <rescap:Capability Name="runFullTrust" />\n    <Capability Name="internetClient" />\n  </Capabilities>\n  <Applications>\n    <Application Id="distriqt.airnativeextensions" Executable="testnotifications.exe" EntryPoint="Windows.FullTrustApplication">\n      <uap:VisualElements DisplayName="distriqt.airnativeextensions" Description="distriqt.airnativeextensions" BackgroundColor="transparent" Square150x150Logo="Assets\\Square150x150Logo.png" Square44x44Logo="Assets\\Square44x44Logo.png">\n        <uap:DefaultTile Wide310x150Logo="Assets\\Wide310x150Logo.png" Square310x310Logo="Assets\\Square310x310Logo.png" Square71x71Logo="Assets\\Square71x71Logo.png">\n          <uap:ShowNameOnTiles>\n            <uap:ShowOn Tile="square150x150Logo" />\n            <uap:ShowOn Tile="wide310x150Logo" />\n            <uap:ShowOn Tile="square310x310Logo" />\n          </uap:ShowNameOnTiles>\n        </uap:DefaultTile>\n      </uap:VisualElements>\n\n      <Extensions>\n        \x3c!--Register COM CLSID LocalServer32 registry key--\x3e\n        <com:Extension Category="windows.comServer">\n          <com:ComServer>\n            <com:ExeServer Executable="testnotifications.exe" Arguments="-ToastActivated" DisplayName="Toast activator">\n              <com:Class Id="aa28441a-fba8-45dc-887e-149495769502" DisplayName="Toast activator"/>\n            </com:ExeServer>\n          </com:ComServer>\n        </com:Extension>\n\n        \x3c!--Specify which CLSID to activate when toast clicked--\x3e\n        <desktop:Extension Category="windows.toastNotificationActivation">\n          <desktop:ToastNotificationActivation ToastActivatorCLSID="aa28441a-fba8-45dc-887e-149495769502" /> \n        </desktop:Extension>\n        \n      </Extensions>\n    </Application>\n  </Applications>\n</Package>\n')))}m.isMDXComponent=!0},87856:function(e,t,n){t.Z=n.p+"assets/images/windows_redist_dlls_list_example-402034d4d3bdf33ba798f0481b8a2e95.png"}}]);