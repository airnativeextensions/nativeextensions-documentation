(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{108:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return s})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return u}));var i=t(2),r=t(6),a=(t(0),t(815)),o={title:"Auth - Provider - Phone",sidebar_label:"Phone"},s={unversionedId:"firebase/auth/provider/phone",id:"firebase/auth/provider/phone",isDocsHomePage:!1,title:"Auth - Provider - Phone",description:"You can use Firebase Authentication to sign in a user by sending an SMS message to the user's phone.",source:"@site/docs/firebase/auth/provider/phone.md",slug:"/firebase/auth/provider/phone",permalink:"/docs/firebase/auth/provider/phone",version:"current",sidebar_label:"Phone",sidebar:"firebase",previous:{title:"Auth - Provider - Twitter",permalink:"/docs/firebase/auth/provider/twitter"},next:{title:"Auth - Provider - Custom Auth",permalink:"/docs/firebase/auth/provider/custom-auth"}},c=[{value:"Security Concerns",id:"security-concerns",children:[]},{value:"Enable Phone Number sign-in",id:"enable-phone-number-sign-in",children:[{value:"iOS Info Additions and Entitlements",id:"ios-info-additions-and-entitlements",children:[]}]},{value:"Send a Verification Code",id:"send-a-verification-code",children:[]},{value:"Create a Credential",id:"create-a-credential",children:[]},{value:"Sign In",id:"sign-in",children:[]},{value:"Next",id:"next",children:[]},{value:"Example",id:"example",children:[]}],l={rightToc:c};function u(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(i.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("p",null,"You can use Firebase Authentication to sign in a user by sending an SMS message to the user's phone.\nThe user signs in using a one-time code contained in the SMS message."),Object(a.b)("h3",{id:"security-concerns"},"Security Concerns"),Object(a.b)("p",null,"Authentication using only a phone number, while convenient, is less secure than the other available methods, because possession of a phone number can be easily transferred between users. Also, on devices with multiple user profiles, any user that can receive SMS messages can sign in to an account using the device's phone number."),Object(a.b)("p",null,"If you use phone number based sign-in in your app, you should offer it alongside more secure sign-in methods, and inform users of the security tradeoffs of using phone number sign-in."),Object(a.b)("h2",{id:"enable-phone-number-sign-in"},"Enable Phone Number sign-in"),Object(a.b)("p",null,"To sign in users by SMS, you must first enable the Phone Number sign-in method for your Firebase project:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"In the ",Object(a.b)("a",Object(i.a)({parentName:"li"},{href:"https://console.firebase.google.com/"}),"Firebase console"),", open the ",Object(a.b)("strong",{parentName:"li"},"Authentication")," section."),Object(a.b)("li",{parentName:"ol"},"On the ",Object(a.b)("strong",{parentName:"li"},"Sign-in Method")," page, enable the ",Object(a.b)("strong",{parentName:"li"},"Phone Number")," sign-in method."),Object(a.b)("li",{parentName:"ol"},"Ensure you have setup your APNs certificates for iOS"),Object(a.b)("li",{parentName:"ol"},"Add the application descriptor additions below")),Object(a.b)("h3",{id:"ios-info-additions-and-entitlements"},"iOS Info Additions and Entitlements"),Object(a.b)("p",null,"With iOS your app must be able to receive APNs notifications from Firebase.\nWhen you sign in a user with their phone number for the first time on a device,\nFirebase Authentication sends a silent push notification to the device to verify\nthat the phone number sign-in request comes from your app. (For this reason, phone\nnumber sign-in cannot be used on a simulator.)"),Object(a.b)("p",null,"So it's important that you've been through the steps to add your APNs certificates\nto your application in the Firebase console."),Object(a.b)("p",null,"If you are using FCM or Push Notifications you will already have already added these\nto your application descriptor however if you aren't you need to add the following\ntags to your iPhone Entitlements section in your application descriptor."),Object(a.b)("h4",{id:"development-example"},"Development Example"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-xml"}),"<InfoAdditions><![CDATA[\n]]></InfoAdditions>\n<requestedDisplayResolution>high</requestedDisplayResolution>\n<Entitlements><![CDATA[\n    \n    <key>get-task-allow</key>\n    <true/>\n    <key>aps-environment</key>\n    <string>development</string>\n    \n    <key>application-identifier</key>\n    <string>X5LW23Q6CJ.com.distriqt.test</string>\n    <key>keychain-access-groups</key>\n    <array>\n        <string>X5LW23Q6CJ.*</string>\n    </array>\n    \n]]></Entitlements>\n")),Object(a.b)("h4",{id:"production-example"},"Production Example"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-xml"}),"<InfoAdditions><![CDATA[\n]]></InfoAdditions>\n<requestedDisplayResolution>high</requestedDisplayResolution>\n<Entitlements><![CDATA[\n    \n    <key>aps-environment</key>\n    <string>production</string>\n    \n    <key>application-identifier</key>\n    <string>X5LW23Q6CJ.com.distriqt.test</string>\n    <key>keychain-access-groups</key>\n    <array>\n        <string>X5LW23Q6CJ.*</string>\n    </array>\n    \n]]></Entitlements>\n")),Object(a.b)("h2",{id:"send-a-verification-code"},"Send a Verification Code"),Object(a.b)("p",null,"To initiate phone number sign-in, present the user an interface that prompts them to type their phone number.\nLegal requirements vary, but as a best practice and to set expectations for your users, you should inform them\nthat if they use phone sign-in, they might receive an SMS message for verification and standard rates apply."),Object(a.b)("p",null,"Then, pass their phone number to the PhoneAuthProvider.verifyPhoneNumber method to request that Firebase\nverify the user's phone number. For example:"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-actionscript"}),"FirebaseAuth.service.verifyPhoneNumber( phoneNumber, 60 );\n")),Object(a.b)("p",null,"This call will dispatch one of 3 potential events from ",Object(a.b)("inlineCode",{parentName:"p"},"FirebaseAuthEvent"),":"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"VERIFY_PHONE_NUMBER_FAILED"),": An error occurred. You can check the event for more details"),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"VERIFY_PHONE_NUMBER_CODE_SENT"),": The SMS code has been sent to the specified phone number - you should ask the user to enter this number as below"),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"SIGNIN_WITH_CREDENTIAL_COMPLETE"),": It is possible at this point that the authentication completes due to either:",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},Object(a.b)("strong",{parentName:"li"},"Instant verification"),": In some cases the phone number can be instantly verified without needing to send or enter a verification code."),Object(a.b)("li",{parentName:"ul"},Object(a.b)("strong",{parentName:"li"},"Auto-retrieval"),": On some devices Google Play services can automatically detect the incoming verification SMS and perform verificaiton without user action")))),Object(a.b)("h2",{id:"create-a-credential"},"Create a Credential"),Object(a.b)("p",null,"After the user enters the verification code that Firebase sent to the user's phone, create a ",Object(a.b)("inlineCode",{parentName:"p"},"PhoneAuthCredential")," object, using the verification code and the verification ID that was returned."),Object(a.b)("p",null,"To create a credential call ",Object(a.b)("inlineCode",{parentName:"p"},"PhoneAuthProvider.getCredential"),":"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-actionscript"}),"var credential:PhoneAuthCredential = PhoneAuthProvider.getCredential( verificationId, code );\n")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"To prevent abuse, Firebase enforces a limit on the number of SMS messages that can be sent to a single\nphone number within a period of time. If you exceed this limit, phone number verification requests might\nbe throttled. If you encounter this issue during development, use a different phone number for testing,\nor try the request again later.")),Object(a.b)("h2",{id:"sign-in"},"Sign In"),Object(a.b)("p",null,"After you get a PhoneAuthCredential object you can call:"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-actionscript"}),"FirebaseAuth.service.signInWithCredential( credential );\n")),Object(a.b)("p",null,"This will dispatch a ",Object(a.b)("inlineCode",{parentName:"p"},"FirebaseAuthEvent.SIGNIN_WITH_CREDENTIAL_COMPLETE")," event when complete\nand you can check the value of ",Object(a.b)("inlineCode",{parentName:"p"},"success")," to see whether it succeeded. "),Object(a.b)("h2",{id:"next"},"Next"),Object(a.b)("p",null,"After a user signs in for the first time, a new user account is created and linked to the credentials \u2014\nthat is, the user name and password, phone number, or auth provider information\u2014the user signed in with.\nThis new account is stored as part of your Firebase project, and can be used to identify a user across\nevery app in your project, regardless of how the user signs in."),Object(a.b)("h2",{id:"example"},"Example"),Object(a.b)("p",null,"The following example shows the complete sign in process, using a simple text input dialog\n(from the Dialog ANE) to gather the SMS code from the user."),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-actionscript"}),'FirebaseAuth.service.addEventListener( FirebaseAuthEvent.VERIFY_PHONE_NUMBER_FAILED, verifyPhoneNumber_failedHandler );\nFirebaseAuth.service.addEventListener( FirebaseAuthEvent.VERIFY_PHONE_NUMBER_CODE_SENT, verifyPhoneNumber_codeSentHandler );\nFirebaseAuth.service.addEventListener( FirebaseAuthEvent.SIGNIN_WITH_CREDENTIAL_COMPLETE, signInWithPhoneNumber_completeHandler );\n\nFirebaseAuth.service.verifyPhoneNumber( phoneNumber, 60 );\n\nvar verificationId:String;\n\nfunction verifyPhoneNumber_failedHandler( event:FirebaseAuthEvent ):void \n{\n    // An error occurred\n}\n\nfunction verifyPhoneNumber_codeSentHandler( event:FirebaseAuthEvent ):void \n{\n    //  Here we should save the verification id somewhere persistent\n    //  in case the application crashes or something else occurs while\n    //  the user is getting the sms code from their message application.\n    //\n    //  Then we should display an input for the sms code\n    \n    verificationId = event.verificationId;\n\n    //\n    //  Then we should display an input for the sms code\n\n    //  Here we use a simple dialog from the Dialog ANE:\n    var dialogView:DialogView = Dialog.service.create(\n            new AlertBuilder(true)\n                    .setTitle("Enter SMS Code")\n                    .addTextField( "", "SMS Code" )\n                    .addOption("OK", DialogAction.STYLE_POSITIVE)\n                    .build()\n    );\n    dialogView.addEventListener( DialogViewEvent.CLOSED, dialogClosedHandler );\n    dialogView.show();\n}\n\nfunction dialogClosedHandler( event:DialogViewEvent ):void\n{\n    var smsCode:String = event.values[0];\n\n    // Start the sign in with the user entered SMS code\n    signInWithPhoneNumber( verificationId, smsCode );\n}\n\n\nfunction signInWithPhoneNumber( verificationId:String, smsCode:String ):void\n{\n    var credential:PhoneAuthCredential = PhoneAuthProvider.getCredential( verificationId, smsCode );\n    FirebaseAuth.service.signInWithCredential( credential );\n}\n\n\nfunction signInWithPhoneNumber_completeHandler( event:FirebaseAuthEvent ):void \n{\n    trace( "signInWithPhoneNumber: complete: " + event.success );\n\n    if (event.success)\n    {\n        // You will now have a valid user\n        var user:FirebaseUser = FirebaseAuth.service.getCurrentUser();\n    }\n}\n')))}u.isMDXComponent=!0},815:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return p}));var i=t(0),r=t.n(i);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=r.a.createContext({}),u=function(e){var n=r.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=u(e.components);return r.a.createElement(l.Provider,{value:n},e.children)},h={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},b=r.a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,o=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=u(t),b=i,p=d["".concat(o,".").concat(b)]||d[b]||h[b]||a;return t?r.a.createElement(p,s(s({ref:n},l),{},{components:t})):r.a.createElement(p,s({ref:n},l))}));function p(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=b;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var l=2;l<a;l++)o[l]=t[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);