"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[4959],{28453:(n,e,i)=>{i.d(e,{R:()=>d,x:()=>t});var o=i(96540);const a={},r=o.createContext(a);function d(n){const e=o.useContext(r);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:d(n.components),o.createElement(r.Provider,{value:e},n.children)}},49565:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>s,contentTitle:()=>t,default:()=>m,frontMatter:()=>d,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"pushnotifications/migrating-to-v10.2","title":"Migrating to v10.2","description":"v10.2 brings the latest release of OneSignal:","source":"@site/docs/pushnotifications/migrating-to-v10.2.md","sourceDirName":"pushnotifications","slug":"/pushnotifications/migrating-to-v10.2","permalink":"/docs/pushnotifications/migrating-to-v10.2","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Migrating to v10.2","sidebar_label":"Migrating to v10.2"},"sidebar":"pushnotifications","previous":{"title":"Migrating to v11.2","permalink":"/docs/pushnotifications/migrating-to-v11.2"},"next":{"title":"Add the Extension","permalink":"/docs/pushnotifications/windows/add-the-extension"}}');var a=i(74848),r=i(28453);const d={title:"Migrating to v10.2",sidebar_label:"Migrating to v10.2"},t=void 0,s={},c=[{value:"Payload",id:"payload",level:2},{value:"Update Dependencies",id:"update-dependencies",level:2},{value:"Update Manifest Additions",id:"update-manifest-additions",level:2}];function l(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.p,{children:"v10.2 brings the latest release of OneSignal:"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Android v4.1.0"}),"\n",(0,a.jsx)(e.li,{children:"iOS v3.1.1"}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:["If you are updating from a version < 10 make sure you check out the changes for Firebase Cloud Messaging as well in the ",(0,a.jsx)(e.a,{href:"/docs/pushnotifications/migrating-to-v10.1",children:"Migrating to v10.1"})]}),"\n",(0,a.jsxs)(e.p,{children:["We have managed to hide any major implementation changes within the native code however there are some changes to the ",(0,a.jsx)(e.a,{href:"#update-dependencies",children:"dependencies"}),", to the ",(0,a.jsx)(e.a,{href:"#update-manifest-additions",children:"manifest additions"})," and to the ",(0,a.jsx)(e.a,{href:"#payload",children:"payload data structure"}),"."]}),"\n",(0,a.jsx)(e.h2,{id:"payload",children:"Payload"}),"\n",(0,a.jsxs)(e.admonition,{title:"Payload",type:"caution",children:[(0,a.jsx)(e.p,{children:"The payload structure has changed due to a change in the data returned by OneSignal for a notification. Rather than reformatting to matching a legacy structure we have taken the approach to return the data as per OneSignal's design."}),(0,a.jsx)(e.p,{children:"Importantly you will need to update any code you have that relies on the structure of the OneSignal notification payload."})]}),"\n",(0,a.jsx)(e.p,{children:"For example on Android the previous payload structure was:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-json",children:'{\n    "isAppInFocus":true,\n    "shown":false,\n    "androidNotificationId":0,\n    "displayType":0,\n    "payload": {\n        "notificationId":"bb5fd966-4ac2-4070-bcec-d66fb0fbab1f",\n        "title":"asdf",\n        "body":"asdfasdf",\n        "additionalData":{\n            \n        },\n        "lockScreenVisibility":1,\n        "actionButtons":[\n            \n            ],\n        "fromProjectNumber":"616489336300",\n        "priority":5,\n        "rawPayload":"{\\"google.delivered_priority\\":\\"normal\\",\\"google.sent_time\\":1612744363074,\\"google.ttl\\":259200,\\"google.original_priority\\":\\"normal\\",\\"custom\\":\\"{\\\\\\"i\\\\\\":\\\\\\"bb5fd966-4ac2-4070-bcec-d66fb0fbab1f\\\\\\",\\\\\\"a\\\\\\":{\\\\\\"actionButtons\\\\\\":[],\\\\\\"actionId\\\\\\":\\\\\\"__DEFAULT__\\\\\\"}}\\",\\"pri\\":\\"5\\",\\"vis\\":\\"1\\",\\"from\\":\\"616489336300\\",\\"alert\\":\\"asdfasdf\\",\\"title\\":\\"asdf\\",\\"google.message_id\\":\\"0:1612744363095757%32d7332ff9fd7ecd\\",\\"google.c.sender.id\\":\\"616489336300\\"}"\n    }\n}\n'})}),"\n",(0,a.jsx)(e.p,{children:"The new payload structure is:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-json",children:'{\n    "androidNotificationId":0,\n    "groupedNotifications":[\n        \n    ],\n    "notificationId":"bb5fd966-4ac2-4070-bcec-d66fb0fbab1f",\n    "templateName":"",\n    "templateId":"",\n    "title":"asdf",\n    "body":"asdfasdf",\n    "lockScreenVisibility":1,\n    "fromProjectNumber":"616489336300",\n    "priority":5,\n    "additionalData":{\n        \n    },\n    "actionButtons":[\n        \n    ],\n    "rawPayload":"{\\"google.delivered_priority\\":\\"normal\\",\\"google.sent_time\\":1612744363074,\\"google.ttl\\":259200,\\"google.original_priority\\":\\"normal\\",\\"custom\\":\\"{\\\\\\"i\\\\\\":\\\\\\"bb5fd966-4ac2-4070-bcec-d66fb0fbab1f\\\\\\",\\\\\\"a\\\\\\":{\\\\\\"actionButtons\\\\\\":[],\\\\\\"actionId\\\\\\":\\\\\\"__DEFAULT__\\\\\\"}}\\",\\"pri\\":\\"5\\",\\"vis\\":\\"1\\",\\"from\\":\\"616489336300\\",\\"alert\\":\\"asdfasdf\\",\\"title\\":\\"asdf\\",\\"google.message_id\\":\\"0:1612744363095757%32d7332ff9fd7ecd\\",\\"google.c.sender.id\\":\\"616489336300\\"}"\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"update-dependencies",children:"Update Dependencies"}),"\n",(0,a.jsx)(e.p,{children:"You need to ensure you have the following extensions in your application. There are several new extensions included here, and please ensure you have updated all the dependencies to the same releases:"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.distriqt.Core"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.distriqt.playservices.Base"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.distriqt.playservices.AdsIdentifier"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.distriqt.playservices.CloudMessaging"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.google.firebase.core"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.google.android.datatransport"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.google.dagger"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.google.guava"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"androidx.appcompat"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"androidx.browser"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"androidx.cardview"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"androidx.core"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"androidx.recyclerview"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"androidx.room"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"androidx.vectordrawable"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"androidx.work"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"com.jetbrains.kotlin"})}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:["See ",(0,a.jsx)(e.a,{href:"/docs/pushnotifications/onesignal/add-the-extension#install",children:"Add Required ANEs"})," for more information."]}),"\n",(0,a.jsx)(e.h2,{id:"update-manifest-additions",children:"Update Manifest Additions"}),"\n",(0,a.jsx)(e.p,{children:"We suggest removing any OneSignal references in your manifest and adding the following. The changes have been significant!"}),"\n",(0,a.jsxs)(e.p,{children:["You must replace ",(0,a.jsx)(e.code,{children:"APPLICATION_PACKAGE"})," with your AIR application's Java package name, something like ",(0,a.jsx)(e.code,{children:"air.com.distriqt.test"}),"."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-xml",children:'        \x3c!-- ONE SIGNAL --\x3e\n        <meta-data android:name="com.onesignal.NotificationServiceExtension" android:value="com.distriqt.extension.pushnotifications.onesignal.NotificationServiceExtension" />\n\n        <receiver\n            android:name="com.onesignal.FCMBroadcastReceiver"\n            android:permission="com.google.android.c2dm.permission.SEND" >\n\n            \x3c!-- High priority so OneSignal payloads can be filtered from other FCM receivers --\x3e\n            <intent-filter android:priority="999" >\n                <action android:name="com.google.android.c2dm.intent.RECEIVE" />\n                <category android:name="APPLICATION_PACKAGE" />\n            </intent-filter>\n        </receiver>\n\n        <service\n            android:name="com.onesignal.HmsMessageServiceOneSignal"\n            android:exported="false" >\n            <intent-filter>\n                <action android:name="com.huawei.push.action.MESSAGING_EVENT" />\n            </intent-filter>\n        </service>\n\n        <activity\n            android:name="com.onesignal.NotificationOpenedActivityHMS"\n            android:noHistory="true"\n            android:theme="@android:style/Theme.Translucent.NoTitleBar" >\n            <intent-filter>\n                <action android:name="android.intent.action.VIEW" />\n            </intent-filter>\n        </activity>\n\n        <service android:name="com.onesignal.FCMIntentService" />\n        <service\n            android:name="com.onesignal.FCMIntentJobService"\n            android:permission="android.permission.BIND_JOB_SERVICE" />\n        <service\n            android:name="com.onesignal.FocusDelaySyncService"\n            android:stopWithTask="true" />\n        <service\n            android:name="com.onesignal.FocusDelaySyncJobService"\n            android:permission="android.permission.BIND_JOB_SERVICE" />\n        <service\n            android:name="com.onesignal.SyncService"\n            android:stopWithTask="true" />\n        <service\n            android:name="com.onesignal.SyncJobService"\n            android:permission="android.permission.BIND_JOB_SERVICE" />\n\n        <activity\n            android:name="com.onesignal.PermissionsActivity"\n            android:theme="@android:style/Theme.Translucent.NoTitleBar" />\n\n        <receiver android:name="com.onesignal.NotificationDismissReceiver" />\n        <receiver android:name="com.onesignal.BootUpReceiver" >\n            <intent-filter>\n                <action android:name="android.intent.action.BOOT_COMPLETED" />\n                <action android:name="android.intent.action.QUICKBOOT_POWERON" />\n            </intent-filter>\n        </receiver>\n        <receiver android:name="com.onesignal.UpgradeReceiver" >\n            <intent-filter>\n                <action android:name="android.intent.action.MY_PACKAGE_REPLACED" />\n            </intent-filter>\n        </receiver>\n\n        <activity\n            android:name="com.onesignal.NotificationOpenedReceiver"\n            android:noHistory="true"\n            android:theme="@android:style/Theme.Translucent.NoTitleBar" />\n\n        \x3c!--\n                FirebaseMessagingService performs security checks at runtime,\n                but set to not exported to explicitly avoid allowing another app to call it.\n        --\x3e\n        <service\n            android:name="com.google.firebase.messaging.FirebaseMessagingService"\n            android:exported="false" >\n            <intent-filter android:priority="-500" >\n                <action android:name="com.google.firebase.MESSAGING_EVENT" />\n            </intent-filter>\n        </service>\n\n\n        \x3c!-- FIREBASE CORE --\x3e\n        \x3c!-- common --\x3e\n        <service\n            android:name="com.google.firebase.components.ComponentDiscoveryService"\n            android:directBootAware="true"\n            android:exported="false" >\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.installations.FirebaseInstallationsRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.iid.Registrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.messaging.FirebaseMessagingRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.datatransport.TransportRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n        </service>\n        <provider\n            android:name="com.google.firebase.provider.FirebaseInitProvider"\n            android:authorities="APPLICATION_PACKAGE.firebaseinitprovider"\n            android:exported="false"\n            android:initOrder="100" />\n\n\n        \x3c!-- iid --\x3e\n        <receiver\n            android:name="com.google.firebase.iid.FirebaseInstanceIdReceiver"\n            android:exported="true"\n            android:permission="com.google.android.c2dm.permission.SEND" >\n            <intent-filter>\n                <action android:name="com.google.android.c2dm.intent.RECEIVE" />\n            </intent-filter>\n        </receiver>\n\n\n        \x3c!-- androidx.work --\x3e\n        <provider\n            android:name="androidx.work.impl.WorkManagerInitializer"\n            android:authorities="APPLICATION_PACKAGE.workmanager-init"\n            android:directBootAware="false"\n            android:exported="false"\n            android:multiprocess="true" />\n\n        <service\n            android:name="androidx.work.impl.background.systemalarm.SystemAlarmService"\n            android:directBootAware="false"\n            android:enabled="@bool/enable_system_alarm_service_default"\n            android:exported="false" />\n        <service\n            android:name="androidx.work.impl.background.systemjob.SystemJobService"\n            android:directBootAware="false"\n            android:enabled="@bool/enable_system_job_service_default"\n            android:exported="true"\n            android:permission="android.permission.BIND_JOB_SERVICE" />\n        <service\n            android:name="androidx.work.impl.foreground.SystemForegroundService"\n            android:directBootAware="false"\n            android:enabled="@bool/enable_system_foreground_service_default"\n            android:exported="false" />\n\n        <receiver\n            android:name="androidx.work.impl.utils.ForceStopRunnable$BroadcastReceiver"\n            android:directBootAware="false"\n            android:enabled="true"\n            android:exported="false" />\n        <receiver\n            android:name="androidx.work.impl.background.systemalarm.ConstraintProxy$BatteryChargingProxy"\n            android:directBootAware="false"\n            android:enabled="false"\n            android:exported="false" >\n            <intent-filter>\n                <action android:name="android.intent.action.ACTION_POWER_CONNECTED" />\n                <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED" />\n            </intent-filter>\n        </receiver>\n        <receiver\n            android:name="androidx.work.impl.background.systemalarm.ConstraintProxy$BatteryNotLowProxy"\n            android:directBootAware="false"\n            android:enabled="false"\n            android:exported="false" >\n            <intent-filter>\n                <action android:name="android.intent.action.BATTERY_OKAY" />\n                <action android:name="android.intent.action.BATTERY_LOW" />\n            </intent-filter>\n        </receiver>\n        <receiver\n            android:name="androidx.work.impl.background.systemalarm.ConstraintProxy$StorageNotLowProxy"\n            android:directBootAware="false"\n            android:enabled="false"\n            android:exported="false" >\n            <intent-filter>\n                <action android:name="android.intent.action.DEVICE_STORAGE_LOW" />\n                <action android:name="android.intent.action.DEVICE_STORAGE_OK" />\n            </intent-filter>\n        </receiver>\n        <receiver\n            android:name="androidx.work.impl.background.systemalarm.ConstraintProxy$NetworkStateProxy"\n            android:directBootAware="false"\n            android:enabled="false"\n            android:exported="false" >\n            <intent-filter>\n                <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />\n            </intent-filter>\n        </receiver>\n        <receiver\n            android:name="androidx.work.impl.background.systemalarm.RescheduleReceiver"\n            android:directBootAware="false"\n            android:enabled="false"\n            android:exported="false" >\n            <intent-filter>\n                <action android:name="android.intent.action.BOOT_COMPLETED" />\n                <action android:name="android.intent.action.TIME_SET" />\n                <action android:name="android.intent.action.TIMEZONE_CHANGED" />\n            </intent-filter>\n        </receiver>\n        <receiver\n            android:name="androidx.work.impl.background.systemalarm.ConstraintProxyUpdateReceiver"\n            android:directBootAware="false"\n            android:enabled="@bool/enable_system_alarm_service_default"\n            android:exported="false" >\n            <intent-filter>\n                <action android:name="androidx.work.impl.background.systemalarm.UpdateProxies" />\n            </intent-filter>\n        </receiver>\n        <receiver\n            android:name="androidx.work.impl.diagnostics.DiagnosticsReceiver"\n            android:directBootAware="false"\n            android:enabled="true"\n            android:exported="true"\n            android:permission="android.permission.DUMP" >\n            <intent-filter>\n                <action android:name="androidx.work.diagnostics.REQUEST_DIAGNOSTICS" />\n            </intent-filter>\n        </receiver>\n\n        \x3c!-- com.google.android.datatransport --\x3e\n        <service\n            android:name="com.google.android.datatransport.runtime.backends.TransportBackendDiscovery"\n            android:exported="false" >\n            <meta-data\n                android:name="backend:com.google.android.datatransport.cct.CctBackendFactory"\n                android:value="cct" />\n        </service>\n        <service\n            android:name="com.google.android.datatransport.runtime.scheduling.jobscheduling.JobInfoSchedulerService"\n            android:exported="false"\n            android:permission="android.permission.BIND_JOB_SERVICE" >\n        </service>\n\n        <receiver\n            android:name="com.google.android.datatransport.runtime.scheduling.jobscheduling.AlarmManagerSchedulerBroadcastReceiver"\n            android:exported="false" />\n\n        <service\n            android:name="androidx.room.MultiInstanceInvalidationService"\n            android:directBootAware="true"\n            android:exported="false" />\n'})}),"\n",(0,a.jsxs)(e.p,{children:["For more information see the detail in the ",(0,a.jsx)(e.a,{href:"/docs/pushnotifications/onesignal/add-the-extension#application-descriptor",children:"Manifest Additions"})," section."]})]})}function m(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(l,{...n})}):l(n)}}}]);