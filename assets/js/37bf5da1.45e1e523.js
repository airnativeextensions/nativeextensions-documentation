(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[90505],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return c},kt:function(){return p}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),h=d(a),p=r,m=h["".concat(s,".").concat(p)]||h[p]||u[p]||i;return a?n.createElement(m,l(l({ref:t},c),{},{components:a})):n.createElement(m,l({ref:t},c))}));function p(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=h;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var d=2;d<i;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},80896:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return l},metadata:function(){return o},toc:function(){return s},default:function(){return c}});var n=a(22122),r=a(19756),i=(a(67294),a(3905)),l={title:"Database - Lists",sidebar_label:"Lists"},o={unversionedId:"firebase/database/lists",id:"firebase/database/lists",isDocsHomePage:!1,title:"Database - Lists",description:"Working with Lists of Data",source:"@site/docs/firebase/database/lists.md",sourceDirName:"firebase/database",slug:"/firebase/database/lists",permalink:"/docs/firebase/database/lists",version:"current",sidebar_label:"Lists",frontMatter:{title:"Database - Lists",sidebar_label:"Lists"},sidebar:"firebase",previous:{title:"Database - Transactions",permalink:"/docs/firebase/database/transactions"},next:{title:"Database - Offline",permalink:"/docs/firebase/database/offline"}},s=[{value:"Working with Lists of Data",id:"working-with-lists-of-data",children:[{value:"Get a DatabaseReference",id:"get-a-databasereference",children:[]}]},{value:"Read and Write Lists",id:"read-and-write-lists",children:[{value:"Append to a list of data",id:"append-to-a-list-of-data",children:[]},{value:"Listen for child events",id:"listen-for-child-events",children:[]},{value:"Listen for value events",id:"listen-for-value-events",children:[]}]},{value:"Sorting and filtering data",id:"sorting-and-filtering-data",children:[{value:"Sort data",id:"sort-data",children:[]},{value:"Filtering data",id:"filtering-data",children:[]},{value:"How query data is ordered",id:"how-query-data-is-ordered",children:[]}]}],d={toc:s};function c(e){var t=e.components,a=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"working-with-lists-of-data"},"Working with Lists of Data"),(0,i.kt)("p",null,"The following covers working with lists of data, including pushing values,\nchild events, and, sorting and filtering the data."),(0,i.kt)("h3",{id:"get-a-databasereference"},"Get a DatabaseReference"),(0,i.kt)("p",null,"To read and write data from the database, you need an instance of ",(0,i.kt)("inlineCode",{parentName:"p"},"DatabaseReference"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'var ref:DatabaseReference = FirebaseDatabase.service.getReference( "list" );\n')),(0,i.kt)("h2",{id:"read-and-write-lists"},"Read and Write Lists"),(0,i.kt)("h3",{id:"append-to-a-list-of-data"},"Append to a list of data"),(0,i.kt)("p",null,"Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"push()")," method to append data to a list in multiuser applications.\nThe ",(0,i.kt)("inlineCode",{parentName:"p"},"push()")," method generates a unique key every time a new child is added\nto the specified Firebase reference. By using these auto-generated keys for\neach new element in the list, several clients can add children to the same\nlocation at the same time without write conflicts. The unique key generated\nby ",(0,i.kt)("inlineCode",{parentName:"p"},"push()")," is based on a timestamp, so list items are automatically ordered\nchronologically."),(0,i.kt)("p",null,"You can use the reference to the new data returned by the ",(0,i.kt)("inlineCode",{parentName:"p"},"push()")," method to\nget the value of the child's auto-generated key or set data for the child.\nCalling ",(0,i.kt)("inlineCode",{parentName:"p"},"getKey()")," on a ",(0,i.kt)("inlineCode",{parentName:"p"},"push()")," reference returns the value of the\nauto-generated key."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'var ref:DatabaseReference = FirebaseDatabase.service.getReference( "list" );\nvar item:DatabaseReference = ref.push();\n\nitem.child("name").setValue( "a pushed item" );\nitem.child("count").setValue( 100 );\n')),(0,i.kt)("h3",{id:"listen-for-child-events"},"Listen for child events"),(0,i.kt)("p",null,"When working with lists, your application should listen for child events\nrather than the value events used for single objects."),(0,i.kt)("p",null,"Child events are triggered in response to specific operations that happen\nto the children of a node from an operation such as a new child added through\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"push()")," method or a child being updated through the ",(0,i.kt)("inlineCode",{parentName:"p"},"updateChildren()"),"\nmethod. Each of these together can be useful for listening to changes to a\nspecific node in a database."),(0,i.kt)("p",null,"The child events are defined in the ",(0,i.kt)("inlineCode",{parentName:"p"},"DatabaseReferenceChildEvent")," class:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CHILD_ADDED"),": Retrieve lists of items or listen for additions to a list of items"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CHILD_CHANGED"),": Listen for changes to the items in a list"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CHILD_REMOVED"),": Listen for items being removed from a list"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CHILD_MOVED"),": Listen for changes to the order of items in an ordered list"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ERROR"),": Errors occurring with child operations")),(0,i.kt)("p",null,"These events will contain the static (immutable) snapshot at the child location\nand it's position in the list or information about the error."),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'var ref:DatabaseReference = FirebaseDatabase.service.getReference( "list" );\nref.addEventListener( DatabaseReferenceChildEvent.CHILD_ADDED, childAddedHandler );\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'private function childAddedHandler( event:DatabaseReferenceChildEvent ):void\n{\n    trace( "child added::"+event.snapshot.key +"::"+event.previousChildName );\n}\n')),(0,i.kt)("h3",{id:"listen-for-value-events"},"Listen for value events"),(0,i.kt)("p",null,"While using a listening for child events  is the recommended way to read lists\nof data, there are situations where attaching a value listener to a list reference\nis useful."),(0,i.kt)("p",null,"Attaching a ",(0,i.kt)("inlineCode",{parentName:"p"},"DatabaseReferenceEvent.VALUE_CHANGED")," event listener to a list of\ndata will return the entire list of data as a single DataSnapshot, which you can\nthen loop over to access individual children"),(0,i.kt)("p",null,"Even when there is only a single match for the query, the snapshot is still a list;\nit just contains a single item. To access the item, you need to loop over the result:"),(0,i.kt)("p",null,"For example: "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'var ref:DatabaseReference = FirebaseDatabase.service.getReference( "list" );\nref.addEventListener( DatabaseReferenceEvent.VALUE_CHANGED, valueChangedHandler );\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'private function valueChangedHandler( event:DatabaseReferenceEvent ):void\n{\n    trace( "child added::"+event.snapshot.key );\n    for each (var child:DataSnapshot in event.snapshot.children)\n    {\n        trace( JSON.stringify( child.value ));\n    }\n}\n')),(0,i.kt)("p",null,"This pattern can be useful when you want to fetch all children of a list in a\nsingle operation, rather than listening for additional child events."),(0,i.kt)("h2",{id:"sorting-and-filtering-data"},"Sorting and filtering data"),(0,i.kt)("p",null,"You can use the Realtime Database Query class to retrieve data sorted by key,\nby value, or by value of a child. You can also filter the sorted result to a\nspecific number of results or a range of keys or values."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Note: Filtering and sorting can be expensive, especially when done on the client.\nIf your app uses queries, define the .indexOn rule to index those keys on the\nserver and improve query performance as described in\n",(0,i.kt)("a",{parentName:"p",href:"https://firebase.google.com/docs/database/security/indexing-data"},"Indexing Your Data"),".")),(0,i.kt)("h3",{id:"sort-data"},"Sort data"),(0,i.kt)("p",null,"To retrieve sorted data, start by specifying one of the order-by methods to\ndetermine how results are ordered:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Method"),(0,i.kt)("th",{parentName:"tr",align:null},"Usage"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"orderByChild()")),(0,i.kt)("td",{parentName:"tr",align:null},"Order results by the value of a specified child key.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"orderByKey()")),(0,i.kt)("td",{parentName:"tr",align:null},"Order results by child keys.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"orderByValue()")),(0,i.kt)("td",{parentName:"tr",align:null},"Order results by child values.")))),(0,i.kt)("p",null,"You can only use one order-by method at a time. Calling an order-by method multiple times in the same query throws an error."),(0,i.kt)("p",null,"The following example demonstrates how you could retrieve a list sorted by their count:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'_query = FirebaseDatabase.service.getReference( "list" ).orderByChild( "count" );\n_query.addEventListener( DatabaseReferenceChildEvent.CHILD_ADDED, query_childAddedHandler );\n')),(0,i.kt)("p",null,"Then in your handler, use ",(0,i.kt)("inlineCode",{parentName:"p"},"event.snapshot")," to access data:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"private function query_childAddedHandler( event:DatabaseReferenceChildEvent ):void \n{\n    // Query result child added, trace out data value key\n    trace( JSON.stringify( event.snapshot.value ) );\n}\n")),(0,i.kt)("p",null,'This defines a query that when combined with a child listener synchronizes the client\nwith the data from the "list" path in the database, ordered by the number of "count"\neach item has. '),(0,i.kt)("p",null,"The call to the ",(0,i.kt)("inlineCode",{parentName:"p"},"orderByChild()")," method specifies the child key to order the results by.\nIn this case, data is sorted by the value of the ",(0,i.kt)("inlineCode",{parentName:"p"},"count")," child in each post.\nFor more information on how other data types are ordered, see\n",(0,i.kt)("a",{parentName:"p",href:"https://firebase.google.com/docs/database/android/lists-of-data#data-order"},"How query data is ordered"),"."),(0,i.kt)("h3",{id:"filtering-data"},"Filtering data"),(0,i.kt)("p",null,"To filter data, you can combine any of the limit or range methods with an order-by method when constructing a query."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Method"),(0,i.kt)("th",{parentName:"tr",align:null},"Usage"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"limitToFirst()")),(0,i.kt)("td",{parentName:"tr",align:null},"Sets the maximum number of items to return from the beginning of the ordered list of results.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"limitToLast()")),(0,i.kt)("td",{parentName:"tr",align:null},"Sets the maximum number of items to return from the end of the ordered list of results.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"startAt()")),(0,i.kt)("td",{parentName:"tr",align:null},"Return items greater than or equal to the specified key or value depending on the order-by method chosen.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"endAt()")),(0,i.kt)("td",{parentName:"tr",align:null},"Return items less than or equal to the specified key or value depending on the order-by method chosen.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"equalTo()")),(0,i.kt)("td",{parentName:"tr",align:null},"Return items equal to the specified key or value depending on the order-by method chosen.")))),(0,i.kt)("p",null,"Unlike the order-by methods, you can combine multiple limit or range functions.\nFor example, you can combine the startAt() and endAt() methods to limit the results\nto a specified range of values."),(0,i.kt)("p",null,"Even when there is only a single match for the query, the snapshot is still a list;\nit just contains a single item. To access the item, you need to loop over the result:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"private function query_valueChangedHandler( event:DatabaseReferenceEvent ):void\n{\n    for each (var child:DataSnapshot in event.snapshot.children)\n    {\n        trace( JSON.stringify( child.value ));\n    }\n}\n")),(0,i.kt)("h4",{id:"limit-the-number-of-results"},"Limit the number of results"),(0,i.kt)("p",null,"You can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"limitToFirst()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"limitToLast()")," methods to set a maximum\nnumber of children to be synced for a given callback. For example, if you use\n",(0,i.kt)("inlineCode",{parentName:"p"},"limitToFirst()")," to set a limit of ",(0,i.kt)("inlineCode",{parentName:"p"},"100"),", you initially only receive up to ",(0,i.kt)("inlineCode",{parentName:"p"},"100"),"\n",(0,i.kt)("inlineCode",{parentName:"p"},"CHILD_ADDED")," events. "),(0,i.kt)("p",null,"If you have fewer than ",(0,i.kt)("inlineCode",{parentName:"p"},"100")," items stored in your Firebase database, a\n",(0,i.kt)("inlineCode",{parentName:"p"},"CHILD_ADDED")," event is dispatched for each item."),(0,i.kt)("p",null,"As items change, you receive ",(0,i.kt)("inlineCode",{parentName:"p"},"CHILD_ADDED")," events for items that enter the\nquery and ",(0,i.kt)("inlineCode",{parentName:"p"},"CHILD_REMOVED")," events for items that drop out of it so that the\ntotal number stays at 100."),(0,i.kt)("p",null,'For example, the following demonstrates how to define a query to retrieve a\nlist of the 100 most recent "list" items: '),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'var query:Query = FirebaseDatabase.service.getReference( "list" ).limitToFirst(100);\n')),(0,i.kt)("h4",{id:"filter-by-key-or-value"},"Filter by key or value"),(0,i.kt)("p",null,"You can use startAt(), endAt(), and equalTo() to choose arbitrary starting,\nending, and equivalence points for queries. This can be useful for paginating\ndata or finding items with children that have a specific value."),(0,i.kt)("p",null,'For example, we can find all values in our "list" that have a "count" greater than\n600:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'var query:Query = FirebaseDatabase.service.getReference( "list" ).startAt( 600, "count" );\n')),(0,i.kt)("h3",{id:"how-query-data-is-ordered"},"How query data is ordered"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"This section explains how data is sorted by each of the order-by methods in the Query class."),(0,i.kt)("h4",{parentName:"blockquote",id:"orderbychild"},"orderByChild"),(0,i.kt)("p",{parentName:"blockquote"},"When using ",(0,i.kt)("inlineCode",{parentName:"p"},"orderByChild()"),", data that contains the specified child key is ordered as follows:"),(0,i.kt)("ul",{parentName:"blockquote"},(0,i.kt)("li",{parentName:"ul"},"Children with a ",(0,i.kt)("inlineCode",{parentName:"li"},"null")," value for the specified child key come first."),(0,i.kt)("li",{parentName:"ul"},"Children with a value of ",(0,i.kt)("inlineCode",{parentName:"li"},"false")," for the specified child key come next. If multiple children have a value of ",(0,i.kt)("inlineCode",{parentName:"li"},"false"),", they are sorted ",(0,i.kt)("a",{parentName:"li",href:"http://en.wikipedia.org/wiki/Lexicographical_order"},"lexicographically")," by key."),(0,i.kt)("li",{parentName:"ul"},"Children with a value of ",(0,i.kt)("inlineCode",{parentName:"li"},"true")," for the specified child key come next. If multiple children have a value of ",(0,i.kt)("inlineCode",{parentName:"li"},"true"),", they are sorted lexicographically by key."),(0,i.kt)("li",{parentName:"ul"},"Children with a numeric value come next, sorted in ascending order. If multiple children have the same numerical value for the specified child node, they are sorted by key."),(0,i.kt)("li",{parentName:"ul"},"Strings come after numbers and are sorted lexicographically in ascending order. If multiple children have the same value for the specified child node, they are ordered lexicographically by key."),(0,i.kt)("li",{parentName:"ul"},"Objects come last and are sorted lexicographically by key in ascending order.")),(0,i.kt)("h4",{parentName:"blockquote",id:"orderbykey"},"orderByKey"),(0,i.kt)("p",{parentName:"blockquote"},"When using ",(0,i.kt)("inlineCode",{parentName:"p"},"orderByKey()")," to sort your data, data is returned in ascending order by key."),(0,i.kt)("ul",{parentName:"blockquote"},(0,i.kt)("li",{parentName:"ul"},"Children with a key that can be parsed as a 32-bit integer come first, sorios/read-and-write#listen_for_value_eventsted in ascending order."),(0,i.kt)("li",{parentName:"ul"},"Children with a string value as their key come next, sorted lexicographically in ascending order.")),(0,i.kt)("h4",{parentName:"blockquote",id:"orderbyvalue"},"orderByValue"),(0,i.kt)("p",{parentName:"blockquote"},"When using ",(0,i.kt)("inlineCode",{parentName:"p"},"orderByValue()"),", children are ordered by their value. The ordering criteria\nare the same as in ",(0,i.kt)("inlineCode",{parentName:"p"},"orderByChild()"),", except the value of the node is used instead of the\nvalue of a specified child key.")))}c.isMDXComponent=!0}}]);