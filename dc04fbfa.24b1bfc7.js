(window.webpackJsonp=window.webpackJsonp||[]).push([[651],{706:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return r})),t.d(n,"metadata",(function(){return s})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return d}));var o=t(2),a=t(6),i=(t(0),t(813)),r={title:"Sounds",sidebar_label:"Sounds"},s={unversionedId:"pushnotifications/sounds",id:"pushnotifications/sounds",isDocsHomePage:!1,title:"Sounds",description:"The following documentation describes how to get custom sounds to play when your notification arrives.",source:"@site/docs/pushnotifications/sounds.md",slug:"/pushnotifications/sounds",permalink:"/docs/pushnotifications/sounds",version:"current",sidebar_label:"Sounds",sidebar:"pushnotifications",previous:{title:"Notification Scenarios",permalink:"/docs/pushnotifications/notification-scenarios"},next:{title:"Set Badge Number",permalink:"/docs/pushnotifications/set-badge-number"}},c=[{value:"APNS",id:"apns",children:[]},{value:"Android",id:"android",children:[]},{value:"FCM",id:"fcm",children:[{value:"Android 7 and lower",id:"android-7-and-lower",children:[]},{value:"Android 8+",id:"android-8",children:[]},{value:"Recommendation",id:"recommendation",children:[]}]}],l={rightToc:c};function d(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"The following documentation describes how to get custom sounds to play when your notification arrives."),Object(i.b)("p",null,"Importantly these sounds are always affected by the user's sound settings and generally they can override what you provide (eg by muting the phone), so it's always worth checking your device before deciding sounds are failing."),Object(i.b)("h2",{id:"apns"},"APNS"),Object(i.b)("p",null,"With APNS the notification sound is sent as part of the payload on the notification. The ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," field will specify the sound to use, the simplest case is to set it to ",Object(i.b)("inlineCode",{parentName:"p"},'"default"')," which will trigger the default notification sound on the device. "),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-json"}),'{\n    "aps" : \n    {\n        "alert" : "You have a notification",\n        "badge" : 1,\n        "sound" : "default"\n    }\n}\n')),Object(i.b)("p",null,"You can package a supported file type with your application to use as a custom sound. This sound file should just be included as any normal asset file. Then pass the path to the file in the ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," field."),Object(i.b)("p",null,"For example, if we package a caf sound file called ",Object(i.b)("inlineCode",{parentName:"p"},"notification.caf")," in a ",Object(i.b)("inlineCode",{parentName:"p"},"sounds")," directory (at ",Object(i.b)("inlineCode",{parentName:"p"},"sounds/notification.caf"),") then the payload would be:"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-json"}),'{\n    "aps" : \n    {\n        "alert" : "You have a notification",\n        "badge" : 1,\n        "sound" : "sounds/notification.caf"\n    }\n}\n')),Object(i.b)("p",null,'You cannot set the "default" sound on iOS, this is a user setting.'),Object(i.b)("h2",{id:"android"},"Android"),Object(i.b)("p",null,"Sounds on Android are handled slightly differently depending on the version of Android. "),Object(i.b)("p",null,"Before Android 8.0 (v26) a ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," field could be sent along with the notification payload and the file or resource would be played as a custom sound."),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-json"}),'{\n    "data": {\n        "notification" : {\n            "alert" : "You have a notification",\n            "title" : "You have a notification",\n            "body"  : "The body of the notification",\n            "sound" : "default"\n        }\n    }\n}\n')),Object(i.b)("p",null,"This field will look for a local file or a raw resource mp3, matching the name specified. Resources will take priority over files."),Object(i.b)("p",null,'From Android 8.0 (v26), sounds must be associated with a "channel" and the channel specified in the notification payload affects the sound that is played.'),Object(i.b)("p",null,"eg:"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-actionscript"}),'new ChannelBuilder()\n    .setId( "test_channel" )\n    .setName( "Test Channel" )\n    .setSound( "assets/notifications/sounds/notification.mp3" )\n    .build()\n')),Object(i.b)("p",null,Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"setup-your-service#channel-sounds"}),"Channel Sounds")),Object(i.b)("h2",{id:"fcm"},"FCM"),Object(i.b)("p",null,"With FCM there are 2 methods of notifications being sent and processed. When the application is in the foreground our extension will handle the displaying of notifications, however when it is in the background our extension will only handle data notifications, message notifications (sent either through the notification API or through the console) will be handled by the Firebase SDK internally."),Object(i.b)("h3",{id:"android-7-and-lower"},"Android 7 and lower"),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Android uses individual sounds for notifications.")),Object(i.b)("p",null,"When our extension handles the notification, the ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," field can refer to a file or to a resource. If you are always using data notifications then you can safely use a file reference for your sound and package the sound with your application as you do with iOS. "),Object(i.b)("p",null,"To use a file, the ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," field should be the mp3 file path within your application package. For example, if we package an mp3 sound file called ",Object(i.b)("inlineCode",{parentName:"p"},"notification.mp3")," in a ",Object(i.b)("inlineCode",{parentName:"p"},"sounds")," directory (at ",Object(i.b)("inlineCode",{parentName:"p"},"sounds/notification.caf"),") then the payload would be:"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-json"}),'{\n    "data": {\n        "notification" : {\n            "alert" : "You have a notification",\n            "title" : "You have a notification",\n            "body"  : "The body of the notification",\n            "sound" : "sounds/notification.mp3"\n        }\n    }\n}\n')),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Note: You can leave the extension off if you want. i.e. ",Object(i.b)("inlineCode",{parentName:"p"},'"sound" : "sounds/notification"'))),Object(i.b)("p",null,"To use a resource, the ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," field should be the name of the resource:"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-json"}),'"sound" : "notification_res_name"\n')),Object(i.b)("p",null,"When the Firebase SDK handles the notification the ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," field ",Object(i.b)("strong",{parentName:"p"},"must")," refer to a resource. It will not look for files in your application. "),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-json"}),'{\n    "notification" : {\n        "alert" : "You have a notification",\n        "title" : "You have a notification",\n        "body"  : "The body of the notification",\n        "sound" : "notification_res_name"\n    }\n}\n')),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Note: The absence of the ",Object(i.b)("inlineCode",{parentName:"p"},"data")," node means this is a message notification payload, not a data payload.")),Object(i.b)("p",null,"To package a resource, you must add your mp3 file to the ",Object(i.b)("inlineCode",{parentName:"p"},"raw")," directory in your ",Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/distriqt/ANE-CustomResources/"}),"custom resources extension")," along with your icons and configuration values. "),Object(i.b)("p",null,"Additionally you should use AIR 33 or higher. Previous versions of AIR can compress the raw resources making them unusable by services such as FCM."),Object(i.b)("h3",{id:"android-8"},"Android 8+"),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Android 8+ uses the channel for notification sounds.")),Object(i.b)("p",null,"Ensure you set the default channel:"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-xml"}),'<meta-data\n    android:name="com.google.firebase.messaging.default_notification_channel_id"\n    android:value="test_sound_channel"/>\n')),Object(i.b)("p",null,"This default channel will be used for notifications that are sent without a specified channel. "),Object(i.b)("p",null,"As you can always specify a channel in either a message or data notification you don't have the different scenarios that you have in older versions of Android. The channel can be created with either a file or a resource mp3 and both will work."),Object(i.b)("p",null,"Any ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," property sent to an Android 8+ device will be ignored when creating the notification."),Object(i.b)("h3",{id:"recommendation"},"Recommendation"),Object(i.b)("p",null,"With this in mind, we recommend using a resource(s) for all sounds if possible. This approach gives you the most consistent experience across message and data notifications with Firebase Cloud Messaging."),Object(i.b)("p",null,"It does add some complexity in creating a custom resources extension containing your sounds however you will normally be doing this for your icons and FCM configuration values so shouldn't be too much of an addition."),Object(i.b)("p",null,"Then always specify the resource name in any references to sounds, you should continue to include the ",Object(i.b)("inlineCode",{parentName:"p"},"sound")," property in your payloads to correctly address older versions of Android and include the ",Object(i.b)("inlineCode",{parentName:"p"},"channel")," for Android 8+."))}d.isMDXComponent=!0},813:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return f}));var o=t(0),a=t.n(o);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=a.a.createContext({}),d=function(e){var n=a.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},u=function(e){var n=d(e.components);return a.a.createElement(l.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},p=a.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,r=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=d(t),p=o,f=u["".concat(r,".").concat(p)]||u[p]||b[p]||i;return t?a.a.createElement(f,s(s({ref:n},l),{},{components:t})):a.a.createElement(f,s({ref:n},l))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,r=new Array(i);r[0]=p;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var l=2;l<i;l++)r[l]=t[l];return a.a.createElement.apply(null,r)}return a.a.createElement.apply(null,t)}p.displayName="MDXCreateElement"}}]);