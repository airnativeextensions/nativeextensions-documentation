(window.webpackJsonp=window.webpackJsonp||[]).push([[551],{606:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"metadata",(function(){return c})),t.d(n,"rightToc",(function(){return l})),t.d(n,"default",(function(){return s}));var i=t(2),o=t(6),r=(t(0),t(807)),a={title:"Monitoring a Region",sidebar_label:"Monitoring a Region"},c={unversionedId:"beacon/monitoring-a-region",id:"beacon/monitoring-a-region",isDocsHomePage:!1,title:"Monitoring a Region",description:"Monitoring a Region",source:"@site/docs/beacon/monitoring-a-region.md",slug:"/beacon/monitoring-a-region",permalink:"/docs/beacon/monitoring-a-region",version:"current",sidebar_label:"Monitoring a Region",sidebar:"beacon",previous:{title:"Requesting Authorisation",permalink:"/docs/beacon/requesting-authorisation"},next:{title:"Broadcasting",permalink:"/docs/beacon/broadcasting"}},l=[{value:"Monitoring a Region",id:"monitoring-a-region",children:[{value:"Start Monitoring",id:"start-monitoring",children:[]},{value:"Multiple Regions",id:"multiple-regions",children:[]},{value:"Stop Monitoring",id:"stop-monitoring",children:[]}]}],u={rightToc:l};function s(e){var n=e.components,t=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(i.a)({},u,t,{components:n,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"monitoring-a-region"},"Monitoring a Region"),Object(r.b)("p",null,"A region of beacons is designated by a UUID and a simple identifier. You should always supply\na valid UUID string that matches the UUID used in your beacons and a simple identifier to allow\nthe system to distinguish regions internally."),Object(r.b)("p",null,"During the lifetime of monitoring a region you'll receive the following events:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"REGION_MONITORING_START"),": when monitoring of a region begins"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"REGION_ENTER"),": when a region is entered by a device"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"REGION_EXIT"),": when a region is left by a device"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"BEACON_UPDATE"),": when a beacon is detected and ranged within a region")),Object(r.b)("p",null,"When the application is in the foreground, a region change detection can take ~ 1 second."),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},'"\nIn general ranging only works in the foreground, but monitoring updates can happen in the background.\nThere are two ways to configure background monitoring, and even when done properly updates can take\na long time to come. Because these delays, some people mistakenly believe that monitoring in the\nbackground doesn\'t work.\n"')),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},Object(r.b)("strong",{parentName:"p"},"iOS"),": On iOS you must ensure you have the ",Object(r.b)("inlineCode",{parentName:"p"},"ALWAYS")," permission granted to successfully monitor regions. Without this permission you may not get any region entry or exit events.")),Object(r.b)("h3",{id:"start-monitoring"},"Start Monitoring"),Object(r.b)("p",null,"To start the monitoring call the ",Object(r.b)("inlineCode",{parentName:"p"},"startMonitoringRegionWithUUID")," function with your ",Object(r.b)("inlineCode",{parentName:"p"},"UUID")," and ",Object(r.b)("inlineCode",{parentName:"p"},"identifier"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-actionscript"}),'Beacon.service.addEventListener( BeaconEvent.REGION_MONITORING_START, monitoringStartHandler );\nBeacon.service.addEventListener( BeaconEvent.REGION_ENTER, regionEnterHandler );\nBeacon.service.addEventListener( BeaconEvent.REGION_EXIT, regionExitHandler );\nBeacon.service.addEventListener( BeaconEvent.BEACON_UPDATE, beaconUpdateHandler );\n\nvar started:Boolean = Beacon.service.startMonitoringRegionWithUUID( "D57092AC-DFAA-446C-8EF3-C81AA22815B5", "an_identifying_string" );\ntrace( "Bluetooth monitoring started: " + started );\n')),Object(r.b)("p",null,"Then setup event handlers as below:"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-actionscript"}),'private function monitoringStartHandler( event:BeaconEvent ):void\n{\n    trace( "monitoringStartHandler(): " + event.region.identifier + "::" + event.region.uuid );\n}\n\nprivate function regionEnterHandler( event:BeaconEvent ):void\n{\n    trace( "Entered region: " + event.region.uuid );\n}\n\nprivate function regionExitHandler( event:BeaconEvent ):void\n{\n    trace( "Exit region: " + event.region.uuid );\n}\n\nprivate function beaconUpdateHandler( event:BeaconEvent ):void\n{\n    trace( "Beacon update for region: "+event.region.uuid );\n    for each (var beacon:BeaconObject in event.beacons)\n    {\n        trace( "Beacon: "+beacon.major+"."+beacon.minor +"::"+beacon.proximity +"["+beacon.accuracy +"]");\n    }\n}\n')),Object(r.b)("h3",{id:"multiple-regions"},"Multiple Regions"),Object(r.b)("p",null,"If you wish to monitor multiple regions simulataneously you must make sure that the identifier parameter\nis unique for each region as well as the uuid! If you do not you will only receive updates for the last\nregion you started monitoring. The iOS SDK uses the identifier to determine if the region is unique, and\nreplaces any existing region monitoring if it is the same."),Object(r.b)("h3",{id:"stop-monitoring"},"Stop Monitoring"),Object(r.b)("p",null,"Similarly to stop monitoring call the ",Object(r.b)("inlineCode",{parentName:"p"},"stopMonitoringRegionWithUUID")," function:"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-actionscript"}),'if (Beacon.service.isMonitoringRegionWithUUID( uuid ))\n{\n    var stopped:Boolean = Beacon.service.stopMonitoringRegionWithUUID( uuid, identifier );\n    trace( "Bluetooth monitoring stopped: "+stopped );\n}\n')))}s.isMDXComponent=!0},807:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return d}));var i=t(0),o=t.n(i);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var u=o.a.createContext({}),s=function(e){var n=o.a.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},p=function(e){var n=s(e.components);return o.a.createElement(u.Provider,{value:n},e.children)},g={inlineCode:"code",wrapper:function(e){var n=e.children;return o.a.createElement(o.a.Fragment,{},n)}},b=o.a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,a=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(t),b=i,d=p["".concat(a,".").concat(b)]||p[b]||g[b]||r;return t?o.a.createElement(d,c(c({ref:n},u),{},{components:t})):o.a.createElement(d,c({ref:n},u))}));function d(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,a=new Array(r);a[0]=b;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c.mdxType="string"==typeof e?e:i,a[1]=c;for(var u=2;u<r;u++)a[u]=t[u];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);