"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[65153],{3905:function(e,n,a){a.d(n,{Zo:function(){return s},kt:function(){return m}});var t=a(67294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function l(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},i=Object.keys(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var u=t.createContext({}),p=function(e){var n=t.useContext(u),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},s=function(e){var n=p(e.components);return t.createElement(u.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},c=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,i=e.originalType,u=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),c=p(a),m=r,h=c["".concat(u,".").concat(m)]||c[m]||d[m]||i;return a?t.createElement(h,o(o({ref:n},s),{},{components:a})):t.createElement(h,o({ref:n},s))}));function m(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=c;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=a[p];return t.createElement.apply(null,o)}return t.createElement.apply(null,a)}c.displayName="MDXCreateElement"},85162:function(e,n,a){a.d(n,{Z:function(){return o}});var t=a(67294),r=a(86010),i="tabItem_Ymn6";function o(e){var n=e.children,a=e.hidden,o=e.className;return t.createElement("div",{role:"tabpanel",className:(0,r.Z)(i,o),hidden:a},n)}},74866:function(e,n,a){a.d(n,{Z:function(){return A}});var t=a(87462),r=a(67294),i=a(86010),o=a(12466),l=a(16550),u=a(91980),p=a(67392),s=a(50012);function d(e){return function(e){var n,a;return null!=(n=null==(a=r.Children.map(e,(function(e){if(!e||(0,r.isValidElement)(e)&&(n=e.props)&&"object"==typeof n&&"value"in n)return e;var n;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:a.filter(Boolean))?n:[]}(e).map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes,default:n.default}}))}function c(e){var n=e.values,a=e.children;return(0,r.useMemo)((function(){var e=null!=n?n:d(a);return function(e){var n=(0,p.l)(e,(function(e,n){return e.value===n.value}));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,a])}function m(e){var n=e.value;return e.tabValues.some((function(e){return e.value===n}))}function h(e){var n=e.queryString,a=void 0!==n&&n,t=e.groupId,i=(0,l.k6)(),o=function(e){var n=e.queryString,a=void 0!==n&&n,t=e.groupId;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:a,groupId:t});return[(0,u._X)(o),(0,r.useCallback)((function(e){if(o){var n=new URLSearchParams(i.location.search);n.set(o,e),i.replace(Object.assign({},i.location,{search:n.toString()}))}}),[o,i])]}function v(e){var n,a,t,i,o=e.defaultValue,l=e.queryString,u=void 0!==l&&l,p=e.groupId,d=c(e),v=(0,r.useState)((function(){return function(e){var n,a=e.defaultValue,t=e.tabValues;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!m({value:a,tabValues:t}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+a+'" but none of its children has the corresponding value. Available values are: '+t.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return a}var r=null!=(n=t.find((function(e){return e.default})))?n:t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:o,tabValues:d})})),f=v[0],g=v[1],y=h({queryString:u,groupId:p}),k=y[0],b=y[1],w=(n=function(e){return e?"docusaurus.tab."+e:null}({groupId:p}.groupId),a=(0,s.Nk)(n),t=a[0],i=a[1],[t,(0,r.useCallback)((function(e){n&&i.set(e)}),[n,i])]),A=w[0],N=w[1],E=function(){var e=null!=k?k:A;return m({value:e,tabValues:d})?e:null}();return(0,r.useLayoutEffect)((function(){E&&g(E)}),[E]),{selectedValue:f,selectValue:(0,r.useCallback)((function(e){if(!m({value:e,tabValues:d}))throw new Error("Can't select invalid tab value="+e);g(e),b(e),N(e)}),[b,N,d]),tabValues:d}}var f=a(72389),g="tabList__CuJ",y="tabItem_LNqP";function k(e){var n=e.className,a=e.block,l=e.selectedValue,u=e.selectValue,p=e.tabValues,s=[],d=(0,o.o5)().blockElementScrollPositionUntilNextRender,c=function(e){var n=e.currentTarget,a=s.indexOf(n),t=p[a].value;t!==l&&(d(n),u(t))},m=function(e){var n,a=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":var t,r=s.indexOf(e.currentTarget)+1;a=null!=(t=s[r])?t:s[0];break;case"ArrowLeft":var i,o=s.indexOf(e.currentTarget)-1;a=null!=(i=s[o])?i:s[s.length-1]}null==(n=a)||n.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":a},n)},p.map((function(e){var n=e.value,a=e.label,o=e.attributes;return r.createElement("li",(0,t.Z)({role:"tab",tabIndex:l===n?0:-1,"aria-selected":l===n,key:n,ref:function(e){return s.push(e)},onKeyDown:m,onClick:c},o,{className:(0,i.Z)("tabs__item",y,null==o?void 0:o.className,{"tabs__item--active":l===n})}),null!=a?a:n)})))}function b(e){var n=e.lazy,a=e.children,t=e.selectedValue,i=(Array.isArray(a)?a:[a]).filter(Boolean);if(n){var o=i.find((function(e){return e.props.value===t}));return o?(0,r.cloneElement)(o,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},i.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t})})))}function w(e){var n=v(e);return r.createElement("div",{className:(0,i.Z)("tabs-container",g)},r.createElement(k,(0,t.Z)({},e,n)),r.createElement(b,(0,t.Z)({},e,n)))}function A(e){var n=(0,f.Z)();return r.createElement(w,(0,t.Z)({key:String(n)},e))}},93515:function(e,n,a){a.r(n),a.d(n,{assets:function(){return c},contentTitle:function(){return s},default:function(){return v},frontMatter:function(){return p},metadata:function(){return d},toc:function(){return m}});var t=a(87462),r=a(63366),i=(a(67294),a(3905)),o=a(74866),l=a(85162),u=["components"],p={title:"In App Updates",sidebar_label:"In App Updates"},s=void 0,d={unversionedId:"inappbilling/in-app-updates",id:"inappbilling/in-app-updates",title:"In App Updates",description:"In-App Updates is a method for your application to check with the store as to whether there is a newer version of your application available. Although some users enable background updates when their device is connected to an unmetered connection, other users may need to be reminded to update.",source:"@site/docs/inappbilling/in-app-updates.mdx",sourceDirName:"inappbilling",slug:"/inappbilling/in-app-updates",permalink:"/docs/inappbilling/in-app-updates",draft:!1,tags:[],version:"current",frontMatter:{title:"In App Updates",sidebar_label:"In App Updates"},sidebar:"inappbilling",previous:{title:"Testing",permalink:"/docs/inappbilling/testing"},next:{title:"Migration v14",permalink:"/docs/inappbilling/migration-v14"}},c={},m=[{value:"Additional Requirements",id:"additional-requirements",level:2},{value:"Google Play",id:"google-play",level:3},{value:"Huawei App-Gallery",id:"huawei-app-gallery",level:3},{value:"Usage",id:"usage",level:2},{value:"Check if supported",id:"check-if-supported",level:3},{value:"Check for an update",id:"check-for-an-update",level:3},{value:"Start an update",id:"start-an-update",level:3},{value:"Testing",id:"testing",level:2},{value:"Google Play",id:"google-play-1",level:3}],h={toc:m};function v(e){var n=e.components,p=(0,r.Z)(e,u);return(0,i.kt)("wrapper",(0,t.Z)({},h,p,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"In-App Updates is a method for your application to check with the store as to whether there is a newer version of your application available. Although some users enable background updates when their device is connected to an unmetered connection, other users may need to be reminded to update."),(0,i.kt)("p",null,"This feature allows you to check and prompt active users to update your app."),(0,i.kt)("p",null,(0,i.kt)("img",{src:a(58543).Z,width:"394",height:"700"})),(0,i.kt)("h2",{id:"additional-requirements"},"Additional Requirements"),(0,i.kt)("p",null,"There may be some additional requirements here depending on how you installed the extension."),(0,i.kt)(o.Z,{groupId:"packagemanager",defaultValue:"apm",values:[{label:"APM",value:"apm"},{label:"Manual",value:"manual"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"apm",mdxType:"TabItem"},(0,i.kt)("p",null,"Nothing additional required if using apm.")),(0,i.kt)(l.Z,{value:"manual",mdxType:"TabItem"},(0,i.kt)("h3",{id:"google-play"},"Google Play"),(0,i.kt)("p",null,"You will need to add the common Play Core extension (",(0,i.kt)("a",{parentName:"p",href:"https://github.com/distriqt/ANE-GooglePlayServices/raw/master/lib/com.google.android.play.ane"},(0,i.kt)("inlineCode",{parentName:"a"},"com.google.android.play")),")."),(0,i.kt)("p",null,"Add the following permission:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<uses-permission android:name="android.permission.FOREGROUND_SERVICE" />\n')),(0,i.kt)("p",null,"And add the following to the manifest additions inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"application")," node:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- com.google.android.play --\x3e\n<activity\n    android:name="com.google.android.play.core.missingsplits.PlayCoreMissingSplitsActivity"\n    android:enabled="false"\n    android:exported="false"\n    android:launchMode="singleInstance"\n    android:process=":playcore_missing_splits_activity"\n    android:stateNotNeeded="true" />\n<activity\n    android:name="com.google.android.play.core.common.PlayCoreDialogWrapperActivity"\n    android:exported="false"\n    android:stateNotNeeded="true"\n    android:theme="@style/Theme.PlayCore.Transparent" />\n<service\n    android:name="com.google.android.play.core.assetpacks.AssetPackExtractionService"\n    android:enabled="false"\n    android:exported="true" >\n    <meta-data\n        android:name="com.google.android.play.core.assetpacks.versionCode"\n        android:value="11001" />\n</service>\n<service\n    android:name="com.google.android.play.core.assetpacks.ExtractionForegroundService"\n    android:enabled="false"\n    android:exported="false" />\n')),(0,i.kt)("h3",{id:"huawei-app-gallery"},"Huawei App-Gallery"),(0,i.kt)("p",null,"For Huawei you will need to add the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/distriqt/ANE-HuaweiMobileServices/raw/master/lib/com.huawei.hms.game.ane"},(0,i.kt)("inlineCode",{parentName:"a"},"com.huawei.hms.game"))," Huawei Mobile Services extension and add the following to your manifest additions:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- HUAWEI GAME --\x3e\n<meta-data\n    android:name="com.huawei.hms.client.service.name:game"\n    android:value="game:4.0.3.301" />\n<meta-data\n    android:name="com.huawei.hms.jos.versioncode"\n    android:value="40003301" />\n\n<service\n    android:name="com.huawei.hms.jos.games.service.GameService"\n    android:exported="true" >\n    <intent-filter>\n        <action android:name="com.huawei.hms.games.service" />\n    </intent-filter>\n</service>\n\n<provider\n    android:name="com.huawei.hms.jos.games.archive.ArchiveRemoteAccessProvider"\n    android:authorities="com.distriqt.extension.hms.game.test.hmssdk.jos.archive"\n    android:exported="true" >\n</provider>\n\n<activity\n    android:name="com.huawei.appmarket.component.buoycircle.impl.delegete.BuoyBridgeActivity"\n    android:configChanges="orientation|locale|screenSize|layoutDirection|fontScale"\n    android:excludeFromRecents="true"\n    android:exported="false"\n    android:hardwareAccelerated="true"\n    android:theme="@android:style/Theme.Translucent" >\n    <meta-data\n        android:name="hwc-theme"\n        android:value="androidhwext:style/Theme.Emui.Translucent" />\n')))),(0,i.kt)("h2",{id:"usage"},"Usage"),(0,i.kt)("h3",{id:"check-if-supported"},"Check if supported"),(0,i.kt)("p",null,"Only certain services support In-App Updates:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Google Play"),(0,i.kt)("li",{parentName:"ul"},"Huawei AppGallery")),(0,i.kt)("p",null,"You can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"isSupported")," flag to check whether the current device and service supported In App Updates:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (InAppBilling.service.inAppUpdates.isSupported)\n{\n    // In-App Updates are supported\n}\n")),(0,i.kt)("h3",{id:"check-for-an-update"},"Check for an update"),(0,i.kt)("p",null,"To check for an update, call ",(0,i.kt)("inlineCode",{parentName:"p"},"checkAppUpdate()")," and await one of the events:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"InAppUpdatesEvent.CHECK_APP_UPDATES_SUCCESS"),": dispatched when the check was completed successfully"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"InAppUpdatesEvent.CHECK_APP_UPDATES_FAILED"),": dispatched if there was an error performing the check.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"InAppBilling.service.inAppUpdates.addEventListener( InAppUpdatesEvent.CHECK_APP_UPDATES_SUCCESS, successHandler );\nInAppBilling.service.inAppUpdates.addEventListener( InAppUpdatesEvent.CHECK_APP_UPDATES_FAILED, failedHandler );\n\nInAppBilling.service.inAppUpdates.checkAppUpdate();\n")),(0,i.kt)("p",null,"If successful you can use the details in the event to determine if there is an update available:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'function successHandler( event:InAppUpdatesEvent ):void\n{\n    if (event.updateAvailability == InAppUpdateAvailablity.UPDATE_AVAILABLE)\n    {\n        // An update is available\n        trace( "info: " + (event.updateInfo == null ? "null" : event.updateInfo.toString()) );\n    }\n    else\n    {\n        // No update available\n    }\n}\n')),(0,i.kt)("p",null,"If an error occurred you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"errorCode")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"message")," fields to understand the issue:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'function checkAppUpdates_failedHandler( event:InAppUpdatesEvent ):void\n{\n    trace( "errorCode: " + event.errorCode );\n    trace( "message: " + event.message );\n}\n')),(0,i.kt)("h3",{id:"start-an-update"},"Start an update"),(0,i.kt)("p",null,"If there is an update available, you can start the in app update process by calling ",(0,i.kt)("inlineCode",{parentName:"p"},"startAppUpdate()"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"InAppBilling.service.inAppUpdates.startAppUpdate();\n")),(0,i.kt)("h2",{id:"testing"},"Testing"),(0,i.kt)("h3",{id:"google-play-1"},"Google Play"),(0,i.kt)("p",null,"With internal app sharing, you can quickly share an app bundle or APK with your internal team and testers by uploading the app bundle you want to test to the Play Console."),(0,i.kt)("p",null,"You can also use internal app sharing to test in-app updates, as follows:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"On your test device, make sure you've already installed a version of your app that meets the following requirements:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The app was installed using an internal app sharing URL"),(0,i.kt)("li",{parentName:"ul"},"Supports in-app updates"),(0,i.kt)("li",{parentName:"ul"},"Uses a version code that's lower than the updated version of your app")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Follow the Play Console instructions on how to ",(0,i.kt)("a",{parentName:"p",href:"https://support.google.com/googleplay/android-developer/answer/9303479"},"share your app internally"),". Make sure you upload a version of your app that uses a version code that's higher than the one you have already installed on the test device.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the test device, only click the internal app-sharing link for the updated version of your app. ",(0,i.kt)("strong",{parentName:"p"},"Do not install the app")," from the Google Play Store page you see after clicking the link.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open the app from the device's app drawer or home screen. The update should now be available to your app, and you can test your implementation of in-app updates."))))}v.isMDXComponent=!0},58543:function(e,n,a){n.Z=a.p+"assets/images/inappupdates_googleplay-7749f6edd1d9bae5d67bac65ee58d9b8.png"}}]);