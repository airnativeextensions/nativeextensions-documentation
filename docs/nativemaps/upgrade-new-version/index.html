<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="air native extensions Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="air native extensions Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="air native extensions" href="/opensearch.xml"><title data-react-helmet="true">upgrade-new-version | air native extensions</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" property="og:image" content="https://docs.airnativeextensions.com/img/ane-icon-black.png"><meta data-react-helmet="true" property="twitter:image" content="https://docs.airnativeextensions.com/img/ane-icon-black.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for air native extensions"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="upgrade-new-version | air native extensions"><meta data-react-helmet="true" name="description" content="Version X upgrade steps"><meta data-react-helmet="true" property="og:description" content="Version X upgrade steps"><meta data-react-helmet="true" property="og:url" content="https://docs.airnativeextensions.com/docs/nativemaps/upgrade-new-version"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://docs.airnativeextensions.com/docs/nativemaps/upgrade-new-version"><link rel="stylesheet" href="/styles.80ac059f.css">
<link rel="preload" href="/styles.5e1faa88.js" as="script">
<link rel="preload" href="/runtime~main.1545e8b5.js" as="script">
<link rel="preload" href="/main.ffef14b0.js" as="script">
<link rel="preload" href="/1.4541bf70.js" as="script">
<link rel="preload" href="/2.9cc9edb1.js" as="script">
<link rel="preload" href="/810.68f46975.js" as="script">
<link rel="preload" href="/813.946afebf.js" as="script">
<link rel="preload" href="/935f2afb.f4a2d845.js" as="script">
<link rel="preload" href="/17896441.1dc6f8e4.js" as="script">
<link rel="preload" href="/3b0faa55.df6aa94b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/ane-icon-black.png" alt="AIR Native Extensions"><strong class="navbar__title">AIR Native Extensions</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/news/">News</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx"> </span></div><div class="react-toggle-track-x"><span class="toggle_BsTx"> </span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/ane-icon-black.png" alt="AIR Native Extensions"><strong class="navbar__title">AIR Native Extensions</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/news/">News</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">upgrade-new-version</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="version-x-upgrade-steps"></a>Version X upgrade steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#version-x-upgrade-steps" title="Direct link to heading">#</a></h1><p>The latest version (vX.X.X) of our NativeMaps extension has been updated
to simplify and resolve known issues with the Android version.</p><p>The updated version requires some changes to the way you set up your
application descriptor, etc.</p><p>This page outlines the steps to update your app to support the new
version of the ANE.</p><h1></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="known-issues"></a>Known Issues<a aria-hidden="true" tabindex="-1" class="hash-link" href="#known-issues" title="Direct link to heading">#</a></h2><p>The Android version of the ANE has had many known issues which were problematic for all different
versions of Android and therefore difficult to diagnose and fix for all users.</p><p>This version has been fairly well tested and we&#x27;re reasonably confident that with the right
configuration the maps should function reliably across different devices and OS versions.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#-1" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="resolved-issues-in-this-version"></a>Resolved issues in this version<a aria-hidden="true" tabindex="-1" class="hash-link" href="#resolved-issues-in-this-version" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="1-map-not-displaying"></a>1. Map not displaying<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-map-not-displaying" title="Direct link to heading">#</a></h3><p>The main issue we have been trying to resolve for a long time has been the issue of the map
not being visible, or disappearing. It&#x27;s always been a problem because of the way AIR apps
work internally, and because of how Android handles z-indexing of SurfaceView layers. We have
rewritten all of the view code which creates and runs the native map layer and are reasonably
confident that we&#x27;ve solved this problem! ðŸ’ƒ</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="2-ui-controls-invisible"></a>2. UI controls invisible<a aria-hidden="true" tabindex="-1" class="hash-link" href="#2-ui-controls-invisible" title="Direct link to heading">#</a></h3><p>A lot of reported issues correctly noted that after creating a map, the z-order problems caused
the UI controls to disappear on many versions of Android (the zoom buttons and user location
button). The fixes to the z-ordering in this new version should resolve this problem.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="3-problems-with-gms-version-mismatch"></a>3. Problems with &#x27;gms version&#x27; mismatch<a aria-hidden="true" tabindex="-1" class="hash-link" href="#3-problems-with-gms-version-mismatch" title="Direct link to heading">#</a></h3><p>A lot of crashes have been reported which were caused by an incorrect value of the
<code>com.google.android.gms.version</code> meta tag value. The new version has changes to
use the correct value of <code>@integer/google_play_services_version</code> rather than a
specific integer, which should fix this problem. </p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="-2"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#-2" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="required-changes"></a>Required changes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#required-changes" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="1-add-supporting-anes"></a>1. Add supporting ANEs<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-add-supporting-anes" title="Direct link to heading">#</a></h3><p>Firstly, make sure you download and add the latest versions of each of the required
support extensions to your app. This includes:</p><ul><li>Core - <a href="https://github.com/distriqt/ANE-Core" target="_blank" rel="noopener noreferrer">https://github.com/distriqt/ANE-Core</a></li><li>GooglePlayServices - <a href="https://github.com/distriqt/ANE-GooglePlayServices" target="_blank" rel="noopener noreferrer">https://github.com/distriqt/ANE-GooglePlayServices</a></li><li>AndroidSupport - <a href="https://github.com/distriqt/ANE-AndroidSupport" target="_blank" rel="noopener noreferrer">https://github.com/distriqt/ANE-AndroidSupport</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="2-use-air-22"></a>2. Use AIR 22<a aria-hidden="true" tabindex="-1" class="hash-link" href="#2-use-air-22" title="Direct link to heading">#</a></h3><p>AIR 22 is still in beta at the time of writing, but we believe it is the most stable and best
release of AIR so far, and so we recommend using it if possible.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="3-update-your-application-descriptor"></a>3. Update your application descriptor<a aria-hidden="true" tabindex="-1" class="hash-link" href="#3-update-your-application-descriptor" title="Direct link to heading">#</a></h3><p>There are a few changes you need to make to the Android manifest section of your app XML. Below is an example of a complete manifest:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">&lt;android&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &lt;manifestAdditions&gt;&lt;![CDATA[</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;manifest android:installLocation=&quot;auto&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-sdk android:minSdkVersion=&quot;12&quot; android:targetSdkVersion=&quot;19&quot; /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;android.permission.ACCESS_FINE_LOCATION&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;android.permission.ACCESS_WIFI_STATE&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;com.google.android.providers.gsf.permission.READ_GSERVICES&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-feature android:glEsVersion=&quot;0x00020000&quot; android:required=&quot;true&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;!-- Replace &#x27;air.com.distriqt.test&#x27; here with &#x27;air.your.app.id&#x27; etc --&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;uses-permission android:name=&quot;air.com.distriqt.test.permission.MAPS_RECEIVE&quot; android:protectionLevel=&quot;signature&quot;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;application&gt;   </span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;!-- Replace &quot;YOUR_API_KEY&quot; with your Android Google Maps v2 api key --&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;meta-data android:name=&quot;com.google.android.maps.v2.API_KEY&quot; android:value=&quot;YOUR API KEY&quot; /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;meta-data android:name=&quot;com.google.android.gms.version&quot; android:value=&quot;@integer/google_play_services_version&quot; /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;/application&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;/manifest&gt;]]&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &lt;/manifestAdditions&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">&lt;/android&gt;</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="summary-of-changes"></a>Summary of changes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#summary-of-changes" title="Direct link to heading">#</a></h3><p>TODO</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="-3"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#-3" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="general-notes"></a>General notes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#general-notes" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="1-creating-maps---not-so-fast"></a>1. Creating maps - not so fast!<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-creating-maps---not-so-fast" title="Direct link to heading">#</a></h3><p>Some crashes or problems can be caused by trying to initialise and create a map too quickly when
your app starts up. For example, a lot of developers add all their code to init, create and set
up a map in the <code>addedToStage</code> handler of the main class.</p><p>This can be problematic, especially in this new version because the extension needs to perform
some view reordering and modification to fix the z-indexing problem. We strongly suggest:</p><ul><li>Wait a short time after your app starts to work with the map objects</li><li>Call <code>NativeMaps.service.createMap()</code> separately, before other map functions</li><li>Listen for the <code>NativeMapEvent.MAP_CREATED</code> event and then perform other actions on your map </li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="-4"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#-4" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="documentation"></a>Documentation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#documentation" title="Direct link to heading">#</a></h2><p>Latest documentation:</p><p><a href="http://airnativeextensions.com/extension/com.distriqt.NativeMaps" target="_blank" rel="noopener noreferrer">http://airnativeextensions.com/extension/com.distriqt.NativeMaps</a></p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#known-issues" class="table-of-contents__link">Known Issues</a></li><li><a href="#resolved-issues-in-this-version" class="table-of-contents__link">Resolved issues in this version</a><ul><li><a href="#1-map-not-displaying" class="table-of-contents__link">1. Map not displaying</a></li><li><a href="#2-ui-controls-invisible" class="table-of-contents__link">2. UI controls invisible</a></li><li><a href="#3-problems-with-gms-version-mismatch" class="table-of-contents__link">3. Problems with &#39;gms version&#39; mismatch</a></li></ul></li><li><a href="#required-changes" class="table-of-contents__link">Required changes</a><ul><li><a href="#1-add-supporting-anes" class="table-of-contents__link">1. Add supporting ANEs</a></li><li><a href="#2-use-air-22" class="table-of-contents__link">2. Use AIR 22</a></li><li><a href="#3-update-your-application-descriptor" class="table-of-contents__link">3. Update your application descriptor</a></li><li><a href="#summary-of-changes" class="table-of-contents__link">Summary of changes</a></li></ul></li><li><a href="#general-notes" class="table-of-contents__link">General notes</a><ul><li><a href="#1-creating-maps---not-so-fast" class="table-of-contents__link">1. Creating maps - not so fast!</a></li></ul></li><li><a href="#documentation" class="table-of-contents__link">Documentation</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials/">tutorials</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/distriqt" target="_blank" rel="noopener noreferrer" class="footer__link-item">twitter</a></li><li class="footer__item"><a href="https://github.com/Gamua/Adobe-Runtime-Support/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">AIR discussions</a></li><li class="footer__item"><a href="https://forum.starling-framework.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">starling</a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/distriqt" target="_blank" rel="noopener noreferrer" class="footer__link-item">stack overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/news">news</a></li><li class="footer__item"><a href="https://airnativeextensions.com/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">privacy</a></li><li class="footer__item"><a href="https://airnativeextensions.com/license" target="_blank" rel="noopener noreferrer" class="footer__link-item">license</a></li></ul></div></div><div class="text--center"><div><br><a href="https://airnativeextensions.com">airnativeextensions.com</a> copyright Â© 2021 <br><br><a href="https://distriqt.com"><img src="/img/logo.png" alt="distriqt"></a></div></div></div></footer></div>
<script src="/styles.5e1faa88.js"></script>
<script src="/runtime~main.1545e8b5.js"></script>
<script src="/main.ffef14b0.js"></script>
<script src="/1.4541bf70.js"></script>
<script src="/2.9cc9edb1.js"></script>
<script src="/810.68f46975.js"></script>
<script src="/813.946afebf.js"></script>
<script src="/935f2afb.f4a2d845.js"></script>
<script src="/17896441.1dc6f8e4.js"></script>
<script src="/3b0faa55.df6aa94b.js"></script>
</body>
</html>