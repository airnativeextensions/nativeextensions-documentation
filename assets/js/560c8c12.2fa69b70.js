"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[19116],{3905:(e,t,i)=>{i.d(t,{Zo:()=>p,kt:()=>m});var n=i(67294);function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,n,a=function(e,t){if(null==e)return{};var i,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(a[i]=e[i]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}var l=n.createContext({}),u=function(e){var t=n.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):r(r({},t),e)),i},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var i=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(i),d=a,m=c["".concat(l,".").concat(d)]||c[d]||h[d]||o;return i?n.createElement(m,r(r({ref:t},p),{},{components:i})):n.createElement(m,r({ref:t},p))}));function m(e,t){var i=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=i.length,r=new Array(o);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,r[1]=s;for(var u=2;u<o;u++)r[u]=i[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,i)}d.displayName="MDXCreateElement"},49356:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>u});var n=i(87462),a=(i(67294),i(3905));const o={title:"Requesting Authorisation",sidebar_label:"Requesting Authorisation"},r=void 0,s={unversionedId:"cameraui/requesting-authorisation",id:"cameraui/requesting-authorisation",title:"Requesting Authorisation",description:"When you are going to be accessing the camera you must check that your application has been allowed access.",source:"@site/docs/cameraui/requesting-authorisation.md",sourceDirName:"cameraui",slug:"/cameraui/requesting-authorisation",permalink:"/docs/cameraui/requesting-authorisation",draft:!1,tags:[],version:"current",frontMatter:{title:"Requesting Authorisation",sidebar_label:"Requesting Authorisation"},sidebar:"cameraui",previous:{title:"Add the Extension",permalink:"/docs/cameraui/add-the-extension"},next:{title:"Capture Media",permalink:"/docs/cameraui/capture-media"}},l={},u=[{value:"Authorisation Types",id:"authorisation-types",level:3},{value:"Camera Permission",id:"camera-permission",level:3},{value:"Usage Description",id:"usage-description",level:2},{value:"Device Settings",id:"device-settings",level:2}],p={toc:u},c="wrapper";function h(e){let{components:t,...o}=e;return(0,a.kt)(c,(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"When you are going to be accessing the camera you must check that your application has been allowed access.\nTo this end the extension provides several helpers to check and request access to the camera and to the file system to save images.\nNormal permission rules apply here."),(0,a.kt)("p",null,"On Android these permissions are listed through the manifest additions.\nOn older versions of Android these permissions are accepted when the user installs the application.\nMore modern versions (Marshmallow 6 ","[v23]","+) require that you request the permissions similar to iOS.\nYou will still need to list them in your manifest and then follow the same code below as for iOS, except that on Android you will be able to ask multiple times.\nYou should respect the ",(0,a.kt)("inlineCode",{parentName:"p"},"SHOULD_EXPLAIN")," status by displaying additional information to your user about why you require this functionality."),(0,a.kt)("p",null,"On iOS the user must be asked at runtime, which you only get one chance to ask,\nafter which you must direct the user to manually change the permissions in the settings."),(0,a.kt)("p",null,"The following code will work across both platforms:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},'CameraUI.service.addEventListener( AuthorisationEvent.CHANGED, authorisationStatus_changedHandler );\n\nswitch (CameraUI.service.authorisationStatus())\n{\n    case AuthorisationStatus.SHOULD_EXPLAIN:\n    case AuthorisationStatus.NOT_DETERMINED:\n        // REQUEST ACCESS: This will display the permission dialog\n        CameraUI.service.requestAuthorisation();\n        return;\n    \n    case AuthorisationStatus.DENIED:\n    case AuthorisationStatus.UNKNOWN:\n    case AuthorisationStatus.RESTRICTED:\n        // ACCESS DENIED: You should inform your user appropriately\n        return;\n        \n    case AuthorisationStatus.AUTHORISED:\n        // AUTHORISED: Camera will be available\n        break;                      \n}\n\n\nfunction authorisationStatus_changedHandler( event:AuthorisationEvent ):void\n{\n    trace( "authorisationStatus_changedHandler: "+event.status );\n}\n')),(0,a.kt)("h3",{id:"authorisation-types"},"Authorisation Types"),(0,a.kt)("p",null,"There are several types of authorisation that you will require for this extension and as they\nmay not be required by all applications they have been separated so you can request them individually\nas appropriate for your application:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"AuthorisationType.CAMERA"),": Access to the camera device"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"AuthorisationType.AUDIO"),": Access to the microphone device"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"AuthorisationType.PHOTOS"),": Access to the camera roll to save images (only required if you set ",(0,a.kt)("inlineCode",{parentName:"li"},"saveToCameraRoll")," to ",(0,a.kt)("inlineCode",{parentName:"li"},"true")," in the options)")),(0,a.kt)("p",null,"You will need to run through the above process for each of the permissions your application\nrequires!"),(0,a.kt)("h3",{id:"camera-permission"},"Camera Permission"),(0,a.kt)("p",null,"While this ANE uses the camera, it does not require the ",(0,a.kt)("inlineCode",{parentName:"p"},"android.permission.CAMERA")," permission\non Android. "),(0,a.kt)("p",null,"This is because the camera capture is actually offloaded to another system application\nthat requests the permission if required. "),(0,a.kt)("p",null,"If however you added this permission to your manifest, Android requires that you ask the user\nfor permission otherwise will deny this offloading. Hence if you add it to your manifest\nyou will get an extra permission request dialog when requesting permissions. If you don't add\nit then you will only get the dialog for write permissions to save files appropriately."),(0,a.kt)("h2",{id:"usage-description"},"Usage Description"),(0,a.kt)("p",null,"You can customise the usage description messages as you see fit to suit your application. These messages are displayed in the main body area of the iOS authorisation dialog with the title and buttons being standard (and not customisable)."),(0,a.kt)("p",null,"The image below is an example of the authorisation dialog. The content ",(0,a.kt)("em",{parentName:"p"},'"Access storage"')," is the usage description message you can set."),(0,a.kt)("p",null,(0,a.kt)("img",{src:i(11130).Z,width:"300",height:"190"})),(0,a.kt)("p",null,"You set these values through adding the usage description keys to your info additions or simply by setting up your configuration options in your ",(0,a.kt)("inlineCode",{parentName:"p"},"apm")," project. "),(0,a.kt)("p",null,"The most important string is the camera usage description "),(0,a.kt)("p",null,(0,a.kt)("img",{src:i(1989).Z,width:"300",height:"190"})),(0,a.kt)("p",null,"Set the ",(0,a.kt)("inlineCode",{parentName:"p"},"NSCameraUsageDescription")," key or equivalent ",(0,a.kt)("inlineCode",{parentName:"p"},"apm")," config parameter to set this text."),(0,a.kt)("p",null,"To be able to record audio along with your video you will need to add the microphone usage description key ",(0,a.kt)("inlineCode",{parentName:"p"},"NSMicrophoneUsageDescription")," (or equivalent ",(0,a.kt)("inlineCode",{parentName:"p"},"apm")," config parameter)."),(0,a.kt)("p",null,"If you are saving images to the camera roll the following dialog will be displayed the first time you attempt to save a captured image to the camera roll:"),(0,a.kt)("p",null,(0,a.kt)("img",{src:i(11130).Z,width:"300",height:"190"})),(0,a.kt)("p",null,"There are 2 keys required here that control the text in this dialog, ",(0,a.kt)("inlineCode",{parentName:"p"},"NSPhotoLibraryUsageDescription")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"NSPhotoLibraryAddUsageDescription")," (and equivalent ",(0,a.kt)("inlineCode",{parentName:"p"},"apm")," config parameters). The second key was added in iOS 11.2. You should add both keys to your info additions."),(0,a.kt)("h2",{id:"device-settings"},"Device Settings"),(0,a.kt)("p",null,"If your user has denied access to the camera in some situations you can prompt them to enable them\nand then redirect them to your application device settings, which will allow your user to change\nthe setting."),(0,a.kt)("p",null,"This is especially important on iOS where you only get one attempt to ask your user for permission."),(0,a.kt)("p",null,"To redirect your user simply call the ",(0,a.kt)("inlineCode",{parentName:"p"},"openDeviceSettings()")," function.\nYou can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"canOpenDeviceSettings")," flag to check if the current device supports this functionality."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (CameraUI.instance.canOpenDeviceSettings)\n{\n    CameraUI.instance.openDeviceSettings();\n}\n")))}h.isMDXComponent=!0},1989:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/ios-permission-dialog-camera-3f9c64bd138a48a776a71a433e4682b9.png"},11130:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/ios-permission-dialog-photos-fbc98a2ad7fa61f3b01b337383189650.png"}}]);