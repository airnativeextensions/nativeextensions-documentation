<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="air native extensions Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="air native extensions Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-188619114-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="air native extensions" href="/opensearch.xml"><title data-react-helmet="true">User Messaging Platform | air native extensions</title><meta data-react-helmet="true" property="og:url" content="https://docs.airnativeextensions.com/docs/adverts/user-messaging-platform"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="User Messaging Platform | air native extensions"><meta data-react-helmet="true" name="description" content="Obtaining Consent with the User Messaging Platform"><meta data-react-helmet="true" property="og:description" content="Obtaining Consent with the User Messaging Platform"><meta data-react-helmet="true" property="og:image" content="https://docs.airnativeextensions.com/img/ane-icon-black.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.airnativeextensions.com/img/ane-icon-black.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.airnativeextensions.com/docs/adverts/user-messaging-platform"><link data-react-helmet="true" rel="alternate" href="https://docs.airnativeextensions.com/docs/adverts/user-messaging-platform" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.airnativeextensions.com/docs/adverts/user-messaging-platform" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.80aeca58.css">
<link rel="preload" href="/assets/js/runtime~main.6b86033e.js" as="script">
<link rel="preload" href="/assets/js/main.edb21c4d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/ane-icon-black.png" alt="AIR Native Extensions" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/ane-icon-white.png" alt="AIR Native Extensions" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">AIR Native Extensions</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/news/">News</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT"> </span></div><div class="react-toggle-track-x"><span class="toggle_71bT"> </span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/ane-icon-black.png" alt="AIR Native Extensions" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/ane-icon-white.png" alt="AIR Native Extensions" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">AIR Native Extensions</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/news/">News</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Home</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/adverts/">Adverts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Get Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/add-the-extension">Add the Extension</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Platforms</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/platform/admob">Google AdMob</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/platform/huawei">Huawei Ads Kit</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Usage</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/initialise-platform">Initialise Platform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/advertising-identifier">Advertising Identifier</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/banner-adverts">Banner Adverts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/interstitials">Interstitials</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/rewarded-video-ads">Rewarded Video Ads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/native-ads">Native Ads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/app-open-ads">App Open Ads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/targeting">Targeting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/test-ads">Test Ads</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Consent</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/adverts/user-messaging-platform">User Messaging Platform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/adverts/consent">Consent</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/migrating-to-version-13">Migrating to version 13</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/migrating-to-version-12">Migrating to version 12</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/migrating-to-version-10">Migrating to version 10</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/migrating-from-version-4">Migrating from version 4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/migrating-to-androidx">Migrating to AndroidX</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Mediation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/mediation/adcolony">AdColony</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/mediation/applovin">AppLovin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/mediation/facebookaudience">FacebookAudience</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/mediation/ironsource">IronSource</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/mediation/tapjoy">Tapjoy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/mediation/unityads">UnityAds</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Other</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adverts/changelog">changelog</a></li><li class="menu__list-item"><a href="https://docs.airnativeextensions.com/asdocs/adverts/" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">asdocs</a></li><li class="menu__list-item"><a href="https://docs.airnativeextensions.com/asdocs/adverts-mediation/" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">asdocs - mediators</a></li><li class="menu__list-item"><a href="http://github.com/distriqt/ANE-Adverts/issues/new" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Contact Support</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">User Messaging Platform</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="obtaining-consent-with-the-user-messaging-platform"></a>Obtaining Consent with the User Messaging Platform<a class="hash-link" href="#obtaining-consent-with-the-user-messaging-platform" title="Direct link to heading">#</a></h2><blockquote><p>Important: You must have a <a href="https://support.google.com/fundingchoices/answer/9180084" target="_blank" rel="noopener noreferrer">Funding Choices</a> account linked to your AdMob account.</p><p>To create a Funding Choices account, go to <strong>Privacy &amp; messaging</strong> in the AdMob UI and select <strong>Go to Funding Choices</strong>. The Funding Choices account is then created automatically in the background. </p></blockquote><p>Before attempting to integrate the SDK you should ensure Funding Choices is enabled on your application and that you have created at least one form.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><blockquote><p>Under the Google EU User Consent Policy, you must make certain disclosures to your users in the European Economic Area (EEA) along with the UK and obtain their consent to use cookies or other local storage, where legally required, and to use personal data (such as AdID) to serve ads. This policy reflects the requirements of the EU ePrivacy Directive and the General Data Protection Regulation (GDPR).</p><p>To support publishers in meeting their duties under this policy, Google offers the User Messaging Platform (UMP) SDK, which replaces the previous open source Consent SDK. The UMP SDK has been updated to support the latest IAB standards. We&#x27;ve also simplified the process of setting up consent forms and listing ad providers. All of these configurations can now conveniently be handled in the Funding Choices UI.</p><p>It is a best practice to load a form every time the user launches your app, even if you determine consent is not required, so that the form is ready to display in case the user wishes to change their consent setting.</p><p>This guide walks you through how to install the SDK, implement the IAB solutions, and enable testing features.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="usage"></a>Usage<a class="hash-link" href="#usage" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="request-consent-information"></a>Request Consent Information<a class="hash-link" href="#request-consent-information" title="Direct link to heading">#</a></h3><p>You retrieve the consent information through the <code>ConsentInformation</code> instance accessible via:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">var consentInformation:ConsentInformation = Adverts.service.ump.getConsentInformation();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This object has the consent information including:</p><ul><li><code>consentInformation.getConsentStatus()</code>: The current user consent status (see <code>ConsentStatus</code> constants);</li><li><code>consentInformation.getConsentType()</code>: The type of consent (see <code>ConsentType</code> constants); <strong>Android only. This has been removed on iOS</strong></li><li><code>consentInformation.isConsentFormAvailable()</code>: Whether a form is available to be loaded and displayed to the user;</li></ul><p><strong>It is recommended that you request an update of the consent information at every app launch. This will determine whether or not your user needs to provide consent.</strong></p><p>To update consent information call the  <code>requestConsentInfoUpdate()</code> function on the consent information object.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">var params:ConsentRequestParameters = new ConsentRequestParameters();</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">consentInformation.requestConsentInfoUpdate( params );</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This will dispatch one of two possible events:</p><ul><li><code>ConsentInformationEvent.CONSENT_INFO_UPDATE_SUCCESS</code>: When the consent information was updated successfully;</li><li><code>ConsentInformationEvent.CONSENT_INFO_UPDATE_FAILURE</code>: When there was an error updating the consent information;</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">var consentInformation:ConsentInformation = Adverts.service.ump.getConsentInformation();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">consentInformation.addEventListener( ConsentInformationEvent.CONSENT_INFO_UPDATE_SUCCESS, updateSuccessHandler );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">consentInformation.addEventListener( ConsentInformationEvent.CONSENT_INFO_UPDATE_FAILURE, updateFailureHandler );</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">var params:ConsentRequestParameters = new ConsentRequestParameters();</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">consentInformation.requestConsentInfoUpdate( params );</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function updateSuccessHandler( event:ConsentInformationEvent ):void</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // consent information has been updated</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function updateFailureHandler( event:ConsentInformationEvent ):void</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    trace( &quot;ERROR: [&quot; + event.error.errorID + &quot;] &quot; + event.error.message );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="load-a-form-if-available"></a>Load a form if available<a class="hash-link" href="#load-a-form-if-available" title="Direct link to heading">#</a></h3><p>Once you&#x27;ve determined that you will ask a user for consent, the next step is to determine if a form is available.</p><p>There are a variety of reasons why a form may not be available, such as:</p><ul><li>The user has limited ad tracking enabled.</li><li>You tagged the user as under the age of consent.</li></ul><p>To check if a form is available, use the <code>isConsentFormAvailable()</code> method on the <code>ConsentInformation</code> instance. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">if (consentInformation.isConsentFormAvailable())</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // A form is available to load</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Adverts.service.ump.addEventListener( UserMessagingPlatformEvent.CONSENT_FORM_LOAD_SUCCESS, loadFormSuccessHandler );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Adverts.service.ump.addEventListener( UserMessagingPlatformEvent.CONSENT_FORM_LOAD_FAILURE, loadFormFailureHandler );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Adverts.service.ump.loadConsentForm();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To load the form call the <code>loadConsentForm()</code> of the <code>UserMessagingPlatform</code> instance.
This will dispatch one of two possible events:</p><ul><li><code>UserMessagingPlatformEvent.CONSENT_FORM_LOAD_SUCCESS</code>: When the form has been loaded and is ready to be shown;</li><li><code>UserMessagingPlatformEvent.CONSENT_FORM_LOAD_FAILURE</code>: When an error occurred, try again later to load the form successfully before attempting to show;</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">if (consentInformation.isConsentFormAvailable())</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Adverts.service.ump.addEventListener( UserMessagingPlatformEvent.CONSENT_FORM_LOAD_SUCCESS, loadFormSuccessHandler );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Adverts.service.ump.addEventListener( UserMessagingPlatformEvent.CONSENT_FORM_LOAD_FAILURE, loadFormFailureHandler );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Adverts.service.ump.loadConsentForm();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function loadFormSuccessHandler( event:UserMessagingPlatformEvent ):void</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // Form loaded and ready to be shown</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function loadFormFailureHandler( event:UserMessagingPlatformEvent ):void</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // An error occurred</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="present-the-form-if-required"></a>Present the form if required<a class="hash-link" href="#present-the-form-if-required" title="Direct link to heading">#</a></h3><p>To present the form use the <code>showConsentForm()</code> on the <code>UserMessagingPlatform</code> instance.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Adverts.service.ump.showConsentForm();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You should determine if the user requires consent prior to presenting the form. To check if consent is required, check the <code>getConsentStatus()</code> method on the <code>ConsentInformation</code> object, which returns an value from the <code>ConsentStatus</code> class. There are four possible values:</p><ul><li><code>ConsentStatus.UNKNOWN</code>: Unknown consent status.</li><li><code>ConsentStatus.REQUIRED</code>: User consent required but not yet obtained.</li><li><code>ConsentStatus.NOT_REQUIRED</code>: User consent not required. For example, the user is not in the EEA or the UK.</li><li><code>ConsentStatus.OBTAINED</code>: User consent obtained. Personalization not defined.</li></ul><p>For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function loadFormSuccessHandler( event:UserMessagingPlatformEvent ):void</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // Form loaded and ready to be shown</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if (Adverts.service.ump.getConsentInformation().getConsentStatus() == ConsentStatus.REQUIRED)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Adverts.service.ump.showConsentForm();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><img src="/assets/images/ump_consent_form-caa615f26c09e346141aac11553a165d.png"></p><p>You can also use the form to give your user the option to change their consent status. You may wish to do this in a settings screen, and call the <code>showConsentForm()</code> to present the form so the user can change their consent as required.</p><p>The <code>showConsentForm()</code> process will dispatch the <code>ConsentInformationEvent.CONSENT_FORM_DISMISSED</code> event when the consent form was dismissed.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Adverts.service.ump.addEventListener( UserMessagingPlatformEvent.CONSENT_FORM_DISMISSED, formDismissedHandler );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Adverts.service.ump.showConsentForm();</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function formDismissedHandler( event:UserMessagingPlatformEvent ):void </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // Handle form dismissal</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="testing"></a>Testing<a class="hash-link" href="#testing" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="force-a-geography"></a>Force a geography<a class="hash-link" href="#force-a-geography" title="Direct link to heading">#</a></h3><p>The UMP SDK provides a simple way to test your app&#x27;s behavior as though the device was located in the EEA or UK using the <code>debugGeography</code>.</p><p>You will need to provide your test device&#x27;s hashed ID in your app&#x27;s debug settings to use the debug functionality. If you call <code>requestConsentUpdate()</code> without setting this value, your app will log the required ID hash when run to the <a href="/docs/tutorials/device-logs">native device log</a>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">var params:ConsentRequestParameters = new ConsentRequestParameters()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        .setTagForUnderAgeOfConsent( false )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        .setConsentDebugSettings(</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                new ConsentDebugSettings()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        .addTestDeviceHashedId( &quot;TEST-DEVICE-HASHED-ID&quot; )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        .setDebugGeography( com.distriqt.extension.adverts.ump.DebugGeography.DEBUG_GEOGRAPHY_EEA )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Adverts.service.ump.getConsentInformation()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    .requestConsentInfoUpdate( params );</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To force the SDK to treat the device as though it is not in the EEA or UK, use <code>DEBUG_GEOGRAPHY_NOT_EEA</code>.
Note that debug settings only work on test devices. Emulators do not need to be added to the device id list as they have testing enabled by default.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="reset"></a>Reset<a class="hash-link" href="#reset" title="Direct link to heading">#</a></h3><p>In testing your app with the UMP SDK, you may find it helpful to reset the state of the consent SDK so that you can simulate a user&#x27;s first install experience. The SDK provides the <code>reset()</code> method of the <code>ConsentInformation</code> interface to do this.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Adverts.service.ump.getConsentInformation().reset();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You should also call reset if you decide to remove the UMP SDK completely from your project.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="delay-app-measurement-optional"></a>Delay app measurement (optional)<a class="hash-link" href="#delay-app-measurement-optional" title="Direct link to heading">#</a></h2><p>By default, the Google Mobile Ads SDK initializes app measurement and begins sending user-level event data to Google immediately when the app starts. This initialization behavior ensures you can enable AdMob user metrics without making additional code changes.</p><p>However, if your app requires user consent before these events can be sent, you can delay app measurement until you explicitly initialize the Mobile Ads SDK or load an ad.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="android"></a>Android<a class="hash-link" href="#android" title="Direct link to heading">#</a></h4><p>To delay app measurement, add the following <code>&lt;meta-data&gt;</code> tag in your manifest additions, inside the <code>&lt;application&gt;</code> node:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><div tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Delay app measurement until MobileAds.initialize() is called. --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta-data</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">android:</span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">com.google.android.gms.ads.DELAY_APP_MEASUREMENT_INIT</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">android:</span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">true</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ios"></a>iOS<a class="hash-link" href="#ios" title="Direct link to heading">#</a></h4><p>To delay app measurement, add the <code>GADDelayAppMeasurementInit</code> key with a boolean value of <code>true</code> to your app’s InfoAdditions:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><div tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">GADDelayAppMeasurementInit</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">true</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/adverts/test-ads"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Test Ads</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/adverts/consent"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Consent »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#obtaining-consent-with-the-user-messaging-platform" class="table-of-contents__link">Obtaining Consent with the User Messaging Platform</a></li><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#usage" class="table-of-contents__link">Usage</a><ul><li><a href="#request-consent-information" class="table-of-contents__link">Request Consent Information</a></li><li><a href="#load-a-form-if-available" class="table-of-contents__link">Load a form if available</a></li><li><a href="#present-the-form-if-required" class="table-of-contents__link">Present the form if required</a></li></ul></li><li><a href="#testing" class="table-of-contents__link">Testing</a><ul><li><a href="#force-a-geography" class="table-of-contents__link">Force a geography</a></li><li><a href="#reset" class="table-of-contents__link">Reset</a></li></ul></li><li><a href="#delay-app-measurement-optional" class="table-of-contents__link">Delay app measurement (optional)</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials/">tutorials</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/distriqt" target="_blank" rel="noopener noreferrer" class="footer__link-item">twitter</a></li><li class="footer__item"><a href="https://github.com/Gamua/Adobe-Runtime-Support/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">AIR discussions</a></li><li class="footer__item"><a href="https://forum.starling-framework.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">starling</a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/distriqt" target="_blank" rel="noopener noreferrer" class="footer__link-item">stack overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/news">news</a></li><li class="footer__item"><a href="https://airnativeextensions.com/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">privacy</a></li><li class="footer__item"><a href="https://airnativeextensions.com/license" target="_blank" rel="noopener noreferrer" class="footer__link-item">license</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><br><a href="https://airnativeextensions.com">airnativeextensions.com</a> copyright © 2021 <br><br><a href="https://distriqt.com"><img src="/img/logo.png" alt="distriqt"></a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.6b86033e.js"></script>
<script src="/assets/js/main.edb21c4d.js"></script>
</body>
</html>