"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[16071],{28453:(t,e,n)=>{n.d(e,{R:()=>s,x:()=>a});var o=n(96540);const i={},r=o.createContext(i);function s(t){const e=o.useContext(r);return o.useMemo(function(){return"function"==typeof t?t(e):{...e,...t}},[e,t])}function a(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(i):t.components||i:s(t.components),o.createElement(r.Provider,{value:e},t.children)}},96703:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"share/appextension---share-extension","title":"AppExtension - Share Extension","description":"Share Extension Functionality","source":"@site/docs/share/appextension---share-extension.md","sourceDirName":"share","slug":"/share/appextension---share-extension","permalink":"/docs/share/appextension---share-extension","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"AppExtension - Share Extension","sidebar_label":"AppExtension - Share Extension"},"sidebar":"share","previous":{"title":"AppExtension - Setup","permalink":"/docs/share/appextension---setup"},"next":{"title":"Migrating to v8.1","permalink":"/docs/share/migrating-to-v8.1"}}');var i=n(74848),r=n(28453);const s={title:"AppExtension - Share Extension",sidebar_label:"AppExtension - Share Extension"},a=void 0,l={},c=[{value:"Share Extension Functionality",id:"share-extension-functionality",level:2}];function d(t){const e={code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...t.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"share-extension-functionality",children:"Share Extension Functionality"}),"\n",(0,i.jsx)(e.p,{children:"TODO::"}),"\n",(0,i.jsx)(e.p,{children:"Some code for your main App Extension file:"}),"\n",(0,i.jsx)(e.p,{children:"Your view controller should look something like the following to start:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-objc",children:"@interface ShareViewController ()\n\n@end\n\n@implementation ShareViewController\n\n- (BOOL)isContentValid {\n    // Do validation of contentText and/or NSExtensionContext attachments here\n    return YES;\n}\n\n- (void)didSelectPost {\n    // This is called after the user selects Post. Do the upload of contentText and/or NSExtensionContext attachments.\n    \n    // Inform the host that we're done, so it un-blocks its UI. Note: Alternatively you could call super's -didSelectPost, which will similarly complete the extension context.\n    [self.extensionContext completeRequestReturningItems:@[] completionHandler:nil];\n}\n\n- (NSArray *)configurationItems {\n    // To add configuration options via table cells at the bottom of the sheet, return an array of SLComposeSheetConfigurationItem here.\n    return @[];\n}\n\n@end\n"})}),"\n",(0,i.jsx)(e.p,{children:"This is just a rough dump of some code I was playing with to get a url to share"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-objc",children:'@implementation ShareViewController\n{\n\tNSUInteger _itemCount;\n\tNSString* _invokeArgs;\n}\n\n\n- (BOOL) isContentValid\n{\n\t// Do validation of contentText and/or NSExtensionContext attachments here\n\treturn YES;\n}\n\n- (void) didSelectPost\n{\n\t// This is called after the user selects Post. Do the upload of contentText and/or NSExtensionContext attachments.\n\tNSLog( @"distriqt:SHAREEXTENSION:didSelectPost" );\n\t\n\tNSLog( @"distriqt:SHAREEXTENSION:%@", self.contentText );\n\t\n\tNSExtensionItem* item = self.extensionContext.inputItems.firstObject;\n\n\t_invokeArgs = NULL;\n\t_itemCount = item.attachments.count;\n\t\n\tfor (NSItemProvider* itemProvider in item.attachments)\n\t{\n\t\tif ([itemProvider hasItemConformingToTypeIdentifier: (NSString*)kUTTypeURL])\n\t\t{\n\t\t\tNSLog( @"distriqt:SHAREEXTENSION:item is url" );\n\t\t\t[itemProvider loadItemForTypeIdentifier: (NSString*)kUTTypeURL\n\t\t\t\t\t\t\t\t\t\t\toptions: nil\n\t\t\t\t\t\t\t\t  completionHandler:^(id<NSSecureCoding>  _Nullable item, NSError * _Null_unspecified error)\n\t\t\t{\n\t\t\t\tNSURL* url = (NSURL*)item;\n\t\t\t\tNSLog( @"distriqt:SHAREEXTENSION:loaded:%@", url );\n\t\t\t\tif ([url.absoluteString rangeOfString: @"youtube"].location == NSNotFound)\n\t\t\t\t{\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t[self invokeApp: url.absoluteString];\n\t\t\t}];\n\t\t}\n\t\telse if ([itemProvider hasItemConformingToTypeIdentifier: (NSString*)kUTTypeImage])\n\t\t{\n\t\t\tNSLog( @"distriqt:SHAREEXTENSION:item is image" );\n\t\t\t[itemProvider loadItemForTypeIdentifier: (NSString*)kUTTypeImage\n\t\t\t\t\t\t\t\t\t\t\toptions: nil\n\t\t\t\t\t\t\t\t  completionHandler:^(id<NSSecureCoding>  _Nullable item, NSError * _Null_unspecified error)\n\t\t\t{\n\t\t\t\t[self invokeApp: @""];\n\t\t\t}];\n\t\t}\n\t}\n\n}\n\n\n- (NSArray *) configurationItems\n{\n\t// To add configuration options via table cells at the bottom of the sheet, return an array of SLComposeSheetConfigurationItem here.\n\treturn @[];\n}\n\n\n- (void) invokeApp: (NSString *)invokeArgs\n{\n\t// Prepare the URL request\n\t// this will use the custom url scheme of your app\n\t// and the paths to the photos you want to share:\n\tNSString * urlString = [NSString stringWithFormat: @"%@://%@", @"distriqt-test", ( NULL == invokeArgs ? @"" : invokeArgs ) ];\n\tNSURL * url = [NSURL URLWithString: urlString];\n\t\n\tNSString *className = @"UIApplication";\n\tif (NSClassFromString( className ))\n\t{\n\t\tid object = [ NSClassFromString(className) performSelector: @selector(sharedApplication) ];\n\t\t[object performSelector: @selector(openURL:) withObject: url];\n\t}\n\t\n\t// Now let the host app know we are done, so that it unblocks its UI:\n\t[super didSelectPost];\n}\n\n@end\n'})}),"\n",(0,i.jsx)(e.p,{children:"This code uses a custom url scheme to launch the application so you'll need to add the following to your InfoAdditions in your application descriptor:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\t<key>CFBundleURLTypes</key>\n\t<array>\n\t\t<dict>\n\t\t\t<key>CFBundleURLSchemes</key>\n\t\t\t<array>\n\t\t\t\t<string>distriqt-test</string>\n\t\t\t</array>\n\t\t</dict>\n\t</array>\n"})})]})}function p(t={}){const{wrapper:e}={...(0,r.R)(),...t.components};return e?(0,i.jsx)(e,{...t,children:(0,i.jsx)(d,{...t})}):d(t)}}}]);