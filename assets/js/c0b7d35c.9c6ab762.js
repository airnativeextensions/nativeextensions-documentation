(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[50615],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return l},kt:function(){return h}});var i=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=i.createContext({}),u=function(e){var n=i.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},l=function(e){var n=u(e.components);return i.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},d=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=u(t),h=a,g=d["".concat(c,".").concat(h)]||d[h]||p[h]||o;return t?i.createElement(g,r(r({ref:n},l),{},{components:t})):i.createElement(g,r({ref:n},l))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,r=new Array(o);r[0]=d;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var u=2;u<o;u++)r[u]=t[u];return i.createElement.apply(null,r)}return i.createElement.apply(null,t)}d.displayName="MDXCreateElement"},90177:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return r},metadata:function(){return s},toc:function(){return c},default:function(){return l}});var i=t(22122),a=t(19756),o=(t(67294),t(3905)),r={title:"Heading",sidebar_label:"Heading"},s={unversionedId:"compass/heading",id:"compass/heading",isDocsHomePage:!1,title:"Heading",description:"Heading Updates",source:"@site/docs/compass/heading.md",sourceDirName:"compass",slug:"/compass/heading",permalink:"/docs/compass/heading",version:"current",sidebar_label:"Heading",frontMatter:{title:"Heading",sidebar_label:"Heading"},sidebar:"compass",previous:{title:"Add the Extension",permalink:"/docs/compass/add-the-extension"},next:{title:"Magnetic Field Sensor",permalink:"/docs/compass/magnetic-field-sensor"}},c=[{value:"Heading Updates",id:"heading-updates",children:[]},{value:"True Heading",id:"true-heading",children:[]}],u={toc:c};function l(e){var n=e.components,t=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,i.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"heading-updates"},"Heading Updates"),(0,o.kt)("p",null,"Once you've initialised the extension calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"register")," function will start\nthe update of event updates (",(0,o.kt)("inlineCode",{parentName:"p"},"CompassEvent"),")."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (Compass.isSupported)\n{\n    Compass.init( APP_KEY );\n    Compass.service.addEventListener( CompassEvent.HEADING_UPDATED, compass_headingUpdatedHandler );\n    Compass.service.register();\n}\n")),(0,o.kt)("p",null,"Listening for the ",(0,o.kt)("inlineCode",{parentName:"p"},"CompassEvent.HEADING_UPDATED")," will give you periodic events with\nheading information:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'private function compass_headingUpdatedHandler( event:CompassEvent ):void\n{\n    trace( "Heading: " + event.magneticHeading +"   ["+event.headingAccuracy+"]" );\n}\n')),(0,o.kt)("p",null,"When your application no longer requires the heading updates it's important to call\n",(0,o.kt)("inlineCode",{parentName:"p"},"unregister")," to stop the active usage of the sensors on the device. This will\nconserve battery life etc. This is important when your application goes into\nbackground operation. It's suggested that you use a mechanism to unregister\nthe ANE when this occurs, by using something like the ACTIVATE/DEACTIVATE events."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (Compass.isSupported && Compass.service.isRegistered)\n{\n    Compass.service.unregister();\n}\n")),(0,o.kt)("h2",{id:"true-heading"},"True Heading"),(0,o.kt)("p",null,"On iOS you can access the true heading of the device, however this requires access to the device location so you will need to add some additional properties to your application and request permission to access the device location. "),(0,o.kt)("p",null,"You will need to add the following to your iPhone info additions:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- iOS 6,7 --\x3e\n<key>NSLocationUsageDescription</key>\n<string>This application would like to use your location.</string>\n\n\x3c!-- iOS 8 + --\x3e\n<key>NSLocationWhenInUseUsageDescription</key>\n<string>This application would like to use your location when in use.</string>\n<key>NSLocationAlwaysUsageDescription</key>\n<string>This application would like to use your location in the background.</string>\n\n\x3c!-- iOS 11 + --\x3e\n<key>NSLocationAlwaysAndWhenInUseUsageDescription</key>\n<string>This application would like to use your location in the background and the foreground.</string>\n")),(0,o.kt)("h4",{id:"authorisation"},"Authorisation"),(0,o.kt)("p",null,"When you are going to be accessing the user's location you must check that your application has been allowed access. To this end the extension provides several helpers to check and request access to the location services."),(0,o.kt)("p",null,"On iOS the user must be asked at runtime, which you only get one chance to ask, after which you must direct the user to manually change the permissions in the settings."),(0,o.kt)("p",null,"You can check if you currently have permission using the ",(0,o.kt)("inlineCode",{parentName:"p"},"hasAuthorisation")," function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (Compass.service.hasAuthorisation())\n{\n    // Application has permission to access trueHeading\n}\n")),(0,o.kt)("p",null,"If this returns false you should expect a ",(0,o.kt)("inlineCode",{parentName:"p"},"-1")," value for true heading."),(0,o.kt)("p",null,"To request authorisation at runtime, you call the ",(0,o.kt)("inlineCode",{parentName:"p"},"requestAuthorisation")," function.\nThe following code will work across both platforms:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'switch (Compass.service.authorisationStatus())\n{\n    case AuthorisationStatus.ALWAYS:\n    case AuthorisationStatus.IN_USE:\n        trace( "User allowed access: " + Compass.service.authorisationStatus() );\n        break;\n    \n    case AuthorisationStatus.NOT_DETERMINED:\n    case AuthorisationStatus.SHOULD_EXPLAIN:\n        Compass.service.addEventListener( AuthorisationEvent.CHANGED, authorisationChangedHandler );\n        Compass.service.requestAuthorisation( AuthorisationStatus.ALWAYS );\n        break;\n    \n    case AuthorisationStatus.RESTRICTED:\n    case AuthorisationStatus.DENIED:\n    case AuthorisationStatus.UNKNOWN:\n        trace( "User denied access" );\n        break;\n}\n\nfunction authorisationChangedHandler( event:AuthorisationEvent ):void\n{\n    //\n}\n')),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"True Heading is not supported on Android")))}l.isMDXComponent=!0}}]);