(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{105:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return a})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return l}));var o=n(2),r=(n(0),n(126));const s={title:"Consent",sidebar_label:"Consent"},a={unversionedId:"adverts/consent",id:"adverts/consent",isDocsHomePage:!1,title:"Consent",description:"The Consent SDK has been deprecated. You should migrate to the new User Messaging Platform to ensure you have access to the latest consent gathering tools",source:"@site/docs/adverts/consent.md",slug:"/adverts/consent",permalink:"/docs/adverts/consent",version:"current",sidebar_label:"Consent",sidebar:"adverts",previous:{title:"User Messaging Platform",permalink:"/docs/adverts/user-messaging-platform"},next:{title:"Troubleshooting",permalink:"/docs/adverts/troubleshooting"}},i=[{value:"The Consent SDK",id:"the-consent-sdk",children:[]},{value:"AdMob Settings",id:"admob-settings",children:[]},{value:"Consent Status",id:"consent-status",children:[]},{value:"Consent Form",id:"consent-form",children:[{value:"Consent Form Resources",id:"consent-form-resources",children:[]}]},{value:"Testing",id:"testing",children:[]},{value:"Forward consent to the Google Mobile Ads SDK",id:"forward-consent-to-the-google-mobile-ads-sdk",children:[]}],c={rightToc:i};function l({components:e,...t}){return Object(r.b)("wrapper",Object(o.a)({},c,t,{components:e,mdxType:"MDXLayout"}),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},Object(r.b)("strong",{parentName:"p"},"The Consent SDK has been deprecated. You should migrate to the new ",Object(r.b)("a",Object(o.a)({parentName:"strong"},{href:"user-messaging-platform"}),"User Messaging Platform")," to ensure you have access to the latest consent gathering tools"))),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},Object(r.b)("strong",{parentName:"p"},"Important")," There are additional resources required to be packaged with your application in order to use this part of the SDK.\nThis is described in the ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"consent#consent-form-resources"}),"Consent Form Resources")," section below.")),Object(r.b)("h2",{id:"the-consent-sdk"},"The Consent SDK"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Under the Google EU User Consent Policy, you must make certain disclosures to your users in the European Economic Area (EEA) and obtain their consent to use cookies or other local storage, where legally required, and to use personal data (such as AdID) to serve ads. This policy reflects the requirements of the EU ePrivacy Directive and the General Data Protection Regulation (GDPR)."),Object(r.b)("p",{parentName:"blockquote"},"To support publishers in meeting their duties under this policy, Google offers a Consent SDK. The Consent SDK is an open-source library that provides utility functions for collecting consent from your users."),Object(r.b)("p",{parentName:"blockquote"},"Ads served by Google can be categorized as personalized or non-personalized, both requiring consent from users in the EEA. By default, ad requests to Google serve personalized ads, with ad selection based on the user's previously collected data. Google also supports configuring ad requests to serve non-personalized ads. Learn more about personalized and non-personalized ads."),Object(r.b)("p",{parentName:"blockquote"},"This guide describes how to use the Consent SDK to obtain consent from users. It also describes how to forward consent to the Google Mobile Ads SDK once you have obtained consent.")),Object(r.b)("h2",{id:"admob-settings"},"AdMob Settings"),Object(r.b)("p",null,"Firstly lets check you have setup your AdMob account to allow usage of the Consent SDK."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Sign in to your AdMob account and ",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://support.google.com/admob/answer/7666519#providers"}),"select ad technology providers"),".")),Object(r.b)("p",null,"If you plan to use the consent form then you will need to make sure you select the ",Object(r.b)("strong",{parentName:"p"},"Custom set of ad technology providers")," when you ",Object(r.b)("strong",{parentName:"p"},"Select ad technology providers"),".\nThis is located in the  ",Object(r.b)("em",{parentName:"p"},"Blocking Controls / EU User Consent")," section."),Object(r.b)("p",null,Object(r.b)("img",{src:n(211).default})),Object(r.b)("h2",{id:"consent-status"},"Consent Status"),Object(r.b)("p",null,"Prior to using any other methods in the Consent SDK, you should update consent status to make sure the Consent SDK has the latest information regarding the ad technology providers you've selected in the AdMob UI. If the list of ad technology providers has changed since the user last provided consent, the consent state is set back to an unknown state."),Object(r.b)("p",null,"To retrieve and update the consent status call the ",Object(r.b)("inlineCode",{parentName:"p"},"getConsentStatus")," function:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-as3"}),'Adverts.service.consent.getConsentStatus( "publisher_id" );\n')),Object(r.b)("p",null,"The publisher id is taken from your AdMob account as shown in the ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"consent#admob-settings"}),"AdMob Settings")," section."),Object(r.b)("p",null,"This is an asynchronous process and will dispatch one of two possible events:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"ConsentEvent.STATUS_UPDATED"),": Dispatched when the consent status has been updated"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"ConsentEvent.STATUS_ERROR"),": Dispatched when there was an error retrieving the consent status")),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-as3"}),'Adverts.service.consent.addEventListener( ConsentEvent.STATUS_UPDATED, statusUpdatedHandler );\nAdverts.service.consent.addEventListener( ConsentEvent.STATUS_ERROR, statusErrorHandler );\n\nAdverts.service.consent.getConsentStatus( "publisher_id" );\n\n\nfunction statusUpdatedHandler( event:ConsentEvent ):void\n{\n    trace( "statusUpdatedHandler(): " + event.status\n            + " inEea:" + event.inEeaOrUnknown );\n}\n\nprivate function statusErrorHandler( event:ConsentEvent ):void\n{\n    trace( "statusErrorHandler(): " + event.error );\n}\n')),Object(r.b)("h2",{id:"consent-form"},"Consent Form"),Object(r.b)("p",null,"Asking for consent will involve presentation of the consent form. "),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"The Google-rendered consent form is a full-screen configurable form that displays over your app content. You can configure the form to present the user with combinations of the following options:"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"Consent to view personalized ads"),Object(r.b)("li",{parentName:"ul"},"Consent to view non-personalized ads"),Object(r.b)("li",{parentName:"ul"},"Use a paid version of the app instead of viewing ads")),Object(r.b)("p",{parentName:"blockquote"},"You should review the consent text carefully: what appears by default is a message that might be appropriate if you use Google to monetize your app; but we cannot provide legal advice on the consent text that is appropriate for you.\nTo update consent text of the Google-rendered consent form, modify the ",Object(r.b)("inlineCode",{parentName:"p"},"consentform.html")," file included in the Consent SDK as required.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(212).default})),Object(r.b)("p",null,"The Google-rendered consent form is configured using the ",Object(r.b)("inlineCode",{parentName:"p"},"ConsentOptions")," class and displayed using the ",Object(r.b)("inlineCode",{parentName:"p"},"askForConsent(options)")," function.\nThe following code demonstrates how to display a form with all three consent options:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-as3"}),'var options:ConsentOptions = new ConsentOptions( "https://www.your.com/privacyurl" )\n                    .withPersonalizedAdsOption()\n                    .withNonPersonalizedAdsOption()\n                    .withAdFreeOption();\n\nAdverts.service.consent.askForConsent( options );;\n')),Object(r.b)("p",null,"Once you have called ",Object(r.b)("inlineCode",{parentName:"p"},"askForConsent")," you will receive one of two events:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"ConsentEvent.FORM_CLOSED"),": Dispatched when the user has selected their consent status and the form has been closed",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"event.status"),":  Is a string containing one of the values defined in the ConsentStatus class."))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"ConsentEvent.FORM_ERROR"),": Dispatched when there was an error loading or displaying the form",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"event.error"),": Will be a description of the error that occurred.")))),Object(r.b)("p",null,"See ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://docs.airnativeextensions.com/asdocs/adverts/com/distriqt/extension/adverts/events/ConsentEvent.html"}),Object(r.b)("inlineCode",{parentName:"a"},"ConsentEvent"))," for more information on the fields."),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-as3"}),'var options:ConsentOptions = new ConsentOptions( "https://www.your.com/privacyurl" )\n        .withPersonalizedAdsOption()\n        .withNonPersonalizedAdsOption();\n\nAdverts.service.consent.addEventListener( ConsentEvent.FORM_CLOSED, formClosedHandler );\nAdverts.service.consent.addEventListener( ConsentEvent.FORM_ERROR, formErrorHandler );\n\nAdverts.service.consent.askForConsent( options );\n\n\nfunction formClosedHandler( event:ConsentEvent ):void\n{\n    trace( "formClosedHandler(): " + event.status\n            + " inEea:" + event.inEeaOrUnknown\n            + " adFree:" + event.userPrefersAdFree );\n}\n\nfunction formErrorHandler( event:ConsentEvent ):void\n{\n    trace( "formErrorHandler(): " + event.error );\n}\n')),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"The Google-rendered consent form is not supported if any of your publisher IDs use the commonly used set of ad technology providers. Attempting to load the Google-rendered consent form will always fail in this case.")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Remember to provide users with the option to change or revoke consent.")),Object(r.b)("h3",{id:"consent-form-resources"},"Consent Form Resources"),Object(r.b)("p",null,"You need to package some additional assets with your application for the consent form. This is the html content for the consent form.\nIt is packaged in a slightly different form for Android and iOS so we will address each separately."),Object(r.b)("h4",{id:"consent-form-resources---android"},"Consent Form Resources - Android"),Object(r.b)("p",null,"On Android you will need to place the ",Object(r.b)("inlineCode",{parentName:"p"},"consentform.html")," file in the root of your application package and ensure it is packaged with your application."),Object(r.b)("p",null,"If you wish to customise the form, such as changing the textural content, you should update this html file."),Object(r.b)("h4",{id:"consent-form-resources---ios"},"Consent Form Resources - iOS"),Object(r.b)("p",null,"On iOS you will need to place the ",Object(r.b)("inlineCode",{parentName:"p"},"PersonalizedAdConsent.bundle")," in the root of your application package and ensure it is packaged with your application."),Object(r.b)("p",null,"If you wish to customise the form, such as changing the textural content, you should update the ",Object(r.b)("inlineCode",{parentName:"p"},"consentform.html")," file contained within the bundle."),Object(r.b)("h2",{id:"testing"},"Testing"),Object(r.b)("p",null,"The Consent SDK has different behaviors depending on the location of the user. For example, the consent form fails to load if the user is not located in the EEA."),Object(r.b)("p",null,"To enable easier testing of your app both inside and outside the EEA, the Consent SDK supports debug options that you can set prior to calling any other methods in the Consent SDK."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Update the consent status by calling ",Object(r.b)("inlineCode",{parentName:"li"},"getConsentStatus()")," as described above. ")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"On Android check the ",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://airnativeextensions.github.io/tutorials/device-logs"}),"logcat output")," for the following log:")),Object(r.b)("blockquote",null,Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(o.a)({parentName:"pre"},{}),'I/ConsentInformation: Use ConsentInformation.getInstance(context).addTestDevice("33BE2250B43518CCDA7DE426D04EE231") to get test ads on this device.\n'))),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"On iOS get the value of the ",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"advertising-identifier"}),"Advertising identifier"),". ")),Object(r.b)("ol",{start:2},Object(r.b)("li",{parentName:"ol"},"Whitelist your device to be a debug device using the advertising ID:")),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{}),'Adverts.service.consent.addTestDevice( "33BE2250B43518CCDA7DE426D04EE231" );\n')),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},"Finally, call setDebugGeography to set your preferred geography for testing purposes.")),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{}),"Adverts.service.consent.setDebugGeography( DebugGeography.DEBUG_GEOGRAPHY_EEA );\n")),Object(r.b)("p",null,"After completing these steps, calls to update consent status will take into account your debug geography."),Object(r.b)("h2",{id:"forward-consent-to-the-google-mobile-ads-sdk"},"Forward consent to the Google Mobile Ads SDK"),Object(r.b)("p",null,"Once you have gathered consent you must set the appropriate information on an ad request. See the ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"targeting"}),"Targeting section")," for more information."))}l.isMDXComponent=!0},126:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var o=n(0),r=n.n(o);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},s=Object.keys(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),d=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=d(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=r.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,a=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=d(n),p=o,h=u["".concat(a,".").concat(p)]||u[p]||b[p]||s;return n?r.a.createElement(h,i(i({ref:t},l),{},{components:n})):r.a.createElement(h,i({ref:t},l))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,a=new Array(s);a[0]=p;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,a[1]=i;for(var l=2;l<s;l++)a[l]=n[l];return r.a.createElement.apply(null,a)}return r.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},211:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/admob-eu-user-consent-ae043862dd45ef88530bfcfebb98564c.png"},212:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/android_eu_consent_form-ae69abb15b6754b2ec01d86f1d8562d2.png"}}]);