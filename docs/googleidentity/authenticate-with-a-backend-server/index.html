<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="air native extensions Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="air native extensions Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-188619114-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="air native extensions" href="/opensearch.xml"><title data-react-helmet="true">Authenticate with a backend server | air native extensions</title><meta data-react-helmet="true" property="og:url" content="https://docs.airnativeextensions.com/docs/googleidentity/authenticate-with-a-backend-server"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Authenticate with a backend server | air native extensions"><meta data-react-helmet="true" name="description" content="If you use Google Sign-In with an app or site that communicates with a backend server, you might need to identify the currently signed-in user on the server. To do so securely, after a user successfully signs in, send the user&#x27;s ID token to your server using HTTPS. Then, on the server, verify the integrity of the ID token and use the user information contained in the token to establish a session or create a new account."><meta data-react-helmet="true" property="og:description" content="If you use Google Sign-In with an app or site that communicates with a backend server, you might need to identify the currently signed-in user on the server. To do so securely, after a user successfully signs in, send the user&#x27;s ID token to your server using HTTPS. Then, on the server, verify the integrity of the ID token and use the user information contained in the token to establish a session or create a new account."><meta data-react-helmet="true" property="og:image" content="https://docs.airnativeextensions.com/img/ane-icon-black.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.airnativeextensions.com/img/ane-icon-black.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.airnativeextensions.com/docs/googleidentity/authenticate-with-a-backend-server"><link data-react-helmet="true" rel="alternate" href="https://docs.airnativeextensions.com/docs/googleidentity/authenticate-with-a-backend-server" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.airnativeextensions.com/docs/googleidentity/authenticate-with-a-backend-server" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.95805f25.css">
<link rel="preload" href="/assets/js/runtime~main.d7efeab2.js" as="script">
<link rel="preload" href="/assets/js/main.8c2d118f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/ane-icon-black.png" alt="AIR Native Extensions" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/ane-icon-white.png" alt="AIR Native Extensions" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">AIR Native Extensions</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/news/">News</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT"> </span></div><div class="react-toggle-track-x"><span class="toggle_71bT"> </span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/ane-icon-black.png" alt="AIR Native Extensions" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/ane-icon-white.png" alt="AIR Native Extensions" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">AIR Native Extensions</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/news/">News</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Home</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/googleidentity/">GoogleIdentity</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Setup your Google Project</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/google-developers-console-project">Google Developers Console project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/android-certificate">Android Certificate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/google-identity-options">Google Identity Options</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Setup the Extension</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/add-the-extension">Add the Extension</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Usage</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/setup">Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/signing-in">Signing In</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/disconnect">Disconnect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/user-information">User Information</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Additional</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/googleidentity/authenticate-with-a-backend-server">Authenticate with a backend server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/googleidentity/enabling-server-side-access">Enabling Server-Side Access</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/migrating-to-androidx">Migrating to AndroidX</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/migrating-from-version-1">Migrating from version 1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Other</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/googleidentity/changelog">changelog</a></li><li class="menu__list-item"><a href="https://docs.airnativeextensions.com/asdocs/googleidentity/" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">asdocs</a></li><li class="menu__list-item"><a href="http://github.com/distriqt/ANE-GoogleIdentity/issues/new" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Contact Support</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Authenticate with a backend server</h1></header><div class="markdown"><p>If you use Google Sign-In with an app or site that communicates with a backend server, you might need to identify the currently signed-in user on the server. To do so securely, after a user successfully signs in, send the user&#x27;s ID token to your server using HTTPS. Then, on the server, verify the integrity of the ID token and use the user information contained in the token to establish a session or create a new account.</p><blockquote><p>Warning: Do not accept plain user IDs, such as those you can get with the GoogleSignInAccount.getId() method, on your backend server. A modified client application can send arbitrary user IDs to your server to impersonate users, so you must instead use verifiable ID tokens to securely get the user IDs of signed-in users on the server side.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setup"></a>Setup<a class="hash-link" href="#setup" title="Direct link to heading">#</a></h2><p>If you plan on identifying your user with your server you will need to request the id token and provide the server client ids when you setup the extension.</p><p>The server client ids are created through the <a href="https://console.developers.google.com/apis/credentials" target="_blank" rel="noopener noreferrer">Google API Console</a> by creating an OAuth 2.0 web application client ID for your backend server. If you have different servers for iOS and Android applications use the <code>setiOSServerClientID</code> and <code>setAndroidServerClientID</code> otherwise if you just have the one you can use <code>setServerClientID</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">var options:GoogleIdentityOptions = new GoogleIdentityOptionsBuilder()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    .requestEmail()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    .requestIdToken()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    .setIOSClientID( IOS_CLIENT_ID )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    .setiOSServerClientID( IOS_SERVER_CLIENT_ID )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    .setAndroidServerClientID( ANDROID_SERVER_CLIENT_ID )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    .build();</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">GoogleIdentity.service.setup( options );</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>If you didn&#x27;t configure <code>GoogleIdentityOptionsBuilder</code> with <code>requestIdToken()</code>, your user&#x27;s id token will return null or an empty string.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sign-in"></a>Sign In<a class="hash-link" href="#sign-in" title="Direct link to heading">#</a></h2><p>Follow the normal process to <a href="/docs/googleidentity/signing-in">sign in</a> and in your sign in success handler ensure you grab the user and the id token:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function signInHandler( event:GoogleIdentityEvent ):void</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    trace( event.user.userID );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    trace( event.user.authentication.idToken );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You can then use a normal <code>URLRequest</code> to send this token to your server to identify your user:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly actionscript"><div tabindex="0" class="prism-code language-actionscript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">var vars:URLVariables = new URLVariables();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">vars.idToken = user.authentication.idToken;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">var request:URLRequest = new URLRequest( YOUR_SERVER_URL );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">request.data = vars;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">request.method = URLRequestMethod.POST;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">var loader:URLLoader = new URLLoader();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">loader.addEventListener( Event.COMPLETE, loaderCompleteHandler );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">loader.load( request );</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>(This is just intended as a quick example and is missing error handling)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="verify"></a>Verify<a class="hash-link" href="#verify" title="Direct link to heading">#</a></h2><p>After you receive the ID token by HTTPS POST, you must verify the integrity of the token. To verify that the token is valid, ensure that the following criteria are satisfied:</p><ul><li>The ID token is properly signed by Google. Use Google&#x27;s public keys (available in <a href="https://www.googleapis.com/oauth2/v3/certs" target="_blank" rel="noopener noreferrer">JWK</a> or <a href="https://www.googleapis.com/oauth2/v1/certs" target="_blank" rel="noopener noreferrer">PEM</a> format) to verify the token&#x27;s signature. These keys are regularly rotated; examine the <code>Cache-Control</code> header in the response to determine when you should retrieve them again.</li><li>The value of <code>aud</code> in the ID token is equal to one of your app&#x27;s client IDs. This check is necessary to prevent ID tokens issued to a malicious app being used to access data about the same user on your app&#x27;s backend server.</li><li>The value of <code>iss</code> in the ID token is equal to <code>accounts.google.com</code> or <code>https://accounts.google.com</code>.</li><li>The expiry time (<code>exp</code>) of the ID token has not passed.</li><li>If you want to restrict access to only members of your G Suite domain, verify that the ID token has an <code>hd</code> claim that matches your G Suite domain name.</li></ul><p>Rather than writing your own code to perform these verification steps, we strongly recommend using a Google API client library for your platform, or calling our <code>tokeninfo</code> validation endpoint.</p><p>Further information:</p><ul><li><a href="https://developers.google.com/identity/sign-in/android/backend-auth#using-a-google-api-client-library" target="_blank" rel="noopener noreferrer">Using a Google API Client Library</a></li><li><a href="https://developers.google.com/api-client-library/" target="_blank" rel="noopener noreferrer">Google API Client Libraries</a></li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/googleidentity/user-information"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« User Information</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/googleidentity/enabling-server-side-access"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Enabling Server-Side Access »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#setup" class="table-of-contents__link">Setup</a></li><li><a href="#sign-in" class="table-of-contents__link">Sign In</a></li><li><a href="#verify" class="table-of-contents__link">Verify</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials/">tutorials</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/distriqt" target="_blank" rel="noopener noreferrer" class="footer__link-item">twitter</a></li><li class="footer__item"><a href="https://github.com/Gamua/Adobe-Runtime-Support/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">AIR discussions</a></li><li class="footer__item"><a href="https://forum.starling-framework.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">starling</a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/distriqt" target="_blank" rel="noopener noreferrer" class="footer__link-item">stack overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/news">news</a></li><li class="footer__item"><a href="https://airnativeextensions.com/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">privacy</a></li><li class="footer__item"><a href="https://airnativeextensions.com/license" target="_blank" rel="noopener noreferrer" class="footer__link-item">license</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><br><a href="https://airnativeextensions.com">airnativeextensions.com</a> copyright © 2021 <br><br><a href="https://distriqt.com"><img src="/img/logo.png" alt="distriqt"></a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.d7efeab2.js"></script>
<script src="/assets/js/main.8c2d118f.js"></script>
</body>
</html>