"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[23932],{28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>r});var t=i(96540);const s={},o=t.createContext(s);function c(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(o.Provider,{value:n},e.children)}},36096:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"pushnotifications/setup-your-service","title":"Setup your Service","description":"Core Initialisation","source":"@site/docs/pushnotifications/setup-your-service.md","sourceDirName":"pushnotifications","slug":"/pushnotifications/setup-your-service","permalink":"/docs/pushnotifications/setup-your-service","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Setup your Service","sidebar_label":"Setup your Service"},"sidebar":"pushnotifications","previous":{"title":"Pushy","permalink":"/docs/pushnotifications/pushy/"},"next":{"title":"Azure","permalink":"/docs/pushnotifications/azure/setup-your-service"}}');var s=i(74848),o=i(28453);const c={title:"Setup your Service",sidebar_label:"Setup your Service"},r=void 0,a={},l=[{value:"Core Initialisation",id:"core-initialisation",level:2},{value:"Service",id:"service",level:2},{value:"Service Type",id:"service-type",level:3},{value:"Checking Service Support",id:"checking-service-support",level:3},{value:"Service ID",id:"service-id",level:3},{value:"Service Key",id:"service-key",level:3},{value:"Categories and Actions",id:"categories-and-actions",level:3},{value:"Notifications When Active",id:"notifications-when-active",level:3},{value:"Sandbox Mode",id:"sandbox-mode",level:3},{value:"Channels",id:"channels",level:3},{value:"Creating Channels",id:"creating-channels",level:4},{value:"Channel Sounds",id:"channel-sounds",level:4},{value:"Example",id:"example",level:3}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"core-initialisation",children:"Core Initialisation"}),"\n",(0,s.jsx)(n.p,{children:"It is important that before attempting to use any of this extensions functionality that your initialise the Core extension by calling at some point early in your application, generally at the same time as the initialisation of this extension. If you are using other extensions that also require the Core extension, you only need to initialise it once, before initialising the other extensions."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:"Core.init();\n"})}),"\n",(0,s.jsx)(n.p,{children:"The Core extension doesn't provide any functionality in itself but provides support libraries and frameworks used by our extensions. This initialisation ensures that the functionality to support application level communication is enabled eg from launch notifications and events."}),"\n",(0,s.jsx)(n.h2,{id:"service",children:"Service"}),"\n",(0,s.jsxs)(n.p,{children:["When you are setting up your ",(0,s.jsx)(n.code,{children:"Service"})," there are a few additional options you can set to use some of the advanced features of the services."]}),"\n",(0,s.jsx)(n.h3,{id:"service-type",children:"Service Type"}),"\n",(0,s.jsx)(n.p,{children:"The most important option is the service type you plan to use in your application."}),"\n",(0,s.jsxs)(n.p,{children:["You must set this early by creating an instance of the ",(0,s.jsx)(n.code,{children:"Service"})," class and passing it\nto the ",(0,s.jsx)(n.code,{children:"setup"})," function. It cannot be changed."]}),"\n",(0,s.jsxs)(n.p,{children:["The available services are listed in the ",(0,s.jsx)(n.code,{children:"Service"})," class, include:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"APNS"})," : Apple's Push Notification Service","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"iOS only"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"FCM"})," : Firebase Cloud Messaging","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Android and iOS"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"GCM"})," : Google Cloud Messaging","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"No longer supported"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ONESIGNAL"})," : One Signal","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Android and iOS"}),"\n",(0,s.jsx)(n.li,{children:"(Windows manually through WNS)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"WNS"})," : Windows Notification Service","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Windows"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"AZURE"})," : Microsoft Notification Hubs","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Android and iOS"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"DEFAULT"})," : The service type will depend on the platform","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["iOS: ",(0,s.jsx)(n.code,{children:"APNS"})]}),"\n",(0,s.jsxs)(n.li,{children:["Android: ",(0,s.jsx)(n.code,{children:"GCM"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:"var service:Service = new Service( Service.DEFAULT );\n\n// Call setup to configure\nPushNotifications.service.setup( service );\n"})}),"\n",(0,s.jsx)(n.p,{children:"If you wish to use APNS on iOS and FCM on Android you can use something like the following:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:'var service:Service;\nif (PushNotifications.service.implementation == "iOS")\n{\n\tservice = new Service( Service.APNS );\n}\nelse \n{\n\tservice = new Service( Service.FCM );\n}\nPushNotifications.service.setup( service );\n'})}),"\n",(0,s.jsx)(n.h3,{id:"checking-service-support",children:"Checking Service Support"}),"\n",(0,s.jsxs)(n.p,{children:["You can check whether the current application/device supports a particular service by using the ",(0,s.jsx)(n.code,{children:"isServiceSupported"})," function."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:"if (PushNotifications.service.isServiceSupported( Service.FCM ))\n{\n\t// FCM is supported on the current device\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"The return value of this function will be different not only between devices and platforms but also between the variants of the extension. For example, the Azure variant will return false for support for FCM, whereas the FCM variant will return true."}),"\n",(0,s.jsx)(n.p,{children:"You can use this to prioritise services as your application requires."}),"\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:"if (PushNotifications.isSupported)\n{\n\tvar service:Service;\n\tif (PushNotifications.service.isServiceSupported( Service.FCM ))\n\t{\n\t\tservice = new Service( Service.FCM );\n\t}\n\telse if (PushNotifications.service.isServiceSupported( Service.APNS ))\n\t{\n\t\tservice = new Service( Service.APNS );\n\t}\n\telse \n\t{\n\t\t// Handle the case where no service supported. \n\t\t// Eg: turn off notifications in this application\n\t}\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"service-id",children:"Service ID"}),"\n",(0,s.jsx)(n.p,{children:"Some services require an identifier to be included as part of the configuration."}),"\n",(0,s.jsx)(n.p,{children:"This is only required for some services such as GCM and Azure."}),"\n",(0,s.jsx)(n.p,{children:"For example, with GCM you should set your GCM sender id here:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:"service.serviceId = GCM_SENDER_ID;\n"})}),"\n",(0,s.jsx)(n.p,{children:"This can be left as the default on other platforms and will be ignored."}),"\n",(0,s.jsx)(n.h3,{id:"service-key",children:"Service Key"}),"\n",(0,s.jsxs)(n.p,{children:["In addition to the ",(0,s.jsx)(n.code,{children:"serviceId"})," some services require an auth key or connection string\nwhich should be specified here."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:'service.serviceKey = "";\n'})}),"\n",(0,s.jsx)(n.p,{children:"This can be left as the default on most platforms and will be ignored."}),"\n",(0,s.jsx)(n.h3,{id:"categories-and-actions",children:"Categories and Actions"}),"\n",(0,s.jsx)(n.p,{children:"The main feature you will probably want to configure here are your notification categories and actions.\nThese represent the quick actions that a user can take on a notification."}),"\n",(0,s.jsx)(n.p,{children:"In the notification payload a notification can be given a category.\nThe system will then apply that category to the notification.\nA category contains a series of actions which will be displayed when the notification is interacted with.\nEach category and action must be given a unique identifier so you can process them accordingly in your code.\nAdditionally each action must be given a title."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:'var service:Service = new Service( Service.DEFAULT, Config.gcmSenderId );\nservice.enableNotificationsWhenActive = true;\n\nservice.categories.push( \n\tnew CategoryBuilder()\n\t\t.setIdentifier( "INVITE_CATEGORY" )\n\t\t.addAction( \n\t\t\tnew ActionBuilder()\n\t\t\t\t.setTitle( "Accept" )\n\t\t\t\t.setIdentifier( "ACCEPT_IDENTIFIER" )\n\t\t\t\t.build()\n\t\t)\n\t\t.addAction( \n\t\t\tnew ActionBuilder()\n\t\t\t\t.setTitle( "Delete" )\n\t\t\t\t.setDestructive( true )\n\t\t\t\t.setIdentifier( "DELETE_IDENTIFIER" )\n\t\t\t\t.build()\n\t\t)\n\t\t.build()\n);\n\nPushNotifications.service.setup( service );\n'})}),"\n",(0,s.jsx)(n.h3,{id:"notifications-when-active",children:"Notifications When Active"}),"\n",(0,s.jsx)(n.p,{children:"On Android, Windows and on iOS v10+ you can enable notifications while your application is active.\nThis will show a notification to the user, even if they are currently using the application."}),"\n",(0,s.jsxs)(n.p,{children:["The default is ",(0,s.jsx)(n.code,{children:"false"}),", i.e. not show a notification and your application would only receive\nthe notification event."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:"service.setNotificationsWhenActive( true );\n"})}),"\n",(0,s.jsx)(n.h3,{id:"sandbox-mode",children:"Sandbox Mode"}),"\n",(0,s.jsx)(n.p,{children:"Lastly in order to correctly test some of the services you should specify whether you\nare using the sandbox (testing) mode. This is not required by all platforms however some,\nincluding Firebase on iOS require this setting to be able to correctly test your application."}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"sandboxMode"})," to ",(0,s.jsx)(n.code,{children:"true"})," for development environments and the default ",(0,s.jsx)(n.code,{children:"false"})," for production."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:"service.sandboxMode = true;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"channels",children:"Channels"}),"\n",(0,s.jsxs)(n.p,{children:["New to Android ",(0,s.jsx)(n.code,{children:"8.0"})," (API level 26) is the concept of a notification channel."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Notification channels provide a unified system to help users manage notifications. When you target Android 8.0 (API level 26), you must implement one or more notification channels to display notifications to your users. If you don't target Android 8.0 (API level 26) but your app is used on devices running Android 8.0 (API level 26), your app behaves the same as it would on devices running Android 7.1 (API level 25) or lower."}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Note: The user interface refers to notification channels as notification categories."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["You can create an instance of a ",(0,s.jsx)(n.code,{children:"Channel"})," for each distinct type of notification you need to send. You can also create notification channels to reflect choices made by users of your app. For example, you may set up separate notification channels for each conversation group created by a user in a messaging app."]}),"\n",(0,s.jsx)(n.p,{children:"Users can manage most of the settings associated with notifications using a consistent system UI. All notifications posted to the same notification channel have the same behavior. When a user modifies the behavior for any of the following characteristics, it applies to the notification channel:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Importance"}),"\n",(0,s.jsx)(n.li,{children:"Sound"}),"\n",(0,s.jsx)(n.li,{children:"Lights"}),"\n",(0,s.jsx)(n.li,{children:"Vibration"}),"\n",(0,s.jsx)(n.li,{children:"Show on lockscreen"}),"\n",(0,s.jsx)(n.li,{children:"Override do not disturb"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(96566).A+"",width:"400",height:"711"})}),"\n",(0,s.jsx)(n.p,{children:"Users can visit Settings, or long-press a notification to change these behaviors, or even block a notification channel at any time. You can't programmatically modify the behavior of a notification channel after it's created and submitted to the notification manager; the user is in charge of those settings after creation. You can however rename a notification channel or update its description after creation."}),"\n",(0,s.jsx)(n.h4,{id:"creating-channels",children:"Creating Channels"}),"\n",(0,s.jsxs)(n.p,{children:["To create channels you add them to your ",(0,s.jsx)(n.code,{children:"Service"})," definition. A ",(0,s.jsx)(n.code,{children:"Service.channels"})," is an array of ",(0,s.jsx)(n.code,{children:"Channel"})," objects that you should create when passing your service to the ",(0,s.jsx)(n.code,{children:"setup"})," function."]}),"\n",(0,s.jsxs)(n.p,{children:["You should use the ",(0,s.jsx)(n.code,{children:"ChannelBuilder"})," to create a ",(0,s.jsx)(n.code,{children:"Channel"})," object."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:'var service:Service = new Service();\n\n// Setup other service related properties\n\nservice.channels.push(\n    new ChannelBuilder()\n        .setId( "test_channel" )\n        .setName( "Test Channel" )\n        .build()\n);\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"You must add at least one channel."})}),"\n",(0,s.jsx)(n.h4,{id:"channel-sounds",children:"Channel Sounds"}),"\n",(0,s.jsx)(n.p,{children:"Notification sounds on Android O (API v26) and higher now must be set on the Channel. Individual notification sounds will be ignored."}),"\n",(0,s.jsxs)(n.p,{children:["To set a sound on a channel, use the ",(0,s.jsx)(n.code,{children:"setSound( path )"})," function and pass the local path to an mp3 file."]}),"\n",(0,s.jsx)(n.p,{children:"eg:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:'new ChannelBuilder()\n\t.setId( "test_channel" )\n\t.setName( "Test Channel" )\n\t.setSound( "assets/notifications/sounds/notification.mp3" )\n\t.build()\n'})}),"\n",(0,s.jsx)(n.p,{children:"This path should be relative to your application root."}),"\n",(0,s.jsx)(n.p,{children:"This path can also be a resource name if you are packaging raw mp3 resources with your application in a custom resources extension."}),"\n",(0,s.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,s.jsxs)(n.p,{children:["The following example sets up the ",(0,s.jsx)(n.code,{children:"DEFAULT"})," service with a category containing two actions."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-actionscript",children:'var service:Service = new Service( Service.DEFAULT, Config.gcmSenderId );\nservice.sandboxMode = false;\nservice.enableNotificationsWhenActive = true;\n\nservice.categories.push( \n\tnew CategoryBuilder()\n\t\t.setIdentifier( "INVITE_CATEGORY" )\n\t\t.addAction( \n\t\t\tnew ActionBuilder()\n\t\t\t\t.setTitle( "Accept" )\n\t\t\t\t.setIdentifier( "ACCEPT_IDENTIFIER" )\n\t\t\t\t.build()\n\t\t)\n\t\t.addAction( \n\t\t\tnew ActionBuilder()\n\t\t\t\t.setTitle( "Delete" )\n\t\t\t\t.setDestructive( true )\n\t\t\t\t.setIdentifier( "DELETE_IDENTIFIER" )\n\t\t\t\t.build()\n\t\t)\n\t\t.build()\n);\n\nservice.channels.push(\n    new ChannelBuilder()\n        .setId( "test_channel" )\n        .setName( "Test Channel" )\n        .build()\n);\n\nPushNotifications.service.setup( service );\n'})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},96566:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/android-channels-settings-37c9e04e9eea1b7866b3da4a6362cf6a.png"}}]);