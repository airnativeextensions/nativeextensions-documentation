<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="air native extensions Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="air native extensions Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-188619114-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="air native extensions" href="/opensearch.xml"><title data-react-helmet="true">Turn Based Multiplayer - Implementation | air native extensions</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://docs.airnativeextensions.com/img/ane-icon-black.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.airnativeextensions.com/img/ane-icon-black.png"><meta data-react-helmet="true" property="og:url" content="https://docs.airnativeextensions.com/docs/gameservices/turn-based-multiplayer---implementation"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Turn Based Multiplayer - Implementation | air native extensions"><meta data-react-helmet="true" name="description" content="Sections:"><meta data-react-helmet="true" property="og:description" content="Sections:"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.airnativeextensions.com/docs/gameservices/turn-based-multiplayer---implementation"><link data-react-helmet="true" rel="alternate" href="https://docs.airnativeextensions.com/docs/gameservices/turn-based-multiplayer---implementation" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.airnativeextensions.com/docs/gameservices/turn-based-multiplayer---implementation" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.f49ec264.css">
<link rel="preload" href="/assets/js/runtime~main.1ac41cb2.js" as="script">
<link rel="preload" href="/assets/js/main.843e3a71.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1boX">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/ane-icon-black.png" alt="AIR Native Extensions" class="themedImage_3oOy themedImage--light_3ouy navbar__logo"><img src="/img/ane-icon-white.png" alt="AIR Native Extensions" class="themedImage_3oOy themedImage--dark_3zJb navbar__logo"><b class="navbar__title">AIR Native Extensions</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/news/">News</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2ySP react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_2iFN"> </span></div><div class="react-toggle-track-x"><span class="toggle_2iFN"> </span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_xXbB"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_3zOJ"><button class="clean-btn backToTopButton_DkI0" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_G8MK"><div class="sidebar_1tWv"><nav class="menu thin-scrollbar menu_1Iah menuWithAnnouncementBar_3acx"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Home</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/gameservices">GameServices</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Setup Services</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Integration</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Usage</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gameservices/sign-in">Sign In</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gameservices/leaderboards">Leaderboards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gameservices/achievements">Achievements</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Saved Games</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Turn Based Multiplayer</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gameservices/turn-based-multiplayer---key-concepts">Key Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gameservices/turn-based-multiplayer---implementation-overview">Implementation Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/gameservices/turn-based-multiplayer---implementation">Implementation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gameservices/turn-based-multiplayer---invitations">Invitations</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gameservices/quests-and-events">Quests and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gameservices/screen-recording">Screen Recording</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">User Interface</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Help</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Other</a></li></ul></nav></div></aside><main class="docMainContainer_3Zec"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_2q91"><div class="docItemContainer_37q2"><article><div class="tocCollapsible_3moT tocMobile_2bxg"><button type="button" class="clean-btn tocCollapsibleButton_3OYu">On this page</button></div><div class="markdown"><header><h1>Turn Based Multiplayer - Implementation</h1></header><p>Sections:</p><ul><li><a href="#creating-a-match">Creating a Match</a></li><li><a href="#loading-matches">Loading Matches</a></li><li><a href="#match-data">Match Data</a></li><li><a href="#taking-turns">Taking Turns</a></li><li><a href="#match-updates">Match Updates</a></li><li><a href="#leaving-a-match">Leaving a Match</a></li><li><a href="#completing-a-match">Completing a Match</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_1iPN" id="creating-a-match"></a>Creating a match<a class="hash-link" href="#creating-a-match" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_1iPN" id="player-selection"></a>Player Selection<a class="hash-link" href="#player-selection" title="Direct link to heading">#</a></h3><p>The process of creating a match works slightly differently on the platforms however the
best cross-platform way to create a match is to first call <code>displayCreateMatchUI</code>. </p><p>This will display some form of UI that will ask the user to select players to invite,
and then end in a create match event.</p><p>This call allows a few options for you to guide how many players, minimum, maximum and
whether auto matching is allowed, through the <code>PlayerSelectionOptions</code> class.</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">var options:PlayerSelectionOptions = new PlayerSelectionOptions();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">options.minPlayers = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">options.maxPlayers = 3;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">options.allowAutomatch = false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.displayCreateMatchUI( options );</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>This will then dispatch one of the following events:</p><ul><li><code>TurnBasedMultiplayerEvent.CREATEMATCH_UI_SUCCESS</code>: Dispatched when the player selects oponents for the match</li><li><code>TurnBasedMultiplayerEvent.CREATEMATCH_UI_ERROR</code>: Dispatched if there was an error during the create match UI</li><li><code>TurnBasedMultiplayerEvent.CREATEMATCH_UI_CANCEL</code>: Dispatched when the player cancels the create match UI</li><li><code>TurnBasedMatchEvent.CREATE_SUCCESS</code>: Dispatched when the match is created</li></ul><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.addEventListener( TurnBasedMultiplayerEvent.CREATEMATCH_UI_SUCCESS, createMatchUISuccessHandler );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.addEventListener( TurnBasedMultiplayerEvent.CREATEMATCH_UI_CANCEL, createMatchUICancelHandler );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.addEventListener( TurnBasedMultiplayerEvent.CREATEMATCH_UI_ERROR, createMatchUIErrorHandler );</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.addEventListener( TurnBasedMatchEvent.CREATE_SUCCESS, matchCreateHandler );</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_1iPN" id="create-match"></a>Create Match<a class="hash-link" href="#create-match" title="Direct link to heading">#</a></h3><p>You can handle the cancel and errors as your application requires. The success event will contain
information about the selected players and allow you to create a match:</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">function createMatchUISuccessHandler( event:TurnBasedMultiplayerEvent ):void</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //  This event is fired when the create match ui is completed and we need</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //  to manually call create match.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //  This is not needed on GameCenter as you will immediately get a CREATE_SUCCESS  </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //  event.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    var config:TurnBasedMatchConfig = event.data;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    message( &quot; --- INVITED PLAYERS&quot; );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    for each (var id:String in config.invitedPlayers)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        message( &quot; P: &quot; + id );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    message( &quot; --- &quot; );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    GameServices.service.turnBasedMultiplayer.createMatch( config );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>Then when the match is created you will receive the <code>TurnBasedMatchEvent.CREATE_SUCCESS</code> event
which will contain the <code>TurnBasedMatch</code> reference for the match: </p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">function matchCreateHandler( event:TurnBasedMatchEvent ):void </span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //  You should store the match for usage in your game</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //  This forms the main interface for turn based matches.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    var match:TurnBasedMatch = event.match;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>At this point it is good practice to initialise the <code>match</code> with some initial game data.
The <code>match</code> object contains a <code>data</code> ByteArray that you use to store information about
the game state. </p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">// Use match.data to write some initial data state</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_1iPN" id="taking-the-first-turn"></a>Taking the first turn<a class="hash-link" href="#taking-the-first-turn" title="Direct link to heading">#</a></h3><p>Once you have created the match you can now have your player take their first turn
executing your game play as you see fit. The result of the players actions should
be then written to the match data and then you should call <code>takeTurn</code> specifying
the next participant. See Taking Turns for more information on using <code>takeTurn</code>.</p><p><strong>It is very important that your player takes the first turn.</strong> </p><p>Until the player takes the first turn the match will not be in a state that will
trigger notifications to other players and they won&#x27;t receive invitations to the game or match.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_1iPN" id="loading-matches"></a>Loading Matches<a class="hash-link" href="#loading-matches" title="Direct link to heading">#</a></h2><p>To load matches currently in progress for the current player you can call the <code>loadMatches</code>
function.</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.loadMatches();</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>You can also specify loading matches that are in a particular turn status for the player
by passing an array of statuses to the loadMatches call. For example, to load all matches
that it is currently the players turn:</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.loadMatches( [ TurnBasedMatchStatus.MATCH_TURN_STATUS_MY_TURN ] );</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>The call will dispatch an event when complete, being either:</p><ul><li><code>TurnBasedMultiplayerEvent.LOADMATCHES_SUCCESS</code>: When successful. The event will contain the loaded matches</li><li><code>TurnBasedMultiplayerEvent.LOADMATCHES_FAILED</code>: If an error occurred.</li></ul><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.addEventListener( TurnBasedMultiplayerEvent.LOADMATCHES_SUCCESS, loadMatchesSuccessHandler );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.addEventListener( TurnBasedMultiplayerEvent.LOADMATCHES_FAILED, loadMatchesFailedHandler );</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>On success the matches are available through the event payload. You can immediately start
using these match objects, listening for updates or taking turns as required.</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">function loadMatchesSuccessHandler( event:TurnBasedMultiplayerEvent ):void </span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    for each (var match:TurnBasedMatch in event.data)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        message( &quot;MATCH :: [&quot;+match.matchId+&quot;] &quot;+match.status );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Display matches to user or process as required by your application</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_1iPN" id="match-data"></a>Match Data<a class="hash-link" href="#match-data" title="Direct link to heading">#</a></h2><p>The match data is a <code>ByteArray</code> object that you can use as requried to store data,
however it is size limited so you should take efforts to minimise the size of the
data required by your game. </p><p>Some general strategies of encoding the data include:</p><ul><li><p><strong>Encode only player actions</strong>: In this design, your match data simply consists of the moves made by the players. For example, in chess, you know that white goes first, moves always alternate, and a piece moves from one board position to another. This makes it easy for you to encode each move as the starting and ending position of the piece moved. The rest of the data (who made the moves) can be completely inferred. When your game loads the match data, it quickly replays the moves to generate the current board position.
This strategy works best for games with a small number of possible kinds of actions and a small number of moves per match. Also, with this model, it is very possible for your game to replay the moves in its user interface, allowing players to see exactly what moves other opponents made to get the board into the new state. Showing a player these moves makes it very easy for a player to understand how the game got to the current state.</p></li><li><p><strong>Encode only the current state of the match</strong>: For very complex games, the actual state required to encode the game could be very large. In this case, you may need to encode the current state of the match without worrying about the actions that generated that match data. This is particularly true for very complex games where the list of moves might grow too large to fit in the available storage space. This strategy is recommended as a last resort. Players lose all context of what happened on previous turns of the match. For games with long timeouts between turns, players may grow bored or frustrated if they cannot remember the state of a match they were playing. This is particularly true when players participate in multiple matches simultaneously.</p></li><li><p><strong>Encode the current state of the match and a set of recent player actions</strong>: This is a hybrid strategy that borrows elements from the other two strategies. Essentially, the match data stored on Game Center consists of a recent snapshot of the match plus other data that encodes recent actions since that last snapshot was taken. When the data that records the actions grows too large, your game replays some of those moves to update the match snapshot and then deletes those moves from its list of actions.</p></li></ul><p>The size of the match data is limited to:</p><ul><li>64kb on Game Center</li><li>128kb on Google Play Games </li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_1iPN" id="taking-turns"></a>Taking Turns<a class="hash-link" href="#taking-turns" title="Direct link to heading">#</a></h2><p>To take a turn you will be updating the data in the <code>match</code> object and then calling
<code>takeTurn</code> specifying the next participant.</p><p>The next participant can be any of the participants in the match which are available
through the <code>match.participants</code> array of <code>Participant</code> objects or you can specify
null if you wish for an auto matched player to take the next turn.</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">// Update the match data</span></span><span class="token-line" style="color:#393A34"><span class="token plain">match.data.writeInt(  ... );</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">// Determine your next player based on your game rules</span></span><span class="token-line" style="color:#393A34"><span class="token plain">var next:Participant = ...;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">// Call takeTurn to end the turn and move play to next participant</span></span><span class="token-line" style="color:#393A34"><span class="token plain">match.takeTurn( next );</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>The local player will also be indexed in the match participants so it is sometimes
useful to find the index of the local player in the participants.</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">var localPlayer:Player = GameServices.service.getPlayer();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">for (var j:int = 0; j &lt; match.participants.length; ++j)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (Participant(match.participants[j]).player.id == localPlayer.id)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        localPlayerIndex = j;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>So for example your game might just iterate through the participants in turn
order:</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">//  Take the next player in the participants </span></span><span class="token-line" style="color:#393A34"><span class="token plain">var nextIndex:int = (localPlayerIndex + 1 &gt;= match.participants.length) ? 0 : localPlayerIndex + 1 ;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">// If this is an auto-match game, then there may only be one player, in which case</span></span><span class="token-line" style="color:#393A34"><span class="token plain">//  you will want to pass a mull value for the next participant allowing an auto match</span></span><span class="token-line" style="color:#393A34"><span class="token plain">//  player to take their turn.</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">var next:Participant = null;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if (nextIndex != localPlayerIndex)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    next = _match.participants[ nextIndex ];</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>The call to <code>takeTurn</code> will dispatch an event on completion:</p><ul><li><code>TurnBasedMatchEvent.TAKETURN_SUCCESS</code>: If the call is successful</li><li><code>TurnBasedMatchEvent.TAKETURN_FAILED</code>: If there was an error taking the turn, you should try the call again later.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_1iPN" id="match-updates"></a>Match Updates<a class="hash-link" href="#match-updates" title="Direct link to heading">#</a></h2><p>When another participant changes the state of the match your application will
receive the <code>MATCH_UPDATED</code> event. </p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">GameServices.service.turnBasedMultiplayer.addEventListener( TurnBasedMatchEvent.MATCH_UPDATED, matchUpdatedHandler );</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>When you receive this event you should update your application with the match in the event
The updated <code>match</code> will contain the latest match status and data.</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">function matchUpdatedHandler( event:TurnBasedMatchEvent ):void </span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    updateMatch( event.match );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>For example:</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">function updateMatch( match:TurnBasedMatch ):void</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Clear out the old match reference if you are holding onto one</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (_match)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _match.removeEventListener( TurnBasedMatchEvent.TAKETURN_SUCCESS, match_takeTurnSuccessHandler );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ... </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Update with the new reference</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    _match = match;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (_match)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _match.addEventListener( TurnBasedMatchEvent.TAKETURN_SUCCESS, match_takeTurnSuccessHandler );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // You should now process the match state checking if the status has changed </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // and the turn status to see which player is now active</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        processMatchState();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>If you have multiple matches you should also use the <code>matchId</code> to distinguish between
the different matches in progress. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_1iPN" id="leaving-a-match"></a>Leaving a Match<a class="hash-link" href="#leaving-a-match" title="Direct link to heading">#</a></h2><p>If a player wishes to leave a match you should call <code>leaveMatchDuringTurn</code> if it is the
players turn or <code>leaveMatch</code> if not. If it is the players turn it is important that
you call <code>leaveMatchDuringTurn</code> and specify the player that will take the next turn
based on your game logic, so that the match may continue for the other players.</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">if (match.turnStatus == TurnBasedMatchStatus.MATCH_TURN_STATUS_MY_TURN)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Determine the next participant based on your game logic</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    var next:Participant = ...;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    match.leaveMatchDuringTurn( next );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    match.leaveMatch();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>Calling these functions will result in one of the following events:</p><ul><li><code>TurnBasedMatchEvent.LEAVE_SUCCESS</code>: Dispatched if the leave call was successful and the player is no longer an active participant.</li><li><code>TurnBasedMatchEvent.LEAVE_FAILED</code>: Dispatched if the leave call failed. Check the error for details.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_1iPN" id="completing-a-match"></a>Completing a Match<a class="hash-link" href="#completing-a-match" title="Direct link to heading">#</a></h2><p>Completing or finishing a match involves calling <code>finishMatch</code> and specifying the result.
This should be called by the player taking the last turn in the match and call this method
instead of <code>takeTurn</code>. </p><p>The result of the match is specified by an Array of <code>ParticipantResult</code> objects for each
of the participants in the match that require a result. If there is simply a winner, then
you can use a single <code>ParticipantResult</code> in this Array.</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">var winner:ParticipantResult = new ParticipantResult();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">winner.result       = ParticipantResult.MATCH_RESULT_WIN;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">winner.participant  = ...; // Participant from match.participants array that has won</span></span><span class="token-line" style="color:#393A34"><span class="token plain">winner.placing      = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">match.finishMatch( [ winner ] );</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>The call to <code>finishMatch</code> will dispatch one of the following events:</p><ul><li><code>TurnBasedMatchEvent.FINISH_SUCCESS</code>: Dispatched when <code>finishMatch</code> is successful </li><li><code>TurnBasedMatchEvent.FINISH_FAILED</code>: Dispatched when <code>finishMatch</code> has failed, you should attempt the call again later </li></ul><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB actionscript"><pre tabindex="0" class="prism-code language-actionscript codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">match.addEventListener( TurnBasedMatchEvent.FINISH_SUCCESS, finishSuccessHandler );</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">function finishSuccessHandler( event:TurnBasedMatchEvent ):void </span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Match will now be complete</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/gameservices/turn-based-multiplayer---implementation-overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Implementation Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/gameservices/turn-based-multiplayer---invitations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Invitations »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_2pwG thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-a-match" class="table-of-contents__link">Creating a match</a><ul><li><a href="#player-selection" class="table-of-contents__link">Player Selection</a></li><li><a href="#create-match" class="table-of-contents__link">Create Match</a></li><li><a href="#taking-the-first-turn" class="table-of-contents__link">Taking the first turn</a></li></ul></li><li><a href="#loading-matches" class="table-of-contents__link">Loading Matches</a></li><li><a href="#match-data" class="table-of-contents__link">Match Data</a></li><li><a href="#taking-turns" class="table-of-contents__link">Taking Turns</a></li><li><a href="#match-updates" class="table-of-contents__link">Match Updates</a></li><li><a href="#leaving-a-match" class="table-of-contents__link">Leaving a Match</a></li><li><a href="#completing-a-match" class="table-of-contents__link">Completing a Match</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials/">tutorials</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/distriqt" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/Gamua/Adobe-Runtime-Support/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>AIR discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://forum.starling-framework.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>starling<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/distriqt" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>stack overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/news">news</a></li><li class="footer__item"><a href="https://airnativeextensions.com/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://airnativeextensions.com/license" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>license<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><br><a href="https://airnativeextensions.com">airnativeextensions.com</a> copyright © 2021 <br><br><a href="https://distriqt.com"><img src="/img/logo.png" alt="distriqt"></a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.1ac41cb2.js"></script>
<script src="/assets/js/main.843e3a71.js"></script>
</body>
</html>