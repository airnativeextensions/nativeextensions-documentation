(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{238:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return d}));var a=n(2),r=n(6),o=(n(0),n(722)),i={title:"Saved Games - Conflicts",sidebar_label:"Saved Games - Conflicts"},c={unversionedId:"gameservices/saved-games---conflicts",id:"gameservices/saved-games---conflicts",isDocsHomePage:!1,title:"Saved Games - Conflicts",description:"Detecting Conflicts",source:"@site/docs/gameservices/saved-games---conflicts.md",slug:"/gameservices/saved-games---conflicts",permalink:"/docs/gameservices/saved-games---conflicts",version:"current",sidebar_label:"Saved Games - Conflicts",sidebar:"gameservices",previous:{title:"Saved Games",permalink:"/docs/gameservices/saved-games"},next:{title:"Turn Based Multiplayer - Key Concepts",permalink:"/docs/gameservices/turn-based-multiplayer---key-concepts"}},s=[{value:"Detecting Conflicts",id:"detecting-conflicts",children:[]},{value:"Resolving Conflicts",id:"resolving-conflicts",children:[]}],l={rightToc:s};function d(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"detecting-conflicts"},"Detecting Conflicts"),Object(o.b)("p",null,"When using the Saved Games service in your game, it is possible for multiple devices to perform reads and writes on the same saved game. In the event that a device temporarily loses its network connection and later reconnects, this might cause data conflicts whereby the saved game stored on a player's local device is out-of-sync with the remote version stored in service's servers. The Saved Games services provides a conflict resolution mechanism that presents both sets of conflicting saved games at read-time and lets you implement a resolution strategy that is appropriate for your game."),Object(o.b)("p",null,"When the games service detects a data conflict, it notifies your game during a saved game operation (open, create, save etc) by dispatching a ",Object(o.b)("inlineCode",{parentName:"p"},"SavedGamesEvent.CONFLICT")," event."),Object(o.b)("p",null,"You should make sure you add a listener for this event before attempting any saved game operation."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-actionscript"}),"GameServices.service.savedGames.addEventListener( SavedGamesEvent.CONFLICT, conflictHandler );\n\n\nfunction conflictHandler( event:SavedGamesEvent ):void\n{\n    // Handle the conflict here\n\n    // event.conflictId identifies this conflict \n}\n")),Object(o.b)("p",null,"The conflict event willl contain two versions of the saved game in the ",Object(o.b)("inlineCode",{parentName:"p"},"data")," Array:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"The most-up-to-date version known by the service to be accurate (",Object(o.b)("inlineCode",{parentName:"li"},"event.data[0]"),"); and"),Object(o.b)("li",{parentName:"ul"},"A modified version detected on one of the player's devices that contains conflicting content or metadata (",Object(o.b)("inlineCode",{parentName:"li"},"event.data[1]"),"). This may not be the same as the version that you tried to save.")),Object(o.b)("p",null,"It will also contain the ",Object(o.b)("inlineCode",{parentName:"p"},"conflictId")," which identifies this conflict occurrance and is required to resolve this conflict."),Object(o.b)("h2",{id:"resolving-conflicts"},"Resolving Conflicts"),Object(o.b)("p",null,"Your game must decide how to resolve the conflict by picking one of the provided versions or merging the data of the two saved game versions."),Object(o.b)("p",null,"Once you have assembled the resolved version of the save game you call ",Object(o.b)("inlineCode",{parentName:"p"},"resolveConflict")," to resolve the conflict on the saved game with the conflict id and the resolved saved game as parameters:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-actionscript"}),"GameServices.service.savedGames.resolveConflict( conflictId, resolvedGame );\n")),Object(o.b)("p",null,"The following snippet shows and example of how your game might handle a saved game conflict by selecting the most recent saved game as the final version to save:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-actionscript"}),"function conflictHandler( event:SavedGameEvent ):void \n{\n    var savedGameA:SavedGame = event.data[0];\n    var savedGameB:SavedGame = event.data[1];\n\n    var resolvedGame:SavedGame = savedGameA.modified > savedGameB.modified ? savedGameA : savedGameB;        \n    GameServices.service.savedGames.resolveConflict( event.conflictId, resolvedGame );\n}\n")),Object(o.b)("p",null,"This call will result in either a ",Object(o.b)("inlineCode",{parentName:"p"},"SavedGamesEvent.CONFLICT_RESOLVE_SUCCESS")," or a ",Object(o.b)("inlineCode",{parentName:"p"},"SavedGamesEvent.CONFLICT_RESOLVE_ERROR")," event. "),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-actionscript"}),"GameServices.service.savedGames.addEventListener( SavedGamesEvent.CONFLICT_RESOLVE_SUCCESS, resolveSuccessHandler );\nGameServices.service.savedGames.addEventListener( SavedGamesEvent.CONFLICT_RESOLVE_ERROR, resolveErrorHandler );\n\n\nfunction resolveSuccessHandler( event:SavedGamesEvent ):void \n{\n    // The conflict was resolved and you can resume normal loading/saving etc.\n}\n\nfunction resolveErrorHandler( event:SavedGamesEvent ):void \n{\n    // The conflict wasn't resolved and will be encountered on the next saved games operation again\n}\n")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"Be aware that the call to resolve a conflict may itself dispatch another ",Object(o.b)("inlineCode",{parentName:"p"},"SavedGamesEvent.CONFLICT")," event, if for some reason there were a series of conflicts awaiting resolution. "),Object(o.b)("p",{parentName:"blockquote"},"Simply ensure that your conflict handler is never removed and always available to handle conflict resolutions.")))}d.isMDXComponent=!0},722:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return u}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),d=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},v=function(e){var t=d(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),v=d(n),p=a,u=v["".concat(i,".").concat(p)]||v[p]||m[p]||o;return n?r.a.createElement(u,c(c({ref:t},l),{},{components:n})):r.a.createElement(u,c({ref:t},l))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=p;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var l=2;l<o;l++)i[l]=n[l];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"}}]);