"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[68739],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),o=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=o(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),p=o(a),m=r,h=p["".concat(s,".").concat(m)]||p[m]||d[m]||l;return a?n.createElement(h,i(i({ref:t},c),{},{components:a})):n.createElement(h,i({ref:t},c))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=m;var u={};for(var s in t)hasOwnProperty.call(t,s)&&(u[s]=t[s]);u.originalType=e,u[p]="string"==typeof e?e:r,i[1]=u;for(var o=2;o<l;o++)i[o]=a[o];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},85162:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(67294),r=a(86010);const l={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:a,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(l.tabItem,i),hidden:a},t)}},74866:(e,t,a)=>{a.d(t,{Z:()=>w});var n=a(87462),r=a(67294),l=a(86010),i=a(12466),u=a(16550),s=a(91980),o=a(67392),c=a(50012);function p(e){return function(e){var t,a;return null!=(t=null==(a=r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:a.filter(Boolean))?t:[]}(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:r}}=e;return{value:t,label:a,attributes:n,default:r}}))}function d(e){const{values:t,children:a}=e;return(0,r.useMemo)((()=>{const e=null!=t?t:p(a);return function(e){const t=(0,o.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,a])}function m(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:a}=e;const n=(0,u.k6)(),l=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:t,groupId:a});return[(0,s._X)(l),(0,r.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(n.location.search);t.set(l,e),n.replace({...n.location,search:t.toString()})}),[l,n])]}function y(e){const{defaultValue:t,queryString:a=!1,groupId:n}=e,l=d(e),[i,u]=(0,r.useState)((()=>function(e){var t;let{defaultValue:a,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!m({value:a,tabValues:n}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+a+'" but none of its children has the corresponding value. Available values are: '+n.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return a}const r=null!=(t=n.find((e=>e.default)))?t:n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:l}))),[s,o]=h({queryString:a,groupId:n}),[p,y]=function(e){let{groupId:t}=e;const a=function(e){return e?"docusaurus.tab."+e:null}(t),[n,l]=(0,c.Nk)(a);return[n,(0,r.useCallback)((e=>{a&&l.set(e)}),[a,l])]}({groupId:n}),f=(()=>{const e=null!=s?s:p;return m({value:e,tabValues:l})?e:null})();(0,r.useLayoutEffect)((()=>{f&&u(f)}),[f]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:l}))throw new Error("Can't select invalid tab value="+e);u(e),o(e),y(e)}),[o,y,l]),tabValues:l}}var f=a(72389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function g(e){let{className:t,block:a,selectedValue:u,selectValue:s,tabValues:o}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,i.o5)(),d=e=>{const t=e.currentTarget,a=c.indexOf(t),n=o[a].value;n!==u&&(p(t),s(n))},m=e=>{var t;let a=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{var n;const t=c.indexOf(e.currentTarget)+1;a=null!=(n=c[t])?n:c[0];break}case"ArrowLeft":{var r;const t=c.indexOf(e.currentTarget)-1;a=null!=(r=c[t])?r:c[c.length-1];break}}null==(t=a)||t.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":a},t)},o.map((e=>{let{value:t,label:a,attributes:i}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:u===t?0:-1,"aria-selected":u===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:d},i,{className:(0,l.Z)("tabs__item",b.tabItem,null==i?void 0:i.className,{"tabs__item--active":u===t})}),null!=a?a:t)})))}function v(e){let{lazy:t,children:a,selectedValue:n}=e;const l=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=l.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},l.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function k(e){const t=y(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",b.tabList)},r.createElement(g,(0,n.Z)({},e,t)),r.createElement(v,(0,n.Z)({},e,t)))}function w(e){const t=(0,f.Z)();return r.createElement(k,(0,n.Z)({key:String(t)},e))}},85871:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>u,metadata:()=>o,toc:()=>p});var n=a(87462),r=(a(67294),a(3905)),l=a(74866),i=a(85162);const u={title:"Querying Data",sidebar_label:"Querying Data"},s=void 0,o={unversionedId:"health/queries",id:"health/queries",title:"Querying Data",description:"To query data you will create a StatisticsQuery and then pass it to the execute method. This will query the data specified and when complete call a callback function with the result.",source:"@site/docs/health/queries.mdx",sourceDirName:"health",slug:"/health/queries",permalink:"/docs/health/queries",draft:!1,tags:[],version:"current",frontMatter:{title:"Querying Data",sidebar_label:"Querying Data"},sidebar:"health",previous:{title:"Authorisation",permalink:"/docs/health/authorisation"},next:{title:"changelog",permalink:"/docs/health/changelog"}},c={},p=[{value:"Aggregating results",id:"aggregating-results",level:2},{value:"Manual User Entries",id:"manual-user-entries",level:2}],d={toc:p},m="wrapper";function h(e){let{components:t,...a}=e;return(0,r.kt)(m,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"To query data you will create a ",(0,r.kt)("inlineCode",{parentName:"p"},"StatisticsQuery")," and then pass it to the execute method. This will query the data specified and when complete call a callback function with the result."),(0,r.kt)(l.Z,{groupId:"framework",defaultValue:"air",values:[{label:"AIR",value:"air"},{label:"Unity",value:"unity"}],mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"air",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"var query:StatisticQuery = ...;\n\nHealth.instance.execute( query, callback );\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"callback")," function should be of the form:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"function( result:HealthQueryResult, error:Error ):void\n{\n    // Process query result\n}\n"))),(0,r.kt)(i.Z,{value:"unity",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},"StatisticsQuery query = ...;\nHealth.Instance.Execute( \n    query, \n    (result, error) =>\n    {\n        // Process query result\n    }\n);\n")),(0,r.kt)("p",null,"The callback function takes 2 parameters, a ",(0,r.kt)("inlineCode",{parentName:"p"},"HealthQueryResult")," and an ",(0,r.kt)("inlineCode",{parentName:"p"},"HealthError")," object. "))),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"HealthQueryResult")," contains the result of the query including an array of ",(0,r.kt)("inlineCode",{parentName:"p"},"Statistic")," objects in the ",(0,r.kt)("inlineCode",{parentName:"p"},"statistics")," parameter.\nIf an error occurred then the ",(0,r.kt)("inlineCode",{parentName:"p"},"error")," parameter will be non-null and contain the details of the error."),(0,r.kt)("p",null,"For example:"),(0,r.kt)(l.Z,{groupId:"framework",defaultValue:"air",values:[{label:"AIR",value:"air"},{label:"Unity",value:"unity"}],mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"air",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},'var now:Date = new Date();\nvar startDate:Date = new Date( 2023, 0, 1 );\n\nvar stepQuery:StatisticsQuery = new StatisticsQuery( HealthType.STEP_COUNT )\n        .withStartDate( startDate )\n        .withEndDate( now );\n\nHealth.instance.execute(\n        stepQuery,\n        function ( result:HealthQueryResult, error:Error ):void\n        {\n            if (error != null)\n            {\n                trace( "ERROR: " + error.message );\n                return;\n            }\n            // result will contain query data\n            for each (var stat:Statistic in result.statistics)\n            {\n                trace( stat.startDate.toString() + "::" + stat.sum );\n            }\n        }\n);\n'))),(0,r.kt)(i.Z,{value:"unity",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},'System.DateTime start = new System.DateTime(2025, 10, 1);\nSystem.DateTime end = start.AddDays(7);\n\nStatisticsQuery query = new StatisticsQuery(HealthType.STEP_COUNT)\n    .withStartDate(start)\n    .withEndDate(end);\n\nHealth.Instance.Execute(\n    query,\n    (result, error) =>\n    {\n        if (error != null)\n        {\n            Debug.Log("QuerySteps: error: " + error.description);\n            return;\n        }\n        if (result == null)\n        {\n            Debug.Log("QuerySteps: no result");\n            return;\n        }\n\n        for (int i = 0; i < result.statistics.Count; i++)\n        {\n            Statistic statistic = result.statistics[i];\n            Debug.Log(i + ": " +\n                "\\n startDate: " + statistic.startDate +\n                "\\n sum: " + statistic.sum\n            );\n        }\n    }\n);\n')))),(0,r.kt)("h2",{id:"aggregating-results"},"Aggregating results"),(0,r.kt)("p",null,"You can get the results aggregated into time intervals by calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"withInterval()")," method on the ",(0,r.kt)("inlineCode",{parentName:"p"},"StatisticsQuery"),"."),(0,r.kt)("p",null,"For example to group the results into daily totals:"),(0,r.kt)(l.Z,{groupId:"framework",defaultValue:"air",values:[{label:"AIR",value:"air"},{label:"Unity",value:"unity"}],mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"air",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"var stepQuery:StatisticsQuery = new StatisticsQuery( HealthType.STEP_COUNT )\n        .withStartDate( startDate )\n        .withEndDate( now )\n        .withInterval( 1, TimeUnit.DAYS );\n"))),(0,r.kt)(i.Z,{value:"unity",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},"StatisticsQuery query = new StatisticsQuery(HealthType.STEP_COUNT)\n    .withStartDate(start)\n    .withEndDate(end)\n    .withInterval(1, TimeUnit.DAYS);\n")))),(0,r.kt)("p",null,"This can be useful when you are displaying results in a particular format to a user."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"withInterval()")," method takes 2 parameters, the first being a ",(0,r.kt)("inlineCode",{parentName:"p"},"duration")," and the second is a ",(0,r.kt)("inlineCode",{parentName:"p"},"unit")," from the predefined values in the ",(0,r.kt)("inlineCode",{parentName:"p"},"TimeUnit")," class. "),(0,r.kt)("p",null,"This allows you to create various intervals:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"daily results: ",(0,r.kt)("inlineCode",{parentName:"li"},"withInterval( 1, TimeUnit.DAYS )")," "),(0,r.kt)("li",{parentName:"ul"},"6 hour buckets: ",(0,r.kt)("inlineCode",{parentName:"li"},"withInterval( 6, TimeUnit.HOURS )")," "),(0,r.kt)("li",{parentName:"ul"},"30 minute buckets: ",(0,r.kt)("inlineCode",{parentName:"li"},"withInterval( 30, TimeUnit.MINUTES )")," ")),(0,r.kt)("h2",{id:"manual-user-entries"},"Manual User Entries"),(0,r.kt)("p",null,"Filtering out entries that have been manually entered by the user can be helpful in certain situations. To do this, call the ",(0,r.kt)("inlineCode",{parentName:"p"},"filterManualDataEntries()")," method on the ",(0,r.kt)("inlineCode",{parentName:"p"},"StatisticsQuery"),"."),(0,r.kt)("p",null,"For example:"),(0,r.kt)(l.Z,{groupId:"framework",defaultValue:"air",values:[{label:"AIR",value:"air"},{label:"Unity",value:"unity"}],mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"air",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"var stepQuery:StatisticsQuery = new StatisticsQuery( HealthType.STEP_COUNT )\n        .withStartDate( startDate )\n        .withEndDate( now )\n        .filterManualDataEntries();\n"))),(0,r.kt)(i.Z,{value:"unity",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},"StatisticsQuery query = new StatisticsQuery(HealthType.STEP_COUNT)\n    .withStartDate(start)\n    .withEndDate(end)\n    .filterManualDataEntries();\n")))),(0,r.kt)("p",null,"Conversely, you can request only manual data entries by using ",(0,r.kt)("inlineCode",{parentName:"p"},"manualDataEntriesOnly()"),":"),(0,r.kt)(l.Z,{groupId:"framework",defaultValue:"air",values:[{label:"AIR",value:"air"},{label:"Unity",value:"unity"}],mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"air",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"var stepQuery:StatisticsQuery = new StatisticsQuery( HealthType.STEP_COUNT )\n        .withStartDate( startDate )\n        .withEndDate( now )\n        .manualDataEntriesOnly();\n"))),(0,r.kt)(i.Z,{value:"unity",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},"StatisticsQuery query = new StatisticsQuery(HealthType.STEP_COUNT)\n    .withStartDate(start)\n    .withEndDate(end)   \n    .manualDataEntriesOnly();\n")))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Filtering data entries will override aggregation requests on Android, resulting in a query that returns individual samples. Apple's HealthKit seems to have no issues with this. "),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Fit")," "),(0,r.kt)("p",{parentName:"admonition"},"With the Google FIT API service the data records are queried within the time frame and then any with a data source set to ",(0,r.kt)("inlineCode",{parentName:"p"},"user_input")," are removed.\nThis was impossible when aggregated as the sources were combined together."),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"HealthConnect")),(0,r.kt)("p",{parentName:"admonition"},"Currently Health Connect seems to be inconsistent with filtering results. Similar to Google Fit the samples must be queried without aggregation to get access to the data origins, however the fields don't seem to be correctly set by certain applications so the results may be inconsistent. ")))}h.isMDXComponent=!0}}]);