(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{126:function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return m}));var i=t(0),a=t.n(i);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=a.a.createContext({}),p=function(e){var n=a.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},b=function(e){var n=p(e.components);return a.a.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},d=a.a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=p(t),d=i,m=b["".concat(o,".").concat(d)]||b[d]||u[d]||r;return t?a.a.createElement(m,c(c({ref:n},l),{},{components:t})):a.a.createElement(m,c({ref:n},l))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=d;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c.mdxType="string"==typeof e?e:i,o[1]=c;for(var l=2;l<r;l++)o[l]=t[l];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},71:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return r})),t.d(n,"metadata",(function(){return o})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return l}));var i=t(2),a=(t(0),t(126));const r={title:"Communication",sidebar_label:"Communication"},o={unversionedId:"nativewebview/communication",id:"nativewebview/communication",isDocsHomePage:!1,title:"Communication",description:"One of the important aspects of this extension is the ability to communicate from your Actionscript",source:"@site/docs/nativewebview/communication.md",slug:"/nativewebview/communication",permalink:"/docs/nativewebview/communication",version:"current",sidebar_label:"Communication",sidebar:"nativewebview",previous:{title:"Screenshot",permalink:"/docs/nativewebview/screenshot"},next:{title:"Location Changes",permalink:"/docs/nativewebview/location-changes"}},c=[{value:"Android",id:"android",children:[]},{value:"Example",id:"example",children:[]},{value:"AIR Bridge Code",id:"air-bridge-code",children:[]}],s={rightToc:c};function l({components:e,...n}){return Object(a.b)("wrapper",Object(i.a)({},s,n,{components:e,mdxType:"MDXLayout"}),Object(a.b)("p",null,"One of the important aspects of this extension is the ability to communicate from your Actionscript\ncode to the Javascript in the web page and vice-versa."),Object(a.b)("p",null,"To do this there is a function on the actionscript side to run javascript in the page:\n",Object(a.b)("inlineCode",{parentName:"p"},"evaluateJavascript"),". When this is called your code will be sent and run on the currently loaded\npage and any return value will be available by listening to the event: ",Object(a.b)("inlineCode",{parentName:"p"},"NativeWebViewEvent.JAVASCRIPT_RESPONSE")),Object(a.b)("p",null,"On the javascript side, we have a helper script to simplify the communication back to the ",Object(a.b)("inlineCode",{parentName:"p"},"WebView"),".\nCalling the ",Object(a.b)("inlineCode",{parentName:"p"},"AirBridge.message( 'content-for-air' );")," in your Javascript will cause a\n",Object(a.b)("inlineCode",{parentName:"p"},"NativeWebViewEvent.JAVASCRIPT_MESSAGE")," event to be dispatched with the data value containing\nthe message, 'content-for-air' in this case."),Object(a.b)("p",null,"The two important events here are:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"NativeWebViewEvent.JAVASCRIPT_RESPONSE"),": Dispatched for a response from an AS3 initiated javascript call;"),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"NativeWebViewEvent.JAVASCRIPT_MESSAGE"),": Dispatched when a message is received from javascript running on the page;")),Object(a.b)("h3",{id:"android"},"Android"),Object(a.b)("p",null,"On Android the communication channel is only completely setup after the page load is complete. I.e after ",Object(a.b)("inlineCode",{parentName:"p"},"NativeWebViewEvent.COMPLETE"),". We suggest you wait for this event before attempting to communicate between the page and the application."),Object(a.b)("p",null,"To this end, we suggest implementing a function in your page that you call from AS3 after the ",Object(a.b)("inlineCode",{parentName:"p"},"NativeWebViewEvent.COMPLETE")," event has fired, which initialises your communication channel."),Object(a.b)("p",null,"We have implemented some handlers for this scenario but they may affect loading of the page and we suggest you take the above approach wherever possible."),Object(a.b)("h3",{id:"example"},"Example"),Object(a.b)("p",null,"The following is an example from actionscript:"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-actionscript"}),'var webView:WebView = NativeWebView.service.createWebView( new Rectangle( 0, 0, 400, 600 ) ) ;\n\nwebView.addEventListener( NativeWebViewEvent.COMPLETE, webView_completeHandler );\nwebView.addEventListener( NativeWebViewEvent.JAVASCRIPT_RESPONSE, javascriptResponseHandler );\nwebView.addEventListener( NativeWebViewEvent.JAVASCRIPT_MESSAGE, javascriptMessageHandler );\n\nvar file:File = File.applicationStorageDirectory.resolvePath( "example.html" );\n\nwebView.loadURL( "file://"+file.nativePath );\n\n\nfunction completeHandler( event:NativeWebViewEvent ):void\n{\n    webView.evaluateJavascript( "alert(\'message from AS3\');" );\n}\n\nfunction javascriptResponseHandler( event:NativeWebViewEvent ):void\n{\n    trace( "evaluateJavascript response: " + event.data );\n}\n\nfunction javascriptMessageHandler( event:NativeWebViewEvent ):void\n{\n    // This is the message sent from the javascript \n    // AirBridge.message i.e. \'content-for-air\' \n    trace( "message from JS: " + event.data );\n}\n')),Object(a.b)("p",null,"communicating with the following html page:"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-html",metastring:'title="example.html"',title:'"example.html"'}),'<html>\n<head>\n    <meta charset="utf-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n\n    <script type="text/javascript" src="airbridge.js" ><\/script>\n    <script>\n        "use strict";\n        function sendToAIR()\n        {\n            AirBridge.message( "content-for-air" );\n        }\n    <\/script>\n</head>\n\n<body>\n    <h1>NativeWebView Example</h1>\n    <p>\n        <button type="button" onClick="sendToAIR()" >Example Call</button>  \n    </p>\n</body>\n\n</html>\n')),Object(a.b)("h3",{id:"air-bridge-code"},"AIR Bridge Code"),Object(a.b)("p",null,"This is the contents of the ",Object(a.b)("inlineCode",{parentName:"p"},"airbridge.js")," file"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-javascript",metastring:'title="airbridge.js"',title:'"airbridge.js"'}),'var AirBridge = (function() {\n    var instance;\n    function createInstance() {\n        var object = new Object();\n        object.useWindowLocation = true;\n        return object;\n    }\n    \n    return {\n        setUseWindowLocation: function( $shouldUseWindowLocation ) {\n            if (!instance) {\n                instance = createInstance();\n            }\n            instance.useWindowLocation = $shouldUseWindowLocation;  \n        },\n        \n        message: function( $message ) {\n            if (!instance) {\n                instance = createInstance();\n            }\n            if (!instance.useWindowLocation) {\n                NativeWebView.airBridge( $message );\n            }\n            else {\n                window.location = "airBridge:" + $message;\n            }\n        }\n    };\n})();\n')))}l.isMDXComponent=!0}}]);