"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[33324],{3905:function(e,a,n){n.d(a,{Zo:function(){return p},kt:function(){return u}});var t=n(67294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function i(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?i(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function o(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=t.createContext({}),s=function(e){var a=t.useContext(c),n=a;return e&&(n="function"==typeof e?e(a):l(l({},a),e)),n},p=function(e){var a=s(e.components);return t.createElement(c.Provider,{value:a},e.children)},d={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},m=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=s(n),u=r,f=m["".concat(c,".").concat(u)]||m[u]||d[u]||i;return n?t.createElement(f,l(l({ref:a},p),{},{components:n})):t.createElement(f,l({ref:a},p))}));function u(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var c in a)hasOwnProperty.call(a,c)&&(o[c]=a[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return t.createElement.apply(null,l)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},68422:function(e,a,n){n.r(a),n.d(a,{frontMatter:function(){return l},contentTitle:function(){return o},metadata:function(){return c},toc:function(){return s},default:function(){return d}});var t=n(87462),r=n(63366),i=(n(67294),n(3905)),l={title:"Alarm Manager",sidebar_label:"Alarm Manager"},o=void 0,c={unversionedId:"application/alarm-manager",id:"application/alarm-manager",isDocsHomePage:!1,title:"Alarm Manager",description:"The Alarm Manager functionality allows you to use the Android Alarm manager to set your application to receive events",source:"@site/docs/application/alarm-manager.md",sourceDirName:"application",slug:"/application/alarm-manager",permalink:"/docs/application/alarm-manager",tags:[],version:"current",frontMatter:{title:"Alarm Manager",sidebar_label:"Alarm Manager"},sidebar:"application",previous:{title:"Soft Keyboard",permalink:"/docs/application/display/soft-keyboard"},next:{title:"Auto Start",permalink:"/docs/application/auto-start"}},s=[{value:"Android: Manifest Additions",id:"android-manifest-additions",children:[]},{value:"Checking Availability",id:"checking-availability",children:[]},{value:"Register for Events",id:"register-for-events",children:[]},{value:"Creating an Alarm",id:"creating-an-alarm",children:[]},{value:"Cancelling an Alarm",id:"cancelling-an-alarm",children:[{value:"Cancel by ID",id:"cancel-by-id",children:[]},{value:"Cancel by Alarm",id:"cancel-by-alarm",children:[]}]},{value:"Cancel All Alarms",id:"cancel-all-alarms",children:[]}],p={toc:s};function d(e){var a=e.components,n=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,t.Z)({},p,n,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"The Alarm Manager functionality allows you to use the Android Alarm manager to set your application to receive events\nat a particular time. It also allows you to launch your application into the foreground if you require. "),(0,i.kt)("h2",{id:"android-manifest-additions"},"Android: Manifest Additions"),(0,i.kt)("p",null,"There are some manifest additions required for this functionality, add the following to your manifest.\nThere are two receivers and an activity required.\nThe first receiver is required to restore alarms after a reboot and the second to actually receive the alarms."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<manifest android:installLocation="auto">\n    <uses-permission android:name="android.permission.INTERNET"/>\n    <uses-permission android:name="android.permission.WAKE_LOCK" />\n    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />\n    \n    <application>\n        <receiver android:enabled="true" android:name="com.distriqt.extension.application.receivers.ApplicationStartupReceiver" android:permission="android.permission.RECEIVE_BOOT_COMPLETED">\n            <intent-filter>\n                <action android:name="android.intent.action.BOOT_COMPLETED" />\n                <category android:name="android.intent.category.DEFAULT" />\n            </intent-filter>\n        </receiver>\n        \n        <receiver android:name="com.distriqt.extension.application.alarms.AlarmReceiver" android:enabled="true" />\n        <activity android:name="com.distriqt.extension.application.alarms.AlarmActivity" android:theme="@android:style/Theme.Translucent.NoTitleBar" />\n        \n    </application>\n        \n</manifest>\n')),(0,i.kt)("h2",{id:"checking-availability"},"Checking Availability"),(0,i.kt)("p",null,"You should check whether the alarm manager functionality is available on the current device\nbefore attempting to use any of the functions below. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (Application.service.alarmManager.isSupported) \n{\n    // AlarmManager functionality is available\n}\n")),(0,i.kt)("p",null,"The Alarm Manager will not be available on some platforms eg iOS does not currently support this functionality. "),(0,i.kt)("h2",{id:"register-for-events"},"Register for Events"),(0,i.kt)("p",null,"Next you will need to do is add an event listener for the alarm events and register for the events.\nThe ",(0,i.kt)("inlineCode",{parentName:"p"},"AlarmEvent.ALARM")," is dispatched whenever an alarm occurs. "),(0,i.kt)("p",null,"Calling ",(0,i.kt)("inlineCode",{parentName:"p"},"register()")," will not only register for alarms but also check if the application was launched from an alarm,\nso an alarm event may be dispatched immediately after a call to this function. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'Application.service.alarmManager.addEventListener( AlarmEvent.ALARM, alarmHandler );\nApplication.service.alarmManager.register();\n\n...\n\nprivate function alarmHandler( event:AlarmEvent ):void\n{\n    trace( "alarmHandler: ["+event.id+ "] "+event.data );\n}\n')),(0,i.kt)("h2",{id:"creating-an-alarm"},"Creating an Alarm"),(0,i.kt)("p",null,"To create an Alarm you use the ",(0,i.kt)("inlineCode",{parentName:"p"},"setAlarm")," function of the ",(0,i.kt)("inlineCode",{parentName:"p"},"AlarmManager")," and an ",(0,i.kt)("inlineCode",{parentName:"p"},"AlarmBuilder"),"."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"AlarmBuilder")," is a helper class giving you the easy ability to setup an alarm correctly. "),(0,i.kt)("p",null,"You can pass a String as the data of the alarm that will be returned in the alarm event.\nThis can be used to distinguish which alarm occurred in your application.\nWe suggest using an stringified JSON Object as below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},'var data:Object = {};\ndata.id = Math.floor(100*Math.random());\ndata.message = "a distriqt alarm";\n\nvar timestamp:Number = new Date().time + 10000 ;\n\nApplication.service.alarmManager.setAlarm( \n    new AlarmBuilder()\n        .setId( data.id )\n        .setTime( timestamp )\n        .setData( JSON.stringify( data ))\n        .setWillLaunchApplication()\n        .build()\n);\n')),(0,i.kt)("h2",{id:"cancelling-an-alarm"},"Cancelling an Alarm"),(0,i.kt)("h3",{id:"cancel-by-id"},"Cancel by ID"),(0,i.kt)("p",null,"The simplest way to cancel an alarm is to cancel the alarm by the ID of the alarm:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"Application.service.alarmManager.cancelAlarmById( id );\n")),(0,i.kt)("p",null,"This id should be the same as the id passed to your ",(0,i.kt)("inlineCode",{parentName:"p"},"AlarmBuilder.setId( )")," call."),(0,i.kt)("h3",{id:"cancel-by-alarm"},"Cancel by Alarm"),(0,i.kt)("p",null,"You can also cancel an alarm using the ",(0,i.kt)("inlineCode",{parentName:"p"},"Alarm")," object that you previously built\nand passing that to the ",(0,i.kt)("inlineCode",{parentName:"p"},"cancelAlarm")," function."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"Application.service.alarmManager.cancelAlarm( alarm );\n")),(0,i.kt)("p",null,"This ",(0,i.kt)("inlineCode",{parentName:"p"},"alarm")," object can either be stored from the setAlarm call or reconstructed using\nan ",(0,i.kt)("inlineCode",{parentName:"p"},"AlarmBuilder")," with ",(0,i.kt)("strong",{parentName:"p"},"exactly the same parameters")," as used previously. For example\nmatching the call above:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"Application.service.alarmManager.cancelAlarm(\n    new AlarmBuilder()\n        .setId( data.id )\n        .setTime( timestamp )\n        .setData( JSON.stringify( data ))\n        .setWillLaunchApplication()\n        .build()\n);\n")),(0,i.kt)("h2",{id:"cancel-all-alarms"},"Cancel All Alarms"),(0,i.kt)("p",null,"To cancel all previously set alarms, simply call the ",(0,i.kt)("inlineCode",{parentName:"p"},"cancelAllAlarms")," function."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-actionscript"},"Application.service.alarmManager.cancelAllAlarms();\n")))}d.isMDXComponent=!0}}]);