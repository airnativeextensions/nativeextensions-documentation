"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[3640],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var i=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,s=function(e,t){if(null==e)return{};var n,i,s={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var u=i.createContext({}),l=function(e){var t=i.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=l(e.components);return i.createElement(u.Provider,{value:t},e.children)},h="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,u=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),h=l(n),d=s,m=h["".concat(u,".").concat(d)]||h[d]||p[d]||a;return n?i.createElement(m,o(o({ref:t},c),{},{components:n})):i.createElement(m,o({ref:t},c))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,o=new Array(a);o[0]=d;var r={};for(var u in t)hasOwnProperty.call(t,u)&&(r[u]=t[u]);r.originalType=e,r[h]="string"==typeof e?e:s,o[1]=r;for(var l=2;l<a;l++)o[l]=n[l];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},61264:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var i=n(87462),s=(n(67294),n(3905));const a={title:"Requesting Access",sidebar_label:"Requesting Access"},o=void 0,r={unversionedId:"permissions/requesting-access",id:"permissions/requesting-access",title:"Requesting Access",description:"When you are going to be accessing a 'dangerous' permission you must check that",source:"@site/docs/permissions/requesting-access.md",sourceDirName:"permissions",slug:"/permissions/requesting-access",permalink:"/docs/permissions/requesting-access",draft:!1,tags:[],version:"current",frontMatter:{title:"Requesting Access",sidebar_label:"Requesting Access"},sidebar:"permissions",previous:{title:"Set Permissions",permalink:"/docs/permissions/set-permissions"},next:{title:"File and Folder Access",permalink:"/docs/permissions/file-folder-access"}},u={},l=[{value:"Multiple Permissions",id:"multiple-permissions",level:2},{value:"Set Permissions",id:"set-permissions",level:3},{value:"Check Authorisation",id:"check-authorisation",level:3},{value:"Request Authorisation",id:"request-authorisation",level:3},{value:"Event",id:"event",level:4},{value:"Callback",id:"callback",level:4},{value:"Example",id:"example",level:3},{value:"Individual Permissions",id:"individual-permissions",level:2},{value:"Check Authorisation",id:"check-authorisation-1",level:3},{value:"Request Authorisation",id:"request-authorisation-1",level:3},{value:"Event",id:"event-1",level:4},{value:"Callback",id:"callback-1",level:4},{value:"Events",id:"events",level:2}],c={toc:l},h="wrapper";function p(e){let{components:t,...a}=e;return(0,s.kt)(h,(0,i.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"When you are going to be accessing a 'dangerous' permission you must check that\nyour application has been allowed access."),(0,s.kt)("p",null,(0,s.kt)("img",{src:n(68668).Z,width:"1240",height:"930"})),(0,s.kt)("p",null,"On Android these permissions are listed through the manifest additions. On older\nversions of Android these permissions are accepted when the user installs the\napplication. More modern versions (Marshmallow 6 ","[API v23]","+) require that you request\nthe permissions similar to iOS. You will still need to list them in your manifest\nand then follow the same code below."),(0,s.kt)("h2",{id:"multiple-permissions"},"Multiple Permissions"),(0,s.kt)("p",null,"You can use the extension to handle multiple permissions by passing an array of permissions to the extension and then using the following functionality to check for authorisation status of all the permissions combined."),(0,s.kt)("h3",{id:"set-permissions"},"Set Permissions"),(0,s.kt)("p",null,"You must inform the extension which permissions you wish to request.\nThis is done by passing an array of ",(0,s.kt)("inlineCode",{parentName:"p"},"String"),"s each being the permission required."),(0,s.kt)("p",null,"For example to set the camera permission:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},'Permissions.service.setPermissions( \n    [ \n        "android.permission.CAMERA" \n    ] \n);\n')),(0,s.kt)("h3",{id:"check-authorisation"},"Check Authorisation"),(0,s.kt)("p",null,"You can check the current authorisation status by calling the ",(0,s.kt)("inlineCode",{parentName:"p"},"authorisationStatus()")," method:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},"switch (Permissions.service.authorisationStatus())\n{\n    case AuthorisationStatus.AUTHORISED:\n        // This device has been authorised.\n        break;\n        \n    case AuthorisationStatus.NOT_DETERMINED:\n    case AuthorisationStatus.SHOULD_EXPLAIN:\n        // You are yet to ask for authorisation or need to further explain\n        // At this point you should consider your strategy to get your \n        // user to authorise by explaining your need for the permissions\n        break;\n        \n    case AuthorisationStatus.DENIED:\n    case AuthorisationStatus.UNKNOWN:\n    case AuthorisationStatus.RESTRICTED:\n        // The user has disabled the permissions\n        // Advise your user of the lack of permissions as you see fit\n        break;\n}\n")),(0,s.kt)("p",null,"You should respect the ",(0,s.kt)("inlineCode",{parentName:"p"},"SHOULD_EXPLAIN")," status by displaying additional information\nto your user about why you require this functionality."),(0,s.kt)("h3",{id:"request-authorisation"},"Request Authorisation"),(0,s.kt)("p",null,"To request authorisation call the ",(0,s.kt)("inlineCode",{parentName:"p"},"requestAuthorisation()")," function. You can either wait for the event or supply a callback function to get details on when the request authorisation process completes."),(0,s.kt)("h4",{id:"event"},"Event"),(0,s.kt)("p",null,"You will receive an ",(0,s.kt)("inlineCode",{parentName:"p"},"AuthorisationEvent.CHANGED")," event after the process completes which contains the updated ",(0,s.kt)("inlineCode",{parentName:"p"},"status"),": "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},"Permissions.service.addEventListener( AuthorisationEvent.CHANGED, authorisationChangedHandler );\nPermissions.service.requestAuthorisation();\n")),(0,s.kt)("p",null,"You will then receive a change event if the user accepted your permission request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},"function authorisationChangedHandler( event:AuthorisationEvent ):void\n{\n    // Check the authorisation state again (as above)\n}\n")),(0,s.kt)("h4",{id:"callback"},"Callback"),(0,s.kt)("p",null,"You can supply a function to the ",(0,s.kt)("inlineCode",{parentName:"p"},"requestAuthorisation()")," method that will be called when the process completes. This method should have the following signature ",(0,s.kt)("inlineCode",{parentName:"p"},"function( status:String ):void"),". The ",(0,s.kt)("inlineCode",{parentName:"p"},"status")," parameter is the updated authorisation status."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},'Permissions.instance.requestAuthorisation(\n        function ( status:String ):void\n        {\n            trace( "requestAuthorisation(): status=" + status );\n            // Check the authorisation state again (as above)\n        } );\n')),(0,s.kt)("h3",{id:"example"},"Example"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},"function checkAndRequestAuthorisation():void \n{\n    switch (Permissions.service.authorisationStatus())\n    {\n        case AuthorisationStatus.AUTHORISED:\n            // This device has been authorised.\n            break;\n            \n        case AuthorisationStatus.NOT_DETERMINED:\n            // You are yet to ask for authorisation \n            Permissions.service.addEventListener( AuthorisationEvent.CHANGED, authorisationChangedHandler );\n            Permissions.service.requestAuthorisation();\n            break;\n\n        case AuthorisationStatus.SHOULD_EXPLAIN:\n            // At this point you should consider your strategy to get your \n            // user to authorise by explaining your need for the permissions\n            \n            // You can attempt a request again or show a dialog as to the requirement for the permission\n\n            break;\n\n        case AuthorisationStatus.DENIED:\n        case AuthorisationStatus.UNKNOWN:\n        case AuthorisationStatus.RESTRICTED:\n            // The user has disabled the permissions\n            // Advise your user of the lack of permissions as you see fit\n            break;\n    }\n}\n\nfunction authorisationChangedHandler( event:AuthorisationEvent ):void\n{\n    // Check the authorisation state again (as above)\n    checkAndRequestAuthorisation();\n}\n")),(0,s.kt)("h2",{id:"individual-permissions"},"Individual Permissions"),(0,s.kt)("p",null,"Instead of using multiple permissions together it is often more important to request permissions individually and when appropriate functionality is being used in your application (eg requesting camera permission when the user requests to take a photo)."),(0,s.kt)("h3",{id:"check-authorisation-1"},"Check Authorisation"),(0,s.kt)("p",null,"You can check the authorisation status for a specific permission by using the ",(0,s.kt)("inlineCode",{parentName:"p"},"authorisationStatusForPermission()")," method:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},'var status:String = Permissions.instance.authorisationStatusForPermission( "android.permission.CAMERA" );\n')),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"status")," can be one of the values defined in the ",(0,s.kt)("inlineCode",{parentName:"p"},"AuthorisationStatus")," class:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},"switch (status)\n{\n    case AuthorisationStatus.AUTHORISED:\n        // This device has been authorised.\n        break;\n        \n    case AuthorisationStatus.NOT_DETERMINED:\n    case AuthorisationStatus.SHOULD_EXPLAIN:\n        // You are yet to ask for authorisation or need to further explain\n        // At this point you should consider your strategy to get your \n        // user to authorise by explaining your need for the permission\n        break;\n        \n    case AuthorisationStatus.DENIED:\n    case AuthorisationStatus.UNKNOWN:\n    case AuthorisationStatus.RESTRICTED:\n        // The user has disabled the permission\n        // Advise your user of the lack of permission as you see fit\n        break;\n}\n")),(0,s.kt)("h3",{id:"request-authorisation-1"},"Request Authorisation"),(0,s.kt)("p",null,"To request authorisation for an individual permission you can use the ",(0,s.kt)("inlineCode",{parentName:"p"},"requestAuthorisationForPermission()")," method passing the permission of interest."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},'Permissions.instance.requestAuthorisationForPermission( "android.permission.CAMERA" );\n')),(0,s.kt)("p",null,"Similar to the ",(0,s.kt)("inlineCode",{parentName:"p"},"requestAuthorisation()")," method this method can either be handled with an event result or via a callback function."),(0,s.kt)("h4",{id:"event-1"},"Event"),(0,s.kt)("p",null,"You will receive an ",(0,s.kt)("inlineCode",{parentName:"p"},"AuthorisationEvent.CHANGED")," (or ",(0,s.kt)("inlineCode",{parentName:"p"},"AuthorisationEvent.PERMISSION_CHANGED"),") event after the process completes which contains the updated ",(0,s.kt)("inlineCode",{parentName:"p"},"status"),": "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},'Permissions.service.addEventListener( AuthorisationEvent.CHANGED, authorisationChangedHandler );\nPermissions.service.requestAuthorisationForPermission( "android.permission.CAMERA" );\n')),(0,s.kt)("p",null,"You will then receive a change event if the user accepted your permission request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},"function authorisationChangedHandler( event:AuthorisationEvent ):void\n{\n    // Check the authorisation state again (as above)\n}\n")),(0,s.kt)("h4",{id:"callback-1"},"Callback"),(0,s.kt)("p",null,"You can supply a function to the ",(0,s.kt)("inlineCode",{parentName:"p"},"requestAuthorisation()")," method that will be called when the process completes. This method should have the following signature ",(0,s.kt)("inlineCode",{parentName:"p"},"function( status:String ):void"),". The ",(0,s.kt)("inlineCode",{parentName:"p"},"status")," parameter is the updated authorisation status."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-actionscript"},'Permissions.instance.requestAuthorisationForPermission(\n        "android.permission.CAMERA",\n        function ( status:String ):void\n        {\n            trace( "requestAuthorisationForPermission(): status=" + status );\n            // Check the authorisation state again (as above)\n        } );\n')),(0,s.kt)("h2",{id:"events"},"Events"),(0,s.kt)("p",null,"There are two main events of interest dispatched by this extension."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"AuthorisationEvent.CHANGED"),": Dispatched when the authorisation status has changed. This is independent of any particular permission and just indicates something has changed. "),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"AuthorisationEvent.PERMISSION_CHANGED"),': Dispatched when the authorisation status of a specific permission changes. The event contains the permission and the new status. If you are using the "multiple permissions" approach you may receive multiple of these events after a request authorisation process has completed.')))}p.isMDXComponent=!0},68668:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/userflow-d4ecbb827a3dfd60eef5e1f58b30bb5b.png"}}]);