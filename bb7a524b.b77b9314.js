(window.webpackJsonp=window.webpackJsonp||[]).push([[608],{664:function(e,n,i){"use strict";i.r(n),i.d(n,"frontMatter",(function(){return r})),i.d(n,"metadata",(function(){return s})),i.d(n,"rightToc",(function(){return c})),i.d(n,"default",(function(){return l}));var t=i(2),o=i(6),a=(i(0),i(898)),r={title:"Azure Notifications",sidebar_label:"Azure Notifications"},s={unversionedId:"pushnotifications/azure/azure-notifications",id:"pushnotifications/azure/azure-notifications",isDocsHomePage:!1,title:"Azure Notifications",description:"Azure Notification Hubs provide an easy-to-use, multi-platform, scaled-out push engine.",source:"@site/docs/pushnotifications/azure/azure-notifications.md",slug:"/pushnotifications/azure/azure-notifications",permalink:"/docs/pushnotifications/azure/azure-notifications",version:"current",sidebar_label:"Azure Notifications",sidebar:"pushnotifications",previous:{title:"Windows Notification Service",permalink:"/docs/pushnotifications/windows/windows-notification-service"},next:{title:"Pushy",permalink:"/docs/pushnotifications/pushy/pushy"}},c=[{value:"Required ANEs",id:"required-anes",children:[{value:"Google Play Services",id:"google-play-services",children:[]},{value:"Firebase",id:"firebase",children:[]}]},{value:"Extension IDs",id:"extension-ids",children:[]},{value:"Manifest Additions",id:"manifest-additions",children:[{value:"MultiDex Applications",id:"multidex-applications",children:[]}]}],d={rightToc:c};function l(e){var n=e.components,i=Object(o.a)(e,["components"]);return Object(a.b)("wrapper",Object(t.a)({},d,i,{components:n,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Azure Notification Hubs provide an easy-to-use, multi-platform, scaled-out push engine.\nWith a single cross-platform API call, you can easily send targeted and personalized\npush notifications to any mobile platform from any cloud or on-premises backend."),Object(a.b)("p",null,"You can read more about Azure Notification Hubs ",Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/azure/notification-hubs/notification-hubs-push-notification-overview"}),"here")),Object(a.b)("p",null,"This ANE implements the requirements to register correctly with your Azure Notification\nHub, sending the required device information so your uses will automatically be registered\nwith Azure when you go through the normal registration process using the Azure version of\nPush Notifications."),Object(a.b)("p",null,Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"https://portal.azure.com"}),"https://portal.azure.com")),Object(a.b)("h2",{id:"required-anes"},"Required ANEs"),Object(a.b)("p",null,"To use this service add the ",Object(a.b)("inlineCode",{parentName:"p"},"com.distriqt.PushNotifications.Azure.ane")," variant of the extension to your project in place of  ",Object(a.b)("inlineCode",{parentName:"p"},"com.distriqt.PushNotifications.ane"),". You should only add one of the variants to your project. If you need to support multiple services please use the All Services variant."),Object(a.b)("p",null,"All variants of the Push Notifications extension have the same extension id: ",Object(a.b)("inlineCode",{parentName:"p"},"com.distriqt.PushNotifications")," so you should add this to your extensions list in your application descriptor:"),Object(a.b)("pre",null,Object(a.b)("code",Object(t.a)({parentName:"pre"},{className:"language-xml"}),"<extensions>\n    ...\n    \n    <extensionID>com.distriqt.PushNotifications</extensionID>\n    \n    ...\n</extensions>\n")),Object(a.b)("p",null,"Make sure you have added the common ANEs from the ",Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"../add-the-extension"}),"Add the Extension")," section first. This includes the Core and Android Support ANEs."),Object(a.b)("h3",{id:"google-play-services"},"Google Play Services"),Object(a.b)("p",null,"This ANE requires usage of certain aspects of the Google Play Services client library.\nThe client library is available as a series of ANEs that you add into your applications packaging options.\nEach separate ANE provides a component from the Play Services client library and are used by different ANEs.\nThese client libraries aren't packaged with this ANE as they are used by multiple ANEs and separating them\nwill avoid conflicts, allowing you to use multiple ANEs in the one application."),Object(a.b)("p",null,"This ANE requires the following Google Play Services:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(t.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-GooglePlayServices/raw/master/lib/com.distriqt.playservices.Base.ane"}),"com.distriqt.playservices.Base.ane"))),Object(a.b)("p",null,"You must include the above native extensions in your application along with this extension,\nand you need to ensure they are packaged with your application."),Object(a.b)("p",null,"You can access the Google Play Services client library extensions here: ",Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"https://github.com/distriqt/ANE-GooglePlayServices"}),"https://github.com/distriqt/ANE-GooglePlayServices"),"."),Object(a.b)("h3",{id:"firebase"},"Firebase"),Object(a.b)("p",null,"To use Firebase Cloud Messaging you must include the core Firebase libraries and configure\nyour Firebase application. The core libraries are available in the ",Object(a.b)("inlineCode",{parentName:"p"},"com.google.firebase.core")," extension alongside the Google Play Services:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(t.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-GooglePlayServices/raw/master/lib/com.google.firebase.core.ane"}),"com.google.firebase.core.ane"))),Object(a.b)("p",null,"See the ",Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"https://docs.airnativeextensions.com/docs/firebase/setup/configuration-files/"}),"Firebase configuration documentation")," on how to configure your application."),Object(a.b)("h2",{id:"extension-ids"},"Extension IDs"),Object(a.b)("p",null,"The following should be added to your ",Object(a.b)("inlineCode",{parentName:"p"},"extensions")," node in your application descriptor to identify all the required ANEs in your application:"),Object(a.b)("pre",null,Object(a.b)("code",Object(t.a)({parentName:"pre"},{className:"language-xml"}),"<extensions>\n    <extensionID>com.distriqt.PushNotifications</extensionID>\n    <extensionID>com.distriqt.Core</extensionID>\n    \n    <extensionID>com.distriqt.playservices.Base</extensionID>\n    \n    <extensionID>com.google.firebase.core</extensionID>\n    <extensionID>com.google.android.datatransport</extensionID>\n    <extensionID>com.google.dagger</extensionID>\n    <extensionID>androidx.core</extensionID>\n    <extensionID>androidx.browser</extensionID>\n</extensions>\n")),Object(a.b)("h1",{id:"android"},"Android"),Object(a.b)("p",null,"Azure uses FCM on Android (not on iOS), so you will need to go through the setup of Firebase for Android\nin your application. See the ",Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"https://docs.airnativeextensions.com/docs/firebase/"}),"Firebase wiki")," on this process\nbut just ignore any iOS references."),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"The Microsoft documentation for this process can be found ",Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/azure/notification-hubs/notification-hubs-android-push-notification-google-fcm-get-started"}),"here"))),Object(a.b)("h2",{id:"manifest-additions"},"Manifest Additions"),Object(a.b)("p",null,"You must add all the Firebase related manifest additions along with several additions for Cloud Messaging\nand several particular additions for Azure. Please note that these are very similar to the additions for\nFirebase however they are different."),Object(a.b)("p",null,"The following shows the complete manifest additions node. You must replace ",Object(a.b)("inlineCode",{parentName:"p"},"APPLICATION_PACKAGE")," with your\nAIR application's Java package name, something like ",Object(a.b)("inlineCode",{parentName:"p"},"air.com.distriqt.test"),".\nGenerally this is your AIR application id prefixed by ",Object(a.b)("inlineCode",{parentName:"p"},"air.")," unless you have specified no air flair in your build options."),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"If any other of our ANEs require the ",Object(a.b)("inlineCode",{parentName:"p"},"FileProvider")," only add ",Object(a.b)("strong",{parentName:"p"},"one")," of the references.\nThe file provider will be shared amongst our extensions.")),Object(a.b)("pre",null,Object(a.b)("code",Object(t.a)({parentName:"pre"},{className:"language-xml"}),'<manifest android:installLocation="auto">\n    <uses-sdk android:minSdkVersion="14" />\n    \n    <uses-permission android:name="android.permission.INTERNET" />\n    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />\n    <uses-permission android:name="android.permission.WAKE_LOCK" />\n    \n    \x3c!-- OPTIONAL --\x3e\n    <uses-permission android:name="android.permission.VIBRATE"/>\n    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />\n    \n    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />\n    <permission android:name="APPLICATION_PACKAGE.permission.C2D_MESSAGE" android:protectionLevel="signature" />\n    <uses-permission android:name="APPLICATION_PACKAGE.permission.C2D_MESSAGE" />\n    \n    <application>\n        <meta-data android:name="com.google.android.gms.version" android:value="@integer/google_play_services_version" />\n\n        <activity android:name="com.google.android.gms.common.api.GoogleApiActivity" \n            android:theme="@android:style/Theme.Translucent.NoTitleBar" \n            android:exported="false"/>\n\n        \n        \x3c!-- AZURE CLOUD MESSAGING --\x3e\n        <service android:name="com.distriqt.extension.pushnotifications.azure.AzureInstanceIDService">\n            <intent-filter>\n                <action android:name="com.google.firebase.INSTANCE_ID_EVENT"/>\n            </intent-filter>\n        </service>\n        <service android:name="com.distriqt.extension.pushnotifications.azure.AzureRegistrationService" android:exported="false" />\n        \n        <service android:name="com.distriqt.extension.pushnotifications.fcm.FcmMessagingService">\n            <intent-filter>\n                <action android:name="com.google.firebase.MESSAGING_EVENT"/>\n            </intent-filter>\n        </service>\n\n\n        \x3c!-- NOTIFICATIONS --\x3e\n        <receiver android:name="com.distriqt.extension.pushnotifications.notifications.receivers.NotificationReceiver">\n            <intent-filter>\n                <action android:name="APPLICATION_PACKAGE.NOTIFICATION_SELECTED" />\n                <action android:name="APPLICATION_PACKAGE.NOTIFICATION_DELETED" />\n                <action android:name="APPLICATION_PACKAGE.NOTIFICATION_ACTION" />\n                <data android:scheme="dtpn" />\n            </intent-filter>\n            <intent-filter>\n                <action android:name="android.intent.action.BOOT_COMPLETED" />\n            </intent-filter>\n        </receiver>\n        <provider\n            android:name="com.distriqt.extension.pushnotifications.content.FileProvider"\n            android:authorities="APPLICATION_PACKAGE.pushnotificationsfileprovider"\n            android:grantUriPermissions="true"\n            android:exported="false">\n            <meta-data \n                android:name="android.support.FILE_PROVIDER_PATHS" \n                android:resource="@xml/distriqt_pushnotifications_paths" />\n        </provider>\n\n\n            \n\n        \x3c!-- FIREBASE CORE --\x3e\n        \x3c!-- analytics --\x3e\n        <receiver\n            android:name="com.google.android.gms.measurement.AppMeasurementReceiver"\n            android:enabled="true">\n            <intent-filter>\n                <action android:name="com.google.android.gms.measurement.UPLOAD"/>\n            </intent-filter>\n        </receiver>\n        <service\n            android:name="com.google.android.gms.measurement.AppMeasurementService"\n            android:enabled="true"\n            android:exported="false"/>\n            \n        \x3c!-- common --\x3e\n        <provider\n            android:authorities="APPLICATION_PACKAGE.firebaseinitprovider"\n            android:name="com.google.firebase.provider.FirebaseInitProvider"\n            android:exported="false"\n            android:initOrder="100" />\n        \n        \x3c!-- iid --\x3e\n        <receiver\n            android:name="com.google.firebase.iid.FirebaseInstanceIdReceiver"\n            android:exported="true"\n            android:permission="com.google.android.c2dm.permission.SEND" >\n            <intent-filter>\n                <action android:name="com.google.android.c2dm.intent.RECEIVE" />\n                <action android:name="com.google.android.c2dm.intent.REGISTRATION" />\n                <category android:name="APPLICATION_PACKAGE" />\n            </intent-filter>\n        </receiver>\n        <receiver\n            android:name="com.google.firebase.iid.FirebaseInstanceIdInternalReceiver"\n            android:exported="false" />\n        <service\n            android:name="com.google.firebase.iid.FirebaseInstanceIdService"\n            android:exported="true">\n            <intent-filter android:priority="-500">\n                <action android:name="com.google.firebase.INSTANCE_ID_EVENT" />\n            </intent-filter>\n        </service>\n        \n        \n        \n    </application>\n    \n</manifest>\n')),Object(a.b)("h3",{id:"multidex-applications"},"MultiDex Applications"),Object(a.b)("p",null,"If you have a large application and are supporting Android 4.x then you will need to ensure you enable your application to correctly support MultiDex to allow the application to be broken up into smaller dex packages."),Object(a.b)("p",null,"This is enabled by default with releases of AIR v25+, except in the Android 4.x case where you need to change the manifest additions for the application tag to match the following and use the ",Object(a.b)("inlineCode",{parentName:"p"},"MultiDexApplication"),"."),Object(a.b)("h4",{id:"using-androidx"},"Using AndroidX"),Object(a.b)("p",null,"This will require the addition of the ",Object(a.b)("inlineCode",{parentName:"p"},"androidx.multidex")," extension which contains the ",Object(a.b)("inlineCode",{parentName:"p"},"androidx.multidex.MultiDexApplication")," implementation."),Object(a.b)("pre",null,Object(a.b)("code",Object(t.a)({parentName:"pre"},{className:"language-xml"}),'<manifest android:installLocation="auto">\n    \x3c!-- PERMISSIONS --\x3e\n\n    <application android:name="androidx.multidex.MultiDexApplication">\n\n        \x3c!-- ACTIVITIES / RECEIVERS / SERVICES --\x3e\n\n    </application>\n</manifest>\n')),Object(a.b)("h1",{id:"ios"},"iOS"),Object(a.b)("p",null,"Azure uses APNS on iOS so you will have to go through the ",Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"../apple/apple-push-notification-service"}),"setup process of APNS"),"\nbefore using Azure."),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"The Microsoft documentation for this process can be found ",Object(a.b)("a",Object(t.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/azure/notification-hubs/notification-hubs-ios-apple-push-notification-apns-get-started"}),"here"))),Object(a.b)("p",null,"APNS requires a few additions to the Info plist and Entitlements section\nof your application to correctly configure your application for push notifications. "),Object(a.b)("p",null,"You should add the listing below to application descriptor iPhone node."),Object(a.b)("p",null,"You must replace the ",Object(a.b)("inlineCode",{parentName:"p"},"BUNDLE_SEED_ID")," and ",Object(a.b)("inlineCode",{parentName:"p"},"BUNDLE_IDENTIFIER")," with the information you\ngathered when setting up your application. Also make sure you set the environment\ncorrectly either using production or development, both are shown in the example\nbelow with the production version commented out. More on this below."),Object(a.b)("pre",null,Object(a.b)("code",Object(t.a)({parentName:"pre"},{className:"language-xml"}),"<iPhone>\n    <InfoAdditions><![CDATA[\n    ]]></InfoAdditions>\n    <requestedDisplayResolution>high</requestedDisplayResolution>\n    <Entitlements><![CDATA[\n        \n        \x3c!-- DEVELOPMENT --\x3e\n        <key>get-task-allow</key>\n        <true/>\n        <key>aps-environment</key>\n        <string>development</string>\n        \n        \x3c!-- PRODUCTION --\x3e\n        \x3c!--\n        <key>get-task-allow</key>\n        <false/>\n        <key>aps-environment</key>\n        <string>production</string>\n        --\x3e\n        \n        <key>application-identifier</key>\n        <string>BUNDLE_SEED_ID.BUNDLE_IDENTIFIER</string>\n        <key>keychain-access-groups</key>\n        <array>\n            <string>BUNDLE_SEED_ID.*</string>\n        </array>\n        \n    ]]></Entitlements>\n</iPhone>\n")),Object(a.b)("p",null,"The first entitlement field is the ",Object(a.b)("inlineCode",{parentName:"p"},"aps-environment"),". This field indicates whether\nwe are using the development or the production environment. It must be either\n",Object(a.b)("inlineCode",{parentName:"p"},"development")," or ",Object(a.b)("inlineCode",{parentName:"p"},"production")," and depends on which configuration you are using.\nIf you are running a debug build you should use development. If you are looking\nto publish the application to the AppStore, you should use production."),Object(a.b)("p",null,"You should have noted the ",Object(a.b)("inlineCode",{parentName:"p"},"BUNDLE_SEED_ID")," (or App ID Prefix) and ",Object(a.b)("inlineCode",{parentName:"p"},"BUNDLE_IDENTIFIER"),"\nwhen you were setting up your application in the iOS developer center.\nThe seed id should be a unique ten character string and the identifier should be\nsimilar to your AIR application id."))}l.isMDXComponent=!0},898:function(e,n,i){"use strict";i.d(n,"a",(function(){return p})),i.d(n,"b",(function(){return m}));var t=i(0),o=i.n(t);function a(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function r(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function s(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?r(Object(i),!0).forEach((function(n){a(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function c(e,n){if(null==e)return{};var i,t,o=function(e,n){if(null==e)return{};var i,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)i=a[t],n.indexOf(i)>=0||(o[i]=e[i]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)i=a[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}var d=o.a.createContext({}),l=function(e){var n=o.a.useContext(d),i=n;return e&&(i="function"==typeof e?e(n):s(s({},n),e)),i},p=function(e){var n=l(e.components);return o.a.createElement(d.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.a.createElement(o.a.Fragment,{},n)}},b=o.a.forwardRef((function(e,n){var i=e.components,t=e.mdxType,a=e.originalType,r=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),p=l(i),b=t,m=p["".concat(r,".").concat(b)]||p[b]||u[b]||a;return i?o.a.createElement(m,s(s({ref:n},d),{},{components:i})):o.a.createElement(m,s({ref:n},d))}));function m(e,n){var i=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var a=i.length,r=new Array(a);r[0]=b;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:t,r[1]=s;for(var d=2;d<a;d++)r[d]=i[d];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,i)}b.displayName="MDXCreateElement"}}]);