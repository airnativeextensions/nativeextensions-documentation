(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[93746],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return k}});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),s=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=s(n),k=i,m=d["".concat(l,".").concat(k)]||d[k]||u[k]||o;return n?a.createElement(m,r(r({ref:t},c),{},{components:n})):a.createElement(m,r({ref:t},c))}));function k(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:i,r[1]=p;for(var s=2;s<o;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},32578:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return r},metadata:function(){return p},toc:function(){return l},default:function(){return c}});var a=n(22122),i=n(19756),o=(n(67294),n(3905)),r={title:"Windows Store Packaging - Method 1"},p={unversionedId:"tutorials/windows-appx-packaging-method1",id:"tutorials/windows-appx-packaging-method1",isDocsHomePage:!1,title:"Windows Store Packaging - Method 1",description:"This method gives the most versatility in editing the final package you create, giving you the ability to make changes to the AppxManifest. Additionally it simplifies testing as you only need to install a single test certificate on your machine.",source:"@site/docs/tutorials/windows-appx-packaging-method1.md",sourceDirName:"tutorials",slug:"/tutorials/windows-appx-packaging-method1",permalink:"/docs/tutorials/windows-appx-packaging-method1",version:"current",frontMatter:{title:"Windows Store Packaging - Method 1"},sidebar:"tutorials",previous:{title:"Windows Store Packaging",permalink:"/docs/tutorials/windows-appx-packaging"},next:{title:"Windows Store Packaging - Method 2",permalink:"/docs/tutorials/windows-appx-packaging-method2"}},l=[{value:"Converting AIR to APPX package",id:"converting-air-to-appx-package",children:[]},{value:"Update Content",id:"update-content",children:[]},{value:"Package into APPX",id:"package-into-appx",children:[]},{value:"Sign",id:"sign",children:[{value:"Create a certificate",id:"create-a-certificate",children:[]},{value:"Sign APPX",id:"sign-appx",children:[]}]},{value:"Example BAT",id:"example-bat",children:[]}],s={toc:l};function c(e){var t=e.components,n=(0,i.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This method gives the most versatility in editing the final package you create, giving you the ability to make changes to the AppxManifest. Additionally it simplifies testing as you only need to install a single test certificate on your machine."),(0,o.kt)("p",null,"This method involves the following steps:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#converting-air-to-appx-package"},"Convert your AIR app to Windows package format (APPX/MSIX)"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#update-content"},"Make any changes to content")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#package-into-appx"},"Package into APPX")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#sign"},"Sign"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#create-a-certificate"},"Create a certificate")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#sign-appx"},"Sign APPX/MSIX"))))),(0,o.kt)("h2",{id:"converting-air-to-appx-package"},"Converting AIR to APPX package"),(0,o.kt)("p",null,"This is the first step of the packaging process across all the methods and is the most important thing the ",(0,o.kt)("inlineCode",{parentName:"p"},"DesktopAppConverter")," does. It involves taking the application and converting it into the correct structure for a Windows package."),(0,o.kt)("p",null,"The result we are looking for here is a directory called ",(0,o.kt)("inlineCode",{parentName:"p"},"PackagedFiles")," that contains the eventual content of your ",(0,o.kt)("inlineCode",{parentName:"p"},"appx")," package."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'DesktopAppConverter.exe \n    -Installer [PATH\\TO\\YOUR\\AIR\\OUTPUT] \n    -AppExecutable YourApplication`.exe \n    -Destination [PATH\\TO\\OUTPUT] \n    -PackageName "[Package/Identity/Name]" \n    -PackageDisplayName "[DISPLAYNAME]" \n    -Publisher "CN=[Package/Identity/Publisher]"\n    -PackagePublisherDisplayName "[Package/Properties/PublisherDisplayName]" \n    -AppDisplayName "[DISPLAYNAME]" \n    -Version [VERSION] \n')),(0,o.kt)("p",null,"This is very similar to the command used in method 2, except we are removing the ",(0,o.kt)("inlineCode",{parentName:"p"},"-MakeAppx")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"-Sign")," options."),(0,o.kt)("h2",{id:"update-content"},"Update Content"),(0,o.kt)("p",null,"At this point you can modify the content of the package before packaging it into the ",(0,o.kt)("inlineCode",{parentName:"p"},"appx")," package."),(0,o.kt)("p",null,"Most commonly you may need to add items into the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppxManifest.xml"),"."),(0,o.kt)("p",null,"We normally copy the first version of this file to another location and edit it as we require, then copy this file back into the ",(0,o.kt)("inlineCode",{parentName:"p"},"PackagedFiles")," directory in our build script."),(0,o.kt)("h2",{id:"package-into-appx"},"Package into APPX"),(0,o.kt)("p",null,"Now that you have your package structure to convert this into an ",(0,o.kt)("inlineCode",{parentName:"p"},"appx")," file we use the ",(0,o.kt)("inlineCode",{parentName:"p"},"MakeAppx")," tool."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"This is the equivalent of the ",(0,o.kt)("inlineCode",{parentName:"em"},"-MakeAppx")," option in the ",(0,o.kt)("inlineCode",{parentName:"em"},"DesktopAppConverter")," tool")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/msix/package/create-app-package-with-makeappx-tool"},"https://docs.microsoft.com/en-us/windows/msix/package/create-app-package-with-makeappx-tool")),(0,o.kt)("p",null,"This tool creates application packages."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'"C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.18362.0\\x64\\makeappx.exe" pack ^\n/d [PATH\\TO\\PackageFiles\\] ^\n/p YourApplication.appx \n')),(0,o.kt)("p",null,"eg: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'"C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.18362.0\\x64\\makeappx.exe" pack ^\n/d C:\\build\\distriqt.airnativeextensions\\PackageFiles\\ ^\n/p distriqt.airnativeextensions.appx \n')),(0,o.kt)("h2",{id:"sign"},"Sign"),(0,o.kt)("p",null,"You will need a ",(0,o.kt)("inlineCode",{parentName:"p"},"pfx")," certificate file in order to sign your ",(0,o.kt)("inlineCode",{parentName:"p"},"appx")," file. "),(0,o.kt)("h3",{id:"create-a-certificate"},"Create a certificate"),(0,o.kt)("p",null,"You will need to create a certificate "),(0,o.kt)("p",null,"For testing we suggest creating a self-signed certificate which you can use for testing your application locally."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/msix/package/create-certificate-package-signing"},"https://docs.microsoft.com/en-us/windows/msix/package/create-certificate-package-signing")),(0,o.kt)("p",null,"For example. to create a test certificate:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'New-SelfSignedCertificate -Type Custom `\n-Subject "CN=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX" `\n-KeyUsage DigitalSignature `\n-FriendlyName "distriqt Pty Ltd" `\n-CertStoreLocation "Cert:\\CurrentUser\\My" `\n-TextExtension @("2.5.29.37={text}1.3.6.1.5.5.7.3.3", "2.5.29.19={text}")\n')),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Note: It is important that the CN (common name) matches the one used in the conversion of your AIR app to APPX. ")),(0,o.kt)("p",null,"This will output a thumbprint which you use to export the certificate:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'$password = ConvertTo-SecureString -String YOUR_CERT_PASSWORD -Force -AsPlainText\nExport-PfxCertificate -cert "Cert:\\CurrentUser\\My\\YOUR_CERT_THUMBPRINT" -FilePath certificate.pfx -Password $password\n')),(0,o.kt)("p",null,"For store release you will need to use the certificate setup for store distribution."),(0,o.kt)("p",null,"At the end of this process you should have a ",(0,o.kt)("inlineCode",{parentName:"p"},"pfx")," certifcate file which you will use to sign your app."),(0,o.kt)("p",null,"If you are using a test certificate, at this point you need to install the certificate onto your machine. "),(0,o.kt)("p",null,"To install the certificate:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'- Double click the `pfx` file\n- Select "Local Machine" for the store location\n- Check the certificate path\n- Enter your certificates password\n- Select "Place all certificates in the following store"\n    - "Browse"\n    - "Trusted Root Certification Authorities"\n')),(0,o.kt)("p",null,"If you don't install the certificate you will get an error about the signature when attempting to install your appx."),(0,o.kt)("h3",{id:"sign-appx"},"Sign APPX"),(0,o.kt)("p",null,"In order to sign the ",(0,o.kt)("inlineCode",{parentName:"p"},"appx")," file generated earlier you will use the ",(0,o.kt)("inlineCode",{parentName:"p"},"SignTool"),"."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"This is the equivalent of the ",(0,o.kt)("inlineCode",{parentName:"em"},"-Sign")," option in the ",(0,o.kt)("inlineCode",{parentName:"em"},"DesktopAppConverter")," tool")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/msix/package/sign-app-package-using-signtool"},"https://docs.microsoft.com/en-us/windows/msix/package/sign-app-package-using-signtool")),(0,o.kt)("p",null,"For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"SignTool sign /fd SHA256 /a /f certificate.pfx /p <Your Password> <File path>.appx\n")),(0,o.kt)("p",null,"You will now have a signed ",(0,o.kt)("inlineCode",{parentName:"p"},"appx")," application package that you can use for test installation or store release (depending on the certificate used). "),(0,o.kt)("h2",{id:"example-bat"},"Example BAT"),(0,o.kt)("p",null,"The following is just some pseudo commands demonstrating how you could automate the above process into a batch file. "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bat"},'@ECHO OFF\nSET BASEDIR=C:\\path\\to\\project\nSET AIR_OUTDIR=%BASEDIR%\\out\\air\\build\nSET UWP_OUTDIR=%BASEDIR%\\out\\uwp\\build\n\n\nECHO ===========================================================\nECHO Converting to UWP application\n\nMKDIR %UWP_BUILDDIR%\n\nDesktopAppConverter.exe -Installer %AIR_BUILDDIR%\\ ^\n-AppExecutable AirApplication.exe ^\n-InstallerArguments "/quiet" ^\n-Destination %UWP_OUTDIR% ^\n-PackageName "distriqt.airnativeextensions" ^\n-PackagePublisherDisplayName "distriqt" ^\n-Publisher "CN=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX" ^\n-Version 1.0.0.0 \n\n\nECHO ===========================================================\nECHO Updating Manifest\n\ncopy AppxManifest.xml %UWP_OUTDIR%\\distriqt.airnativeextensions\\PackageFiles\\AppxManifest.xml\n\n\nECHO ===========================================================\nECHO Creating Appx\n\ndel distriqt.airnativeextensions.appx\n\n"C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.18362.0\\x64\\makeappx.exe" pack ^\n/d %UWP_OUTDIR%\\distriqt.airnativeextensions\\PackageFiles\\ ^\n/p distriqt.airnativeextensions.appx \n\n\nECHO ===========================================================\nECHO Signing Appx\n\n"C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.18362.0\\x64\\signtool.exe" sign /fd SHA256 ^\n/a /f distriqt_selfsigned.pfx /p "p4ssword" ^\ndistriqt.airnativeextensions.appx\n')),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Note: it is possible to automate the removal and install of the appx package for testing as well. "),(0,o.kt)("p",{parentName:"blockquote"},"Have a look at the ",(0,o.kt)("inlineCode",{parentName:"p"},"Remove-AppxPackage")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Add-AppxPackage")," powershell commands.")))}c.isMDXComponent=!0}}]);