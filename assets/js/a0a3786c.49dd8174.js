"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[37100],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var i=t(96540);const o={},s=i.createContext(o);function r(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:n},e.children)}},87676:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/dac_setup-6fec4a966a9214fe0d27903eb0d9f76d.png"},99193:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"windowsstore/windows-desktop-app-converter","title":"Windows-Desktop App Converter","description":"The Desktop App Converter can be used to turn your AIR application into an appex installer for the Windows Store. This is an important process to be able to convert your AIR app into a UWP application.","source":"@site/docs/windowsstore/windows-desktop-app-converter.md","sourceDirName":"windowsstore","slug":"/windowsstore/windows-desktop-app-converter","permalink":"/docs/windowsstore/windows-desktop-app-converter","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Windows-Desktop App Converter","sidebar_label":"Windows-Desktop App Converter"},"sidebar":"windowsstore","previous":{"title":"Windows-Developer Account","permalink":"/docs/windowsstore/windows-developer-account"},"next":{"title":"Products","permalink":"/docs/windowsstore/products"}}');var o=t(74848),s=t(28453);const r={title:"Windows-Desktop App Converter",sidebar_label:"Windows-Desktop App Converter"},a=void 0,l={},c=[{value:"Step 1 Setup the Desktop App Converter",id:"step-1-setup-the-desktop-app-converter",level:2},{value:"Step 2 Convert to Windows Store application",id:"step-2-convert-to-windows-store-application",level:2},{value:"Method 1",id:"method-1",level:3},{value:"Method 2",id:"method-2",level:3},{value:"Step 3 Testing the conversion",id:"step-3-testing-the-conversion",level:2},{value:"Step 4 Submission",id:"step-4-submission",level:2},{value:"External Docs",id:"external-docs",level:2},{value:"Acknowledgements",id:"acknowledgements",level:2}];function p(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"The Desktop App Converter can be used to turn your AIR application into an appex installer for the Windows Store. This is an important process to be able to convert your AIR app into a UWP application."}),"\n",(0,o.jsxs)(n.p,{children:["A brief article on the process can be found ",(0,o.jsx)(n.a,{href:"https://blogs.msdn.microsoft.com/appconsult/2018/03/14/distribute-your-adobe-air-apps-through-the-microsoft-store-with-the-captive-runtime-bundle/",children:"here"})]}),"\n",(0,o.jsxs)(n.p,{children:["More information on the Desktop App Converter can be found ",(0,o.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter",children:"here"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"This process involves the following steps:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Setup the Desktop App Converter"}),"\n",(0,o.jsx)(n.li,{children:"Create an Installer for your AIR application"}),"\n",(0,o.jsxs)(n.li,{children:["Convert to Windows Store application (",(0,o.jsx)(n.code,{children:"appx"}),")"]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["IMPORTANT: For this process to be successful you will need to package your AIR application with the captive runtime using the ",(0,o.jsx)(n.code,{children:"-target bundle"}),". Shared runtime is not supported!"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"step-1-setup-the-desktop-app-converter",children:"Step 1 Setup the Desktop App Converter"}),"\n",(0,o.jsx)(n.p,{children:"To set up the Desktop App Converter (DAC):"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://aka.ms/converter",children:"Download the Desktop App Converter"})," app from the Windows Store."]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["NOTE: If you are not using the installer for you don't need the ",(0,o.jsx)(n.code,{children:"wim"})," file and you can skip to the next step once you have the converter installed"]}),"\n"]}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsxs)(n.li,{children:["Based on your Windows build version (which you can check by opening the Start menu and typing winver), download an appropriate .wim file from the ",(0,o.jsx)(n.a,{href:"https://aka.ms/converterimages",children:"Microsoft Store"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"Run the Desktop App Converter as an administrator on your computer."}),"\n",(0,o.jsxs)(n.li,{children:["In the prompt that appears, run this command: ",(0,o.jsx)(n.code,{children:"Set-ExecutionPolicy bypass"})]}),"\n",(0,o.jsxs)(n.li,{children:["Set up the Desktop App Converter by running this command: ",(0,o.jsx)(n.code,{children:"DesktopAppConverter.exe -Setup -BaseImage .\\BaseImage-1XXXX.wim -Verbose"})]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"TIP: Don\u2019t put the .wim file in a folder that contains other files, such as .iso or .exe files or any other installation files, because it will get copied to your C:\\ drive."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:t(87676).A+"",width:"1785",height:"985"})}),"\n",(0,o.jsx)(n.h2,{id:"step-2-convert-to-windows-store-application",children:"Step 2 Convert to Windows Store application"}),"\n",(0,o.jsxs)(n.p,{children:["The next step is to convert the AIR application (",(0,o.jsx)(n.code,{children:"exe"}),") to a Windows Store application package (",(0,o.jsx)(n.code,{children:"appx"}),")."]}),"\n",(0,o.jsx)(n.h3,{id:"method-1",children:"Method 1"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Create appx from your AIR executable"})}),"\n",(0,o.jsxs)(n.p,{children:["The output from your AIR application will be a directory, containing your ",(0,o.jsx)(n.code,{children:"swf"}),", the ",(0,o.jsx)(n.code,{children:"exe"}),",\nalong with the AIR runtime, ANEs, DLLs, and all the other files packaged with your application."]}),"\n",(0,o.jsxs)(n.p,{children:["This is the simplest method as you can use the output from the AIR SDK directly to create your Windows Store application (",(0,o.jsx)(n.code,{children:"appx"}),")."]}),"\n",(0,o.jsx)(n.p,{children:"It is important that you only have files related to your project in the directory with your executable as anything in this directory will be copied to the final application."}),"\n",(0,o.jsxs)(n.p,{children:["Here we use the ",(0,o.jsx)(n.code,{children:"Installer"})," parameter to point to the root folder of your packaged app files. This is the folder containing the ",(0,o.jsx)(n.code,{children:"AIRApp.exe"})," file generated by AIR."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'DesktopAppConverter.exe \n    -Installer [PATH\\TO\\YOUR\\AIR\\OUTPUT] \n    -AppExecutable AIRApp.exe \n    -Destination [PATH\\TO\\OUTPUT] \n    -PackageName "[Package/Identity/Name]" \n    -PackageDisplayName "[DISPLAYNAME]" \n    -Publisher "CN=[Package/Identity/Publisher]"\n    -PackagePublisherDisplayName "[Package/Properties/PublisherDisplayName]" \n    -AppDisplayName "[DISPLAYNAME]" \n    -Version [VERSION] \n    -MakeAppx \n    -Sign \n    -Verbose\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-Installer"})," points to the root folder of your packaged AIR app files."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-AppExecutable"})," is the filename of your AIR application eg ",(0,o.jsx)(n.code,{children:"AIRApp.exe"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-Destination"})," is where the DAC should produce the output of the command."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-MakeAppx"})," creates an .appx file that is the installation format of a Windows Store application."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"PackageDisplayName"}),": Display package name for the application"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"AppDisplayName"}),": Display name for the application"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-Sign"})," generates a certificate that you can install on your computer to test the generated package. When the final package is submitted to the Store, it is automatically signed by a trusted certificate during the process, so there is no need to do it later when you are ready to publish your application."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-Verbose"})," gives you better information while the conversion is happening."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Your app has a unique identity, assigned by the Store. In order to submit your application you will need to add some parameters setting information about your application from the developer dashboard. Identity details that can be found in the ",(0,o.jsx)(n.strong,{children:"App identity"})," section of your application in the developer dashboard. This information is required to correctly package your application for store submission however can be dummy values for local testing:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"PackageName"}),": Package/Identity/Name"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Publisher"}),": Package/Identity/Publisher"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"PackagePublisherDisplayName"}),": Package/Properties/PublisherDisplayName"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"For example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'DesktopAppConverter.exe \n    -Installer C:\\work\\windowsstore\\example\\starling\\out\\TestWindowsStore\n    -AppExecutable TestWindowsStore.exe \n    -Destination C:\\work\\windowsstore\\example\\starling\\final\n    -PackageName "distriqt.airnativeextensions" \n    -Publisher "CN=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX" \n    -PackagePublisherDisplayName "distriqt" \n    -PackageDisplayName "airnativeextensions" \n    -AppDisplayName "airnativeextensions" \n    -Version 1.0.0.0 \n    -MakeAppx \n    -Sign \n    -Verbose\n'})}),"\n",(0,o.jsx)(n.h3,{id:"method-2",children:"Method 2"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Using an Installer for your AIR application"})}),"\n",(0,o.jsxs)(n.p,{children:["You may already have an installer for your AIR application and wish to use this to create your Windows Store application (",(0,o.jsx)(n.code,{children:"appx"}),")."]}),"\n",(0,o.jsxs)(n.p,{children:["The output from your AIR application will be a directory, containing your ",(0,o.jsx)(n.code,{children:"swf"}),", the ",(0,o.jsx)(n.code,{children:"exe"}),",\nalong with the AIR runtime, any ANEs, and all the other files packaged with your application."]}),"\n",(0,o.jsx)(n.p,{children:"You will then need to create an installer from this directory using one of the many windows\ninstaller tools, eg:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"http://wixtoolset.org/",children:"Wix"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"http://wixedit.sourceforge.net",children:"WixEdit"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"http://www.jrsoftware.org/isinfo.php",children:"Inno Setup"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Tutorials:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"http://www.adobe.com/devnet/air/articles/customize-setup-for-AIR-app-with-captive-runtime.html",children:"Generating a Windows installer"})}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["You now convert your AIR application installer to a Windows Store application (",(0,o.jsx)(n.code,{children:"appx"}),"). It is important that you only have files related to your project in the directory with your installer (i.e. ",(0,o.jsx)(n.code,{children:"C:\\dac\\installer"})," below) as anything in this directory will be copied to the virtual file system to run the conversion."]}),"\n",(0,o.jsx)(n.p,{children:"To run the conversion, use the following command, replacing the [] items to match your setup:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'DesktopAppConverter.exe \n    -Installer [PATH\\TO\\YOUR\\AIR\\INSTALLER] \n    -InstallerArguments "[INSTALLEROPTIONS]" \n    -Destination [PATH\\TO\\OUTPUT] \n    -PackageName "[Package/Identity/Name]" \n    -Publisher "CN=[Package/Identity/Publisher]" \n    -PackagePublisherDisplayName "[Package/Properties/PublisherDisplayName]" \n    -PackageDisplayName "[DISPLAYNAME]" \n    -AppDisplayName "[DISPLAYNAME]" \n    -Version [VERSION] \n    -MakeAppx \n    -Sign \n    -Verbose\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-Installer"})," points to the installer that you want to use."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-InstallerArguments"})," is where you must specify the parameter that triggers the unattended setup procedure because DAC can only work with silent installers."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-Destination"})," is where the DAC should produce the output of the command."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-MakeAppx"})," creates an .appx file that is the installation format of a Windows Store application."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"PackageDisplayName"}),": Display package name for the application"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"AppDisplayName"}),": Display name for the application"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-Sign"})," generates a certificate that you can install on your computer to test the generated package. When the final package is submitted to the Store, it is automatically signed by a trusted certificate during the process, so there is no need to do it later when you are ready to publish your application."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-Verbose"})," gives you better information while the conversion is happening."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Your app has a unique identity, assigned by the Store. In order to submit your application you will need to add some parameters setting information about your application from the developer dashboard. Identity details that can be found in the ",(0,o.jsx)(n.strong,{children:"App identity"})," section of your application in the developer dashboard. This information is required to correctly package your application for store submission however can be dummy values for local testing:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"PackageName"}),": Package/Identity/Name"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Publisher"}),": Package/Identity/Publisher"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"PackagePublisherDisplayName"}),": Package/Properties/PublisherDisplayName"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"For example with our msi generated using Wix:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'DesktopAppConverter.exe \n    -Installer C:\\dac\\installer\\TestDistriqt.msi\n    -InstallerArguments "/quiet" \n    -Destination C:\\dac\\final\n    -PackageName "distriqt.airnativeextensions" \n    -Publisher "CN=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX" \n    -PackagePublisherDisplayName "distriqt" \n    -PackageDisplayName "airnativeextensions" \n    -AppDisplayName "airnativeextensions" \n    -Version 1.0.0.0 \n    -MakeAppx \n    -Sign \n    -Verbose\n'})}),"\n",(0,o.jsx)(n.h2,{id:"step-3-testing-the-conversion",children:"Step 3 Testing the conversion"}),"\n",(0,o.jsxs)(n.p,{children:["You can now install the ",(0,o.jsx)(n.code,{children:"appx"})," application on your local machine. In order to do this you will need to install the certificate that was used to sign the application. This will called ",(0,o.jsx)(n.code,{children:"auto-generated.cer"})," and be located in the output path alongside your ",(0,o.jsx)(n.code,{children:"appx"})," application file."]}),"\n",(0,o.jsx)(n.p,{children:"To install the certificate:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Double click cer file"}),"\n",(0,o.jsx)(n.li,{children:'Select "Install Certificate..."'}),"\n",(0,o.jsx)(n.li,{children:'Select "Local Machine"'}),"\n",(0,o.jsxs)(n.li,{children:['Select "Place all certificates in the following store"',"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:'"Browse"'}),"\n",(0,o.jsx)(n.li,{children:'"Trusted Root Certification Authorities"'}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["You can now install the application by double clicking the ",(0,o.jsx)(n.code,{children:"appx"})," to launch the installer. This will install your application locally and have access to the UWP platform."]}),"\n",(0,o.jsx)(n.h2,{id:"step-4-submission",children:"Step 4 Submission"}),"\n",(0,o.jsxs)(n.p,{children:["You should now be able to use the ",(0,o.jsx)(n.code,{children:"appx"})," file to submit to the store."]}),"\n",(0,o.jsx)(n.p,{children:"You must have acquired permission to submit Desktop Bridge applications before this step. If you haven't you will see the following error:"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Package acceptance validation error: Your developer account doesn't have permission to submit apps converted with the Desktop Bridge at this time. ",(0,o.jsx)(n.a,{href:"https://aka.ms/desktopbridgeforwindowsstore",children:"https://aka.ms/desktopbridgeforwindowsstore"})]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"external-docs",children:"External Docs"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Package an app using the Desktop App Converter (Desktop Bridge) ",(0,o.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter",children:"https://docs.microsoft.com/en-us/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter"})]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"acknowledgements",children:"Acknowledgements"}),"\n",(0,o.jsxs)(n.p,{children:["This documentation is based on the ",(0,o.jsx)(n.a,{href:"https://microsoft.github.io/techcasestudies/desktop%20bridge/2017/06/08/e-pity.html",children:"e-pity case study"})]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}}}]);