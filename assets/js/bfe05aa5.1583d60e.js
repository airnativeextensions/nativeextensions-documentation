"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[6302],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return m}});var s=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,s,i=function(e,n){if(null==e)return{};var t,s,i={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=s.createContext({}),c=function(e){var n=s.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=c(e.components);return s.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},u=s.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=c(t),m=i,g=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return t?s.createElement(g,a(a({ref:n},p),{},{components:t})):s.createElement(g,a({ref:n},p))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,a=new Array(r);a[0]=u;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,a[1]=o;for(var c=2;c<r;c++)a[c]=t[c];return s.createElement.apply(null,a)}return s.createElement.apply(null,t)}u.displayName="MDXCreateElement"},24865:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return o},metadata:function(){return c},toc:function(){return d}});var s=t(87462),i=t(63366),r=(t(67294),t(3905)),a=["components"],o={title:"System Settings",sidebar_label:"System Settings"},l=void 0,c={unversionedId:"permissions/system-settings",id:"permissions/system-settings",title:"System Settings",description:"Some permissions are controlled through the system settings dialogs and cannot be requested through the normal permission request process.",source:"@site/docs/permissions/system-settings.md",sourceDirName:"permissions",slug:"/permissions/system-settings",permalink:"/docs/permissions/system-settings",draft:!1,tags:[],version:"current",frontMatter:{title:"System Settings",sidebar_label:"System Settings"},sidebar:"permissions",previous:{title:"Requesting Access",permalink:"/docs/permissions/requesting-access"},next:{title:"Migrating to AndroidX",permalink:"/docs/permissions/migrating-to-androidx"}},p={},d=[{value:"Write Settings",id:"write-settings",level:2},{value:"All Files Permission",id:"all-files-permission",level:2},{value:"Request All files access",id:"request-all-files-access",level:3},{value:"Request App All files access",id:"request-app-all-files-access",level:3},{value:"Check Granted",id:"check-granted",level:3}],u={toc:d};function m(e){var n=e.components,t=(0,i.Z)(e,a);return(0,r.kt)("wrapper",(0,s.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Some permissions are controlled through the system settings dialogs and cannot be requested through the normal permission request process. "),(0,r.kt)("h2",{id:"write-settings"},"Write Settings"),(0,r.kt)("p",null,"The permission to read and write to the system settings (",(0,r.kt)("inlineCode",{parentName:"p"},"android.permission.WRITE_SETTINGS"),") from Android API 23 now requires a user to explicitly grant this permission to an application through a permission management screen."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<uses-permission android:name="android.permission.WRITE_SETTINGS" />\n')),(0,r.kt)("p",null,"You cannot request this permission but you can check the current state and show the screen for the user to change the setting."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"This permission is required for when you need to change system settings, such as the screen brightness as performed in the Application extension.")),(0,r.kt)("p",null,"To check the state of the permission use the ",(0,r.kt)("inlineCode",{parentName:"p"},"canWrite")," property on the ",(0,r.kt)("inlineCode",{parentName:"p"},"settings"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (Permissions.instance.settings.canWrite)\n{\n    // App can write to system settings\n}\n")),(0,r.kt)("p",null,"To display the permission management screen for the user to change this state, call the ",(0,r.kt)("inlineCode",{parentName:"p"},"showManageSettingsScreen()")," method:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"Permissions.instance.settings.showManageSettingsScreen();\n")),(0,r.kt)("p",null,"There is also an event dispatched (",(0,r.kt)("inlineCode",{parentName:"p"},"SettingsEvent.MANAGE_SETTINGS_CLOSED"),") when this screen is closed:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"Permissions.instance.settings.addEventListener( \n    SettingsEvent.MANAGE_SETTINGS_CLOSED, \n    manageSettingsClosedHandler\n);\n\nPermissions.instance.settings.showManageSettingsScreen();\n\nfunction manageSettingsClosedHandler( event:SettingsEvent ):void \n{\n    // screen closed\n}\n")),(0,r.kt)("h2",{id:"all-files-permission"},"All Files Permission"),(0,r.kt)("p",null,"The majority of apps that require shared storage access can follow the best practices for sharing media files and sharing non-media files. However, some apps have a core use case that requires broad access of files on a device, but cannot do so efficiently using the privacy-friendly storage best practices. Android provides a special app access called All files access for these situations."),(0,r.kt)("p",null,"For more information on this permission see the Android documentation section on ",(0,r.kt)("a",{parentName:"p",href:"https://developer.android.com/training/data-storage/manage-all-files"},"managing all files"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"For API versions < 30 don't require this additional permission and the following will always fail and ",(0,r.kt)("inlineCode",{parentName:"p"},"isExternalStorageManager()")," will always return ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," indicating the application already has access.")),(0,r.kt)("h3",{id:"request-all-files-access"},"Request All files access"),(0,r.kt)("p",null,"An app can request All files access from the user by doing the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Declare the ",(0,r.kt)("inlineCode",{parentName:"li"},"android.permission.MANAGE_EXTERNAL_STORAGE")," permission in the manifest.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<uses-permission android:name="android.permission.MANAGE_EXTERNAL_STORAGE" />\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Use the ",(0,r.kt)("inlineCode",{parentName:"li"},"ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION")," intent action to direct users to a system settings page where they can enable the following option for your app: Allow access to manage all files.")),(0,r.kt)("p",null,"With this extension you can trigger the ",(0,r.kt)("inlineCode",{parentName:"p"},"ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION")," by calling:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"Permissions.instance.settings\n    .showManageAllFileAccessPermission();\n")),(0,r.kt)("p",null,"This will return ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," if the intent was found and launched."),(0,r.kt)("p",null,"Additionally you can listen for the ",(0,r.kt)("inlineCode",{parentName:"p"},"SettingsEvent.MANAGE_ALL_FILES_ACCESS_PERMISSION_CLOSED")," event to be notified of when the dialog is closed and focus returned to your application."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},'Permissions.instance.settings.addEventListener( \n    SettingsEvent.MANAGE_ALL_FILES_ACCESS_PERMISSION_CLOSED, \n    closedHandler \n);\n\nfunction closedHandler( event:SettingsEvent ):void\n{\n    trace( "closed" );\n}\n')),(0,r.kt)("h3",{id:"request-app-all-files-access"},"Request App All files access"),(0,r.kt)("p",null,"You can also trigger the ",(0,r.kt)("inlineCode",{parentName:"p"},"ACTION_MANAGE_APP_ALL_FILES_ACCESS_PERMISSION")," intent which will direct the user straight to your application setting if available. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"Permissions.instance.settings\n    .showManageAppAllFileAccessPermission();\n")),(0,r.kt)("p",null,"This will return ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," if the intent was found and launched."),(0,r.kt)("p",null,"Additionally you can listen for the ",(0,r.kt)("inlineCode",{parentName:"p"},"SettingsEvent.MANAGE_APP_ALL_FILES_ACCESS_PERMISSION_CLOSED")," event to be notified of when the dialog is closed and focus returned to your application."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},'Permissions.instance.settings.addEventListener( \n    SettingsEvent.MANAGE_APP_ALL_FILES_ACCESS_PERMISSION_CLOSED, \n    closedHandler \n);\n\nfunction closedHandler( event:SettingsEvent ):void\n{\n    trace( "closed" );\n}\n')),(0,r.kt)("h3",{id:"check-granted"},"Check Granted"),(0,r.kt)("p",null,"To determine whether your app has been granted the ",(0,r.kt)("inlineCode",{parentName:"p"},"MANAGE_EXTERNAL_STORAGE")," permission, call ",(0,r.kt)("inlineCode",{parentName:"p"},"Environment.isExternalStorageManager()"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-actionscript"},"var granted:Boolean = \n    Permissions.instance.environment.isExternalStorageManager();\n")))}m.isMDXComponent=!0}}]);