(window.webpackJsonp=window.webpackJsonp||[]).push([[563],{1266:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/amazon-testing-download-cbaf7b4dce4a7eda734dfe72bee948e2.png"},618:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return l})),a.d(t,"metadata",(function(){return i})),a.d(t,"rightToc",(function(){return b})),a.d(t,"default",(function(){return p}));var n=a(2),r=(a(0),a(854));const l={title:"Testing Amazon In-App Purchasing",sidebar_label:"Testing"},i={unversionedId:"inappbilling/amazon/testing",id:"inappbilling/amazon/testing",isDocsHomePage:!1,title:"Testing Amazon In-App Purchasing",description:"Amazon In-App Purchasing",source:"@site/docs/inappbilling/amazon/testing.md",slug:"/inappbilling/amazon/testing",permalink:"/docs/inappbilling/amazon/testing",version:"current",sidebar_label:"Testing",sidebar:"inappbilling",previous:{title:"Amazon In-App Purchasing",permalink:"/docs/inappbilling/amazon/amazon-in-app-purchasing"},next:{title:"Huawei AppGallery",permalink:"/docs/inappbilling/huawei/huawei-appgallery"}},b=[{value:"Amazon In-App Purchasing",id:"amazon-in-app-purchasing",children:[{value:"Install and Configure the App Tester",id:"install-and-configure-the-app-tester",children:[]},{value:"Create a JSON Data File",id:"create-a-json-data-file",children:[]},{value:"Verify IAP Items",id:"verify-iap-items",children:[]},{value:"Next Steps",id:"next-steps",children:[]}]},{value:"Set Installer Package",id:"set-installer-package",children:[]},{value:"Amazon Terms",id:"amazon-terms",children:[]}],o={rightToc:b};function p({components:e,...t}){return Object(r.b)("wrapper",Object(n.a)({},o,t,{components:e,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"amazon-in-app-purchasing"},"Amazon In-App Purchasing"),Object(r.b)("p",null,"Amazon does not provide a complete \"sandbox\" type environment for testing like Google's In-App Billing and Apple's In-App Purchases.  "),Object(r.b)("p",null,"Instead you will need to install and configure the ",Object(r.b)("strong",{parentName:"p"},"App Tester")," application and utilise the app to intercept IAP calls."),Object(r.b)("h3",{id:"install-and-configure-the-app-tester"},"Install and Configure the App Tester"),Object(r.b)("p",null,"App Tester allows you to unit test the In-App Purchasing (IAP) functionality of your app in sandbox mode before you submit the app for publication. You download App Tester from the Amazon Appstore onto the same Android device as your app. The App Tester simulates the production environment. You run IAP-related test cases on your app, and App Tester generates API responses (that you configure using a JSON file)."),Object(r.b)("p",null,"The easiest way is to install the app from the Amazon Appstore"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"On your Android mobile device, start the Amazon Appstore app."),Object(r.b)("li",{parentName:"ul"},'Search for "Amazon App Tester".'),Object(r.b)("li",{parentName:"ul"},'Select the "Amazon App Tester" app. (Do not select the Web App Tester, which is a different app.)'),Object(r.b)("li",{parentName:"ul"},"Tap through the prompts to download and install the app.")),Object(r.b)("h3",{id:"create-a-json-data-file"},"Create a JSON Data File"),Object(r.b)("p",null,"The App Tester responds to API calls using data stored in a JavaScript Object Notation (JSON) text file. The file contains purchase data for the IAP items."),Object(r.b)("p",null,"You can automatically create the JSON file through the Apps & Games Developer Portal."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"In a web browser, go to the your app's page on the Apps & Games Developer Portal."),Object(r.b)("li",{parentName:"ul"},"Add your IAP purchasable items to your app, if you have not already done so."),Object(r.b)("li",{parentName:"ul"},"Export the IAPs to JSON by selecting: ",Object(r.b)("strong",{parentName:"li"},"Export Multiple IAPs / JSON")),Object(r.b)("li",{parentName:"ul"},"Click the link to download your JSON Data File. "),Object(r.b)("li",{parentName:"ul"},'Name the downloaded file "amazon.sdktester.json".'),Object(r.b)("li",{parentName:"ul"},"Copy the file to ",Object(r.b)("inlineCode",{parentName:"li"},"/mnt/sdcard/")," folder in your device file system.")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"adb push amazon.sdktester.json /mnt/sdcard/amazon.sdktester.json\n")),Object(r.b)("p",null,"The location of the download link is as in the following screenshot:"),Object(r.b)("p",null,Object(r.b)("img",{src:a(1266).default})),Object(r.b)("h3",{id:"verify-iap-items"},"Verify IAP Items"),Object(r.b)("p",null,"You can easily review the contents of the JSON file. From the App Tester main menu, tap the ",Object(r.b)("strong",{parentName:"p"},"IAP Items in JSON File")," option to display a human-readable list of the item data in the JSON file."),Object(r.b)("h3",{id:"next-steps"},"Next Steps"),Object(r.b)("p",null,"Familiarize yourself with the App Tester tool and the test options for IAP:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Read the ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://developer.amazon.com/docs/in-app-purchasing/iap-app-tester-user-guide.html"}),"App Tester User Guide")," to learn how to use this tool."),Object(r.b)("li",{parentName:"ol"},"See ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://developer.amazon.com/docs/in-app-purchasing/iap-design-test-cases.html"}),"Design and Execute Test Cases for IAP")," for ideas on how to test your IAP functionality.")),Object(r.b)("p",null,"For more information on any of the processes here see the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://developer.amazon.com/docs/in-app-purchasing/iap-install-and-configure-app-tester.html"}),"Amazon documentation"),"."),Object(r.b)("h2",{id:"set-installer-package"},"Set Installer Package"),Object(r.b)("p",null,"If you are using a non-Amazon device with the Amazon App-Store installed to test you must set the correct installer package in order that the extension can correctly detect that the amazon service is supported. "),Object(r.b)("p",null,"When installing your application you will need to use the following commands using the ",Object(r.b)("inlineCode",{parentName:"p"},"adb")," terminal command:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),'adb push YOURAPP.apk /data/local/tmp/app.apk\nadb shell pm install -i "com.amazon.venezia" -r /data/local/tmp/app.apk\nadb shell rm /data/local/tmp/app.apk\n')),Object(r.b)("p",null,"Change ",Object(r.b)("inlineCode",{parentName:"p"},"YOURAPP.apk")," to be the path to your application. This command will set the installer package name to be the Amazon AppStore's package name ",Object(r.b)("inlineCode",{parentName:"p"},"com.amazon.venezia"),"."),Object(r.b)("p",null,"If you don't set this and rely on the default detection then you will find debugging may default to the Google Play Billing implementation."),Object(r.b)("h2",{id:"amazon-terms"},"Amazon Terms"),Object(r.b)("p",null,"In order to understand the difference between our implementation and the standard Amazon documentation the table belows shows where the associated Amazon methods are called by the extension. Most have a direct relationship between the Amazon call and the extension however there are some minor differences. "),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Amazon Method"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Extension Method"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"registerListener")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"setup"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"getProductData")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"getProducts"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"getPurchaseUpdates")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"getPurchases")," & ",Object(r.b)("inlineCode",{parentName:"td"},"restorePurchases"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"purchase")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"makePurchase"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"notifyFulfillment")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"entitlement and subscription products"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"finishPurchase"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"consumable products"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"consumePurchase"))))),Object(r.b)("p",null,"Listener callbacks are mapped to extension events depending on the triggered call:"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Amazon Listener Callback"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Extension Event(s)"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onProductDataResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"success"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"InAppBillingEvent.PRODUCTS_LOADED"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onProductDataResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"invalid SKU"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"InAppBillingEvent.PRODUCT_INVALID"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onProductDataResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"failed"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"InAppBillingEvent.PRODUCTS_FAILED"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onPurchaseResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"success"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"PurchaseEvent.PURCHASES_UPDATED"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onPurchaseResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"failed"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"PurchaseEvent.PURCHASE_FAILED"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onPurchaseUpdatesResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"getPurchases")," > success"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"PurchaseEvent.GET_PURCHASES_COMPLETE"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onPurchaseUpdatesResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"getPurchases")," > failed"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"PurchaseEvent.GET_PURCHASES_FAILED"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onPurchaseUpdatesResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"restorePurchases")," > success"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"InAppBillingEvent.RESTORE_PURCHASES_SUCCESS"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"onPurchaseUpdatesResponse")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"restorePurchases")," > failed"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"InAppBillingEvent.RESTORE_PURCHASES_FAILED"))))),Object(r.b)("p",null,"This is provided only as a guide of the implementation to better utilise the Amazon documentation. The exact implementation is more complex."))}p.isMDXComponent=!0},854:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return u}));var n=a(0),r=a.n(n);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=r.a.createContext({}),c=function(e){var t=r.a.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):b(b({},t),e)),a},s=function(e){var t=c(e.components);return r.a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,i=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),s=c(a),m=n,u=s["".concat(i,".").concat(m)]||s[m]||d[m]||l;return a?r.a.createElement(u,b(b({ref:t},p),{},{components:a})):r.a.createElement(u,b({ref:t},p))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,i=new Array(l);i[0]=m;var b={};for(var o in t)hasOwnProperty.call(t,o)&&(b[o]=t[o]);b.originalType=e,b.mdxType="string"==typeof e?e:n,i[1]=b;for(var p=2;p<l;p++)i[p]=a[p];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);