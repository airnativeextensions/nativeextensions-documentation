(window.webpackJsonp=window.webpackJsonp||[]).push([[521],{578:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return a})),r.d(t,"metadata",(function(){return c})),r.d(t,"rightToc",(function(){return s})),r.d(t,"default",(function(){return p}));var n=r(2),o=r(6),i=(r(0),r(885)),a={title:"Auth - Provider - Microsoft",sidebar_label:"Microsoft"},c={unversionedId:"firebase/auth/provider/microsoft",id:"firebase/auth/provider/microsoft",isDocsHomePage:!1,title:"Auth - Provider - Microsoft",description:"Authenticate Using Microsoft",source:"@site/docs/firebase/auth/provider/microsoft.md",slug:"/firebase/auth/provider/microsoft",permalink:"/docs/firebase/auth/provider/microsoft",version:"current",sidebar_label:"Microsoft",sidebar:"firebase",previous:{title:"Auth - Provider - GitHub",permalink:"/docs/firebase/auth/provider/github"},next:{title:"Auth - Provider - Apple",permalink:"/docs/firebase/auth/provider/apple"}},s=[{value:"Before you begin",id:"before-you-begin",children:[]},{value:"Handle the sign-in flow with the Firebase SDK",id:"handle-the-sign-in-flow-with-the-firebase-sdk",children:[]},{value:"Next Steps",id:"next-steps",children:[]}],l={rightToc:s};function p(e){var t=e.components,r=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},l,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"authenticate-using-microsoft"},"Authenticate Using Microsoft"),Object(i.b)("p",null,"You can let your users authenticate with Firebase using OAuth providers like Microsoft Azure Active Directory by integrating web-based generic OAuth Login into your app using the Firebase SDK to carry out the end to end sign-in flow."),Object(i.b)("h2",{id:"before-you-begin"},"Before you begin"),Object(i.b)("p",null,"To sign in users using Microsoft accounts (Azure Active Directory and personal Microsoft accounts), you must first enable Microsoft as a sign-in provider for your Firebase project:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Add Firebase to your project."),Object(i.b)("li",{parentName:"ol"},"In the ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://console.firebase.google.com/"}),"Firebase console"),", open the Auth section."),Object(i.b)("li",{parentName:"ol"},"On the Sign in method tab, enable the Microsoft provider."),Object(i.b)("li",{parentName:"ol"},"Add the Client ID and Client Secret from that provider's developer console to the provider configuration:")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"To register a Microsoft OAuth client, follow the instructions in ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-v2-register-an-app"}),"Quickstart: Register an app with the Azure Active Directory v2.0 endpoint"),". Note that this endpoint supports sign-in using Microsoft personal accounts as well as Azure Active Directory accounts. ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview"}),"Learn more")," about Azure Active Directory v2.0."),Object(i.b)("li",{parentName:"ul"},"When registering apps with these providers, be sure to register the ",Object(i.b)("inlineCode",{parentName:"li"},"*.firebaseapp.com")," domain for your project as the redirect domain for your app.")),Object(i.b)("ol",{start:5},Object(i.b)("li",{parentName:"ol"},"Click Save."),Object(i.b)("li",{parentName:"ol"},"If you haven't yet specified your app's SHA-1 fingerprint, do so from the ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://console.firebase.google.com/project/_/settings/general/"}),"Settings page")," of the Firebase console. Refer to ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://developers.google.com/android/guides/client-auth"}),"Authenticating Your Client")," for details on how to get your app's SHA-1 fingerprint.")),Object(i.b)("h2",{id:"handle-the-sign-in-flow-with-the-firebase-sdk"},"Handle the sign-in flow with the Firebase SDK"),Object(i.b)("p",null,"If you are building an Android app, the easiest way to authenticate your users with Firebase using their Microsoft accounts is to handle the entire sign-in flow with the Firebase SDK."),Object(i.b)("p",null,"To handle the sign-in flow with the Firebase Android SDK, follow these steps:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Construct an instance of an ",Object(i.b)("inlineCode",{parentName:"li"},"OAuthProvider")," with the provider ID ",Object(i.b)("inlineCode",{parentName:"li"},"microsoft.com"),".")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-actionscript"}),'var provider:OAuthProvider = new OAuthProvider( "microsoft.com" );\n')),Object(i.b)("ol",{start:2},Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Optional"),": Specify additional custom OAuth parameters that you want to send with the OAuth request.")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-actionscript"}),'// Force re-consent.\nprovider.addCustomParameter("prompt", "consent");\n\n// Target specific email with login hint.\nprovider.addCustomParameter("login_hint", "user@firstadd.onmicrosoft.com");\n')),Object(i.b)("p",null,"For the parameters Microsoft supports, see the ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v1-protocols-oauth-code"}),"Microsoft OAuth documentation"),". Note that you can't pass Firebase-required parameters with ",Object(i.b)("inlineCode",{parentName:"p"},"setCustomParameters()"),". These parameters are client_id, response_type, redirect_uri, state, scope and response_mode."),Object(i.b)("p",null,'To allow only users from a particular Azure AD tenant to sign into the application, either the friendly domain name of the Azure AD tenant or the tenant\'s GUID identifier can be used. This can be done by specifying the "tenant" field in the custom parameters object.'),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-actionscript"}),'// Optional "tenant" parameter in case you are using an Azure AD tenant.\n// eg. \'8eaef023-2b34-4da1-9baa-8bc8c9d6a490\' or \'contoso.onmicrosoft.com\'\n// or "common" for tenant-independent tokens.\n// The default value is "common".\nprovider.addCustomParameter("tenant", "TENANT_ID");\n')),Object(i.b)("ol",{start:3},Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Optional"),": Specify additional OAuth 2.0 scopes beyond basic profile that you want to request from the authentication provider.")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-actionscript"}),'provider.setScopes([ "mail.read", "calendars.read" ]);\n')),Object(i.b)("p",null,"To learn more, refer to the ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent"}),"Microsoft permissions and consent documentation"),"."),Object(i.b)("ol",{start:4},Object(i.b)("li",{parentName:"ol"},"Authenticate with Firebase using the OAuth provider object by calling ",Object(i.b)("inlineCode",{parentName:"li"},"startSignInWithProvider")," and awaiting the ",Object(i.b)("inlineCode",{parentName:"li"},"FirebaseAuthEvent.SIGNIN_WITH_PROVIDER_COMPLETE"),". Note that unlike other FirebaseAuth operations, this will take control of your UI by opening a Custom Chrome Tab. ")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-actionscript"}),"FirebaseAuth.service.startSignInWithProvider( provider );\n")),Object(i.b)("p",null,"This completes with the ",Object(i.b)("inlineCode",{parentName:"p"},"FirebaseAuthEvent.SIGNIN_WITH_PROVIDER_COMPLETE")," event:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-actionscript"}),'FirebaseAuth.service.addEventListener(\n        FirebaseAuthEvent.SIGNIN_WITH_PROVIDER_COMPLETE,\n        startSignInWithProvider_completeHandler\n);\n\nFirebaseAuth.service.startSignInWithProvider( provider );\n\nfunction startSignInWithProvider_completeHandler( event:FirebaseAuthEvent ):void\n{\n    trace( "startSignInWithProvider_completeHandler():complete:" + event.success );\n}\n')),Object(i.b)("h2",{id:"next-steps"},"Next Steps"),Object(i.b)("p",null,"Once you have completed the authentication with Firebase you should expect the normal ",Object(i.b)("inlineCode",{parentName:"p"},"FirebaseAuthEvent.AUTHSTATE_CHANGED")," event indicating that a user was authenticated and then you will be able to retrieve the user's details using the standard ",Object(i.b)("inlineCode",{parentName:"p"},"getCurrentUser()")," where one of the providers will be the Microsoft details."),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-actionscript"}),'var user:FirebaseUser = FirebaseAuth.service.getCurrentUser();\nif (user != null)\n{\n    log( "identifier:  " + user.identifier );\n    log( "displayName: " + user.displayName );\n    log( "email:       " + user.email );\n    \n    for each (var info:UserInfo in user.providers)\n    {\n        log( "------------------" );\n        log( "\\tprovider:    " + info.providerId );\n        log( "\\tidentifier:  " + info.identifier );\n        log( "\\tdisplayName: " + info.displayName );\n        log( "\\temail:       " + info.email );\n        log( "\\tphone:       " + info.phoneNumber );\n    }\n}\n')),Object(i.b)("p",null,"Unlike other providers supported by Firebase Auth, Microsoft does not provide a photo URL and instead, the binary data for a profile photo has to be requested via Microsoft Graph API."))}p.isMDXComponent=!0},885:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return h}));var n=r(0),o=r.n(n);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=o.a.createContext({}),p=function(e){var t=o.a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):c(c({},t),e)),r},b=function(e){var t=p(e.components);return o.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},d=o.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,a=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=p(r),d=n,h=b["".concat(a,".").concat(d)]||b[d]||u[d]||i;return r?o.a.createElement(h,c(c({ref:t},l),{},{components:r})):o.a.createElement(h,c({ref:t},l))}));function h(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,a=new Array(i);a[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:n,a[1]=c;for(var l=2;l<i;l++)a[l]=r[l];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,r)}d.displayName="MDXCreateElement"}}]);