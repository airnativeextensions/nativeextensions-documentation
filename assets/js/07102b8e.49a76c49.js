"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[42115],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return p}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),d=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},l=function(e){var t=d(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),m=d(n),p=a,v=m["".concat(s,".").concat(p)]||m[p]||u[p]||o;return n?r.createElement(v,c(c({ref:t},l),{},{components:n})):r.createElement(v,c({ref:t},l))}));function p(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,c=new Array(o);c[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,c[1]=i;for(var d=2;d<o;d++)c[d]=n[d];return r.createElement.apply(null,c)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},97876:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return i},metadata:function(){return s},toc:function(){return d},default:function(){return u}});var r=n(87462),a=n(63366),o=(n(67294),n(3905)),c={title:"Firestore - Add Data",sidebar_label:"Add Data"},i=void 0,s={unversionedId:"firebase/firestore/add-data",id:"firebase/firestore/add-data",isDocsHomePage:!1,title:"Firestore - Add Data",description:"Add data",source:"@site/docs/firebase/firestore/add-data.md",sourceDirName:"firebase/firestore",slug:"/firebase/firestore/add-data",permalink:"/docs/firebase/firestore/add-data",tags:[],version:"current",frontMatter:{title:"Firestore - Add Data",sidebar_label:"Add Data"},sidebar:"firebase",previous:{title:"Add the extension",permalink:"/docs/firebase/firestore/add-the-extension"},next:{title:"Transactions and batched writes",permalink:"/docs/firebase/firestore/transactions-and-batched-writes"}},d=[{value:"Add data",id:"add-data",children:[{value:"Set a document",id:"set-a-document",children:[]},{value:"Data types",id:"data-types",children:[]},{value:"Custom objects",id:"custom-objects",children:[]},{value:"Add a document",id:"add-a-document",children:[]},{value:"Update a document",id:"update-a-document",children:[]}]}],l={toc:d};function u(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"add-data"},"Add data"),(0,o.kt)("p",null,"Cloud Firestore stores data in Documents, which are stored in Collections. Cloud Firestore creates collections and documents implicitly the first time you add data to the document. You do not need to explicitly create collections or documents."),(0,o.kt)("p",null,"There are several ways to write data to Cloud Firestore:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Set the data of a document within a collection, explicitly specifying a document identifier."),(0,o.kt)("li",{parentName:"ul"},"Add a new document to a collection. In this case, Cloud Firestore automatically generates the document identifier."),(0,o.kt)("li",{parentName:"ul"},"Create an empty document with an automatically generated identifier, and assign data to it later.")),(0,o.kt)("p",null,"This guide explains how to use the ",(0,o.kt)("inlineCode",{parentName:"p"},"setDocument()"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"add()"),", or ",(0,o.kt)("inlineCode",{parentName:"p"},"update()")," methods to write data to individual documents in Cloud Firestore. "),(0,o.kt)("h3",{id:"set-a-document"},"Set a document"),(0,o.kt)("p",null,"To create or overwrite a single document, use the ",(0,o.kt)("inlineCode",{parentName:"p"},"setDocument()")," method:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'var city:Object = {\n                name: "Los Angeles",\n                state: "CA",\n                country:  "USA"\n            };\n\nvar document:DocumentReference = FirebaseFirestore.service.collection( "cities" ).document( "LA" );\n            \ndocument.addEventListener( DocumentReferenceEvent.SET_SUCCESS, successHandler );\ndocument.addEventListener( DocumentReferenceEvent.SET_ERROR, errorHandler );\ndocument.setDocument( city );\n')),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"setDocument()")," call will dispatch one of two events:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"DocumentReferenceEvent.SET_SUCCESS"),": The document has been correctly set with the new data"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"DocumentReferenceEvent.SET_ERROR"),": There was an error setting the data to the document")),(0,o.kt)("p",null,"You should ensure you remove the event listeners at this point to ensure the extension can correctly clean up memory usage of unused document references."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'function successHandler( event:DocumentReferenceEvent ):void\n{\n    event.currentTarget.removeEventListener( DocumentReferenceEvent.SET_SUCCESS, successHandler );\n    event.currentTarget.removeEventListener( DocumentReferenceEvent.SET_ERROR, errorHandler );\n    \n    trace( "Set Document: Success" );\n}\n\nfunction errorHandler( event:DocumentReferenceEvent ):void\n{\n    event.currentTarget.removeEventListener( DocumentReferenceEvent.SET_SUCCESS, successHandler );\n    event.currentTarget.removeEventListener( DocumentReferenceEvent.SET_ERROR, errorHandler );\n    \n    trace( "Get Document Error: " + event.message );\n}\n')),(0,o.kt)("p",null,"Alternatively you can add a success and failure listener directly:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},"document.setDocument( city )\n    .addOnSuccessListener( function( snapshot:DocumentSnapshot ):void {\n        // Document was successfully set\n    })\n    .addOnFailureListener( function( message:String ):void {\n        // Error occurred\n    });\n")),(0,o.kt)("p",null,"If the document does not exist, it will be created. If the document does exist, its contents will be overwritten with the newly provided data, unless you specify that the data should be merged into the existing document, as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},"document.setDocument( city, SetOptions.merge() );\n")),(0,o.kt)("p",null,"If you're not sure whether the document exists, pass the option to merge the new data with any existing document to avoid overwriting entire documents."),(0,o.kt)("h3",{id:"data-types"},"Data types"),(0,o.kt)("p",null,"Cloud Firestore lets you write a variety of data types inside a document, including strings, booleans, numbers, dates, null, and nested arrays and objects. Cloud Firestore always stores numbers as doubles, regardless of what type of number you use in your code."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'var data:Object = {\n    stringExample: "Hello world!",\n    booleanExample: true,\n    numberExample: 3.14159265,\n    dateExample: new Date(),\n    nullExample: null,\n    arrayExample: [ 1, 2, 3 ],\n    nestedData: {\n        a: 5,\n        b: true\n    }\n};\n')),(0,o.kt)("h4",{id:"blob"},"Blob"),(0,o.kt)("p",null,"You can use a ",(0,o.kt)("inlineCode",{parentName:"p"},"Blob")," (",(0,o.kt)("inlineCode",{parentName:"p"},"com.distriqt.extension.firebase.firestore.Blob"),") to add ",(0,o.kt)("inlineCode",{parentName:"p"},"ByteArray")," style data to your documents."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"Blob")," data type inherits from a ",(0,o.kt)("inlineCode",{parentName:"p"},"ByteArray")," and handles conversion to and from the Firestore Blob format. So you can simply use the standard ",(0,o.kt)("inlineCode",{parentName:"p"},"ByteArray")," functions to store data and then add it to your document."),(0,o.kt)("p",null,"For example, construct a ",(0,o.kt)("inlineCode",{parentName:"p"},"Blob")," and write 2 bytes to it:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},"var bytes:Blob = new Blob();\nbytes.writeByte(0xa0);\nbytes.writeByte(0x7f);\n")),(0,o.kt)("p",null,"Then use this as a value in your data object and pass it to ",(0,o.kt)("inlineCode",{parentName:"p"},"setDocument()"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'var data:Object = {\n    title: "Some data",\n    byteData: bytes\n};\n\ndocument.setDocument( data );\n')),(0,o.kt)("h3",{id:"custom-objects"},"Custom objects"),(0,o.kt)("p",null,"Not currently supported"),(0,o.kt)("h3",{id:"add-a-document"},"Add a document"),(0,o.kt)("p",null,"When you use ",(0,o.kt)("inlineCode",{parentName:"p"},"setDocument()")," to create a document, you must specify an ID for the document to create. For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'FirebaseFirestore.service.collection( "cities" ).document( "LA" ).setDocument(data);\n')),(0,o.kt)("p",null,"But sometimes there isn't a meaningful ID for the document, and it's more convenient to let Cloud Firestore auto-generate an ID for you. You can do this by calling ",(0,o.kt)("inlineCode",{parentName:"p"},"add()"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'var collection:CollectionReference = FirebaseFirestore.service.collection( "cities" );\n\ncollection.addEventListener( CollectionReferenceEvent.ADD_SUCCESS, successHandler );\ncollection.addEventListener( CollectionReferenceEvent.ADD_ERROR, errorHandler );\ncollection.add( data );\n        \nfunction successHandler( event:CollectionReferenceEvent ):void\n{\n    event.currentTarget.removeEventListener( CollectionReferenceEvent.ADD_SUCCESS, successHandler );\n    event.currentTarget.removeEventListener( CollectionReferenceEvent.ADD_ERROR, errorHandler );\n    \n    trace( "Add Success: document.getId()   = " + event.document.getId() );\n    trace( "Add Success: document.getPath() = " + event.document.getPath() );\n}\n\nfunction errorHandler( event:CollectionReferenceEvent ):void\n{\n    event.currentTarget.removeEventListener( CollectionReferenceEvent.ADD_SUCCESS, successHandler );\n    event.currentTarget.removeEventListener( CollectionReferenceEvent.ADD_ERROR, errorHandler );\n    \n    trace( "Add Error: " + event.message );\n}\n')),(0,o.kt)("p",null,"In some cases, it can be useful to create a document reference with an auto-generated ID, then use the reference later. For this use case, you can call ",(0,o.kt)("inlineCode",{parentName:"p"},"document()"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'var document:DocumentReference = FirebaseFirestore.service.collection( "cities" ).document();\n\n// ... later\ndocument.set( data );\n')),(0,o.kt)("p",null,"Behind the scenes, ",(0,o.kt)("inlineCode",{parentName:"p"},".add(...)")," and ",(0,o.kt)("inlineCode",{parentName:"p"},".document().setDocument(...)")," are completely equivalent, so you can use whichever is more convenient."),(0,o.kt)("h3",{id:"update-a-document"},"Update a document"),(0,o.kt)("p",null,"To update some fields of a document without overwriting the entire document, use the ",(0,o.kt)("inlineCode",{parentName:"p"},"update()")," method:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'var changes:Object = {\n                population:  4018000\n            };\n            \nvar document:DocumentReference = FirebaseFirestore.service.collection( "cities" ).document( "LA" );\n\ndocument.addEventListener( DocumentReferenceEvent.UPDATE_SUCCESS, successHandler );\ndocument.addEventListener( DocumentReferenceEvent.UPDATE_ERROR, errorHandler );\ndocument.update( changes );\n\n\nfunction successHandler( event:DocumentReferenceEvent ):void\n{\n    event.currentTarget.removeEventListener( DocumentReferenceEvent.UPDATE_SUCCESS, successHandler );\n    event.currentTarget.removeEventListener( DocumentReferenceEvent.UPDATE_ERROR, errorHandler );\n    \n    trace( "Update Success" );\n}\n\nfunction errorHandler( event:DocumentReferenceEvent ):void\n{\n    event.currentTarget.removeEventListener( DocumentReferenceEvent.UPDATE_SUCCESS, successHandler );\n    event.currentTarget.removeEventListener( DocumentReferenceEvent.UPDATE_ERROR, errorHandler );\n    \n    trace( "Update Error: " + event.message );\n}\n')),(0,o.kt)("p",null,"You can also add server timestamps to specific fields in your documents, to track when an update was received by the server:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-actionscript"},'var changes:Object = {\n                population:  4018000,\n                timestamp: FieldValue.serverTimestamp()\n            };\n\nvar document:DocumentReference = FirebaseFirestore.service.collection( "cities" ).document( "LA" );\n        \ndocument.update( changes );\n')))}u.isMDXComponent=!0}}]);