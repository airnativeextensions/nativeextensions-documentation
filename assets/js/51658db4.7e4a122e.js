(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[76911],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return u},kt:function(){return h}});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=i.createContext({}),d=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=d(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=d(n),h=o,m=c["".concat(l,".").concat(h)]||c[h]||p[h]||r;return n?i.createElement(m,a(a({ref:t},u),{},{components:n})):i.createElement(m,a({ref:t},u))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var d=2;d<r;d++)a[d]=n[d];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},90877:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return a},metadata:function(){return s},toc:function(){return l},default:function(){return u}});var i=n(22122),o=n(19756),r=(n(67294),n(3905)),a={title:"Add the Extension",sidebar_label:"Add the Extension"},s={unversionedId:"windowsstore/add-the-extension",id:"windowsstore/add-the-extension",isDocsHomePage:!1,title:"Add the Extension",description:"First step is always to add the extension to your development environment.",source:"@site/docs/windowsstore/add-the-extension.md",sourceDirName:"windowsstore",slug:"/windowsstore/add-the-extension",permalink:"/docs/windowsstore/add-the-extension",version:"current",sidebar_label:"Add the Extension",frontMatter:{title:"Add the Extension",sidebar_label:"Add the Extension"},sidebar:"windowsstore",previous:{title:"WindowsStore",permalink:"/docs/windowsstore/"},next:{title:"Initialise the Extension",permalink:"/docs/windowsstore/initialise-the-extension"}},l=[{value:"Dependencies",id:"dependencies",children:[{value:"Core ANE",id:"core-ane",children:[]}]},{value:"Extension IDs",id:"extension-ids",children:[]},{value:"Windows",id:"windows",children:[{value:".Net Framework",id:"net-framework",children:[]},{value:"C++ Redistributable",id:"c-redistributable",children:[]},{value:"Creating an Installer",id:"creating-an-installer",children:[]},{value:"Packaging DLLs",id:"packaging-dlls",children:[]}]}],d={toc:l};function u(e){var t=e.components,a=(0,o.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,i.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"First step is always to add the extension to your development environment.\nTo do this use the tutorial located ",(0,r.kt)("a",{parentName:"p",href:"/docs/tutorials/getting-started"},"here"),"."),(0,r.kt)("h2",{id:"dependencies"},"Dependencies"),(0,r.kt)("h3",{id:"core-ane"},"Core ANE"),(0,r.kt)("p",null,"The Core ANE is required by this ANE. You must include and package this extension in your application."),(0,r.kt)("p",null,"The Core ANE doesn't provide any functionality in itself but provides support libraries and frameworks used by our extensions.\nIt also includes some centralised code for some common actions that can cause issues if they are implemented in each individual extension."),(0,r.kt)("p",null,"You can access this extension here: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/distriqt/ANE-Core"},"https://github.com/distriqt/ANE-Core"),"."),(0,r.kt)("h2",{id:"extension-ids"},"Extension IDs"),(0,r.kt)("p",null,"The following should be added to your ",(0,r.kt)("inlineCode",{parentName:"p"},"extensions")," node in your application descriptor to identify all the required ANEs in your application:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<extensions>\n    <extensionID>com.distriqt.WindowsStore</extensionID>\n    <extensionID>com.distriqt.Core</extensionID>\n</extensions>\n")),(0,r.kt)("h2",{id:"windows"},"Windows"),(0,r.kt)("h3",{id:"net-framework"},".Net Framework"),(0,r.kt)("p",null,"This extension requires v4.6 or higher of the .Net framework. This should come preinstalled on any Windows 10 or higher machine so if you are targetting those you should not have to do anything. If however you are targetting older versions of Windows you must ensure .Net v4.6 or higher is installed either manually or as part of an installer."),(0,r.kt)("h3",{id:"c-redistributable"},"C++ Redistributable"),(0,r.kt)("p",null,"The native code has a dependency on the Visual C++ 2017 Redistributable package. This package contains code that is required to run code developed using C++ in Visual Studio and is very common amongst Windows applications."),(0,r.kt)("p",null,"There are two ways to ensure this is available to your application:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create an installer that includes the redistributable installer;"),(0,r.kt)("li",{parentName:"ul"},"Package the required DLL files from the redistributable with your application;")),(0,r.kt)("p",null,"The first is the suggested method. Installing the redistributable via an installer allows it to be put into the windows update process, allowing bug fixes and security updates to be handled automatically."),(0,r.kt)("p",null,"The second method is only advised if you need a complete standalone application, where you don't (or cannot) use an installation process. This requires you to package DLLs from the redistributable with your application. "),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"NOTE: If you have previously packaged DLLs from the ",(0,r.kt)("inlineCode",{parentName:"p"},"windows_dll")," directory, these are no longer required. We have packaged these internally to the extension and access them directly from there.\n",(0,r.kt)("strong",{parentName:"p"},"You should remove these DLLs from your application.")),(0,r.kt)("p",{parentName:"blockquote"},"i.e. the DLLs in the image below are no longer required:"),(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("img",{src:n(40084).Z}))),(0,r.kt)("h3",{id:"creating-an-installer"},"Creating an Installer"),(0,r.kt)("p",null,"There are many methods to create application installers and many tutorials available. We suggest you find a method suitable to your environment and application and utilise the tutorials online. "),(0,r.kt)("p",null,"Some methods include:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://www.jrsoftware.org/isinfo.php"},"Inno Setup")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://wixtoolset.org/"},"Wix"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://wixedit.sourceforge.net"},"WixEdit"))))),(0,r.kt)("p",null,"Tutorials:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://www.adobe.com/devnet/air/articles/customize-setup-for-AIR-app-with-captive-runtime.html"},"Generating a Windows installer"))),(0,r.kt)("p",null,"You need to include the x86 c++ 2017 redistributable in the installer, there are many examples and documentation online to achieve this."),(0,r.kt)("h3",{id:"packaging-dlls"},"Packaging DLLs"),(0,r.kt)("p",null,"Packaging the DLLs into your application involves copying the DLLs specified below into your application root and including in your application package."),(0,r.kt)("p",null,"The best option is to install Visual Studio 2017 and locate the ",(0,r.kt)("inlineCode",{parentName:"p"},"Program Files[ (x86)]\\Microsoft Visual Studio\\2017\\edition\\VC\\Redist\\MSVC\\lib-version")," folder, eg: ",(0,r.kt)("inlineCode",{parentName:"p"},"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Redist\\MSVC\\14.16.27012\\x86\\Microsoft.VC141.CRT")),(0,r.kt)("p",null,"Alternatively, download and install the x86 redistributable from the ",(0,r.kt)("a",{parentName:"p",href:"https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads"},"Microsoft website"),". This should install the DLLs into ",(0,r.kt)("inlineCode",{parentName:"p"},"C:\\Windows\\System32")," folder. "),(0,r.kt)("p",null,"Open the folder and copy the following DLLs to your application:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"msvcp140.dll")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"vcruntime140.dll"))),(0,r.kt)("p",null,"If you are having issues locating these files, feel free to contact us for help."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(84890).Z})),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"You should ensure you are allowed to package these files as per the Microsoft Software License terms but generally these are safe to redistribute subject to the license terms. More information here: ",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/cpp/windows/redistributing-visual-cpp-files"},"Redistributing Visual C++ Files")),(0,r.kt)("p",{parentName:"blockquote"},"You should get legal advice if you are unsure. ")))}u.isMDXComponent=!0},40084:function(e,t,n){"use strict";t.Z=n.p+"assets/images/windows_dlls_list_example-f30a125f9c385972a749e4dbb5785865.png"},84890:function(e,t,n){"use strict";t.Z=n.p+"assets/images/windows_redist_dlls_list_example-402034d4d3bdf33ba798f0481b8a2e95.png"}}]);