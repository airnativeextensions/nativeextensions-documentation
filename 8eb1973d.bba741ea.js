(window.webpackJsonp=window.webpackJsonp||[]).push([[434],{1130:function(e,n,i){"use strict";i.r(n),n.default=i.p+"assets/images/auth-email-link-enable-ee0b6d1f395e8793a5d8136cc0eef3fc.png"},490:function(e,n,i){"use strict";i.r(n),i.d(n,"frontMatter",(function(){return l})),i.d(n,"metadata",(function(){return s})),i.d(n,"rightToc",(function(){return o})),i.d(n,"default",(function(){return d}));var t=i(2),a=i(6),r=(i(0),i(807)),l={title:"Auth - Provider - Email Link",sidebar_label:"Email Link"},s={unversionedId:"firebase/auth/provider/email-link",id:"firebase/auth/provider/email-link",isDocsHomePage:!1,title:"Auth - Provider - Email Link",description:"You can use Firebase Authentication to sign in a user by sending them an email containing a link,",source:"@site/docs/firebase/auth/provider/email-link.md",slug:"/firebase/auth/provider/email-link",permalink:"/docs/firebase/auth/provider/email-link",version:"current",sidebar_label:"Email Link",sidebar:"firebase",previous:{title:"Auth - Provider - Email",permalink:"/docs/firebase/auth/provider/email"},next:{title:"Auth - Provider - Anonymous",permalink:"/docs/firebase/auth/provider/anonymous"}},o=[{value:"Enable Email Link sign-in",id:"enable-email-link-sign-in",children:[]},{value:"Send an authentication link",id:"send-an-authentication-link",children:[{value:"URL",id:"url",children:[]}]},{value:"Complete sign in with the email link",id:"complete-sign-in-with-the-email-link",children:[{value:"Add Dynamic Links",id:"add-dynamic-links",children:[]},{value:"Verify link and sign in",id:"verify-link-and-sign-in",children:[]}]},{value:"Differentiating email/password from email link",id:"differentiating-emailpassword-from-email-link",children:[]}],c={rightToc:o};function d(e){var n=e.components,l=Object(a.a)(e,["components"]);return Object(r.b)("wrapper",Object(t.a)({},c,l,{components:n,mdxType:"MDXLayout"}),Object(r.b)("p",null,"You can use Firebase Authentication to sign in a user by sending them an email containing a link,\nwhich they can click to sign in. In the process, the user's email address is also verified."),Object(r.b)("p",null,"There are numerous benefits to signing in by email:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Low friction sign-up and sign-in."),Object(r.b)("li",{parentName:"ul"},"Lower risk of password reuse across applications, which can undermine security of even well-selected passwords."),Object(r.b)("li",{parentName:"ul"},"The ability to authenticate a user while also verifying that the user is the legitimate owner of an email address."),Object(r.b)("li",{parentName:"ul"},"A user only needs an accessible email account to sign in. No ownership of a phone number or social media account is required."),Object(r.b)("li",{parentName:"ul"},"A user can sign in securely without the need to provide (or remember) a password, which can be cumbersome on a mobile device."),Object(r.b)("li",{parentName:"ul"},"An existing user who previously signed in with an email identifier (password or federated) can be upgraded to sign in with just the email. For example, a user who has forgotten their password can still sign in without needing to reset their password.")),Object(r.b)("h2",{id:"enable-email-link-sign-in"},"Enable Email Link sign-in"),Object(r.b)("p",null,"To sign in users by email link, you must first enable the Email provider and Email link sign-in method for your Firebase project:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"In the Firebase console, open the Auth section."),Object(r.b)("li",{parentName:"ol"},"On the Sign in method tab, enable the Email/Password provider. Note that email/password sign-in must be enabled to use email link sign-in."),Object(r.b)("li",{parentName:"ol"},"In the same section, enable Email link (passwordless sign-in) sign-in method."),Object(r.b)("li",{parentName:"ol"},"Click Save.")),Object(r.b)("p",null,Object(r.b)("img",{src:i(1130).default})),Object(r.b)("h2",{id:"send-an-authentication-link"},"Send an authentication link"),Object(r.b)("p",null,"To initiate the authentication flow, present the user with an interface that prompts the user\nto provide their email address and then call ",Object(r.b)("inlineCode",{parentName:"p"},"sendSignInLinkToEmail()")," to request that\nFirebase send the authentication link to the user's email."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Construct the ActionCodeSettings object, which provides Firebase with instructions on how to construct the email link.  Set the following fields:"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"url"),": The deep link to embed and any additional state to be passed along. The link's domain has to be whitelisted in the Firebase Console list of authorized domains, which can be found by going to the Sign-in method tab (Authentication -> Sign-in method). The link will redirect the user to this URL if the app is not installed on their device and the app was not able to be installed."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"androidPackageName")," and ",Object(r.b)("inlineCode",{parentName:"li"},"IOSBundleId"),": The apps to use when the sign-in link is opened on an Android or iOS device. Learn more on how to configure Firebase Dynamic Links to open email action links via mobile apps."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"handleCodeInApp"),": Set to ",Object(r.b)("inlineCode",{parentName:"li"},"true"),". The sign-in operation has to always be completed in the app unlike other out of band email actions (password reset and email verifications). This is because, at the end of the flow, the user is expected to be signed in and their Auth state persisted within the app."))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Ask the user for their email.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Send the authentication link to the user's email, and save the user's email in case the user completes the email sign-in on the same device."))),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-actionscript"}),'var email:String = "some@email.com";\n\nvar actionCodeSettings:ActionCodeSettings = new ActionCodeSettings()\n    // URL you want to redirect back to. The domain (www.example.com) for this\n    // URL must be whitelisted in the Firebase Console.\n    .setUrl( "https://www.example.com/finishSignUp?cartId=1234" )\n    .setHandleCodeInApp( true )\n    .setIOSBundelId( "com.example.ios" )\n    .setAndroidPackageName( \n        "com.example.android", \n        true,  /* installIfNotAvailable */\n        "1" /* minimumVersion */ );\n        \nFirebaseAuth.service.sendSignInLinkToEmail( Config.email, actionCodeSettings );\n')),Object(r.b)("p",null,"This process will dispatch a complete event when the process was completed with a success flag similar to other events in this extension:"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-actionscript"}),'FirebaseAuth.service.addEventListener(\n    FirebaseAuthEvent.SEND_SIGNIN_LINK_TO_EMAIL_COMPLETE,\n    sendSignInLinkToEmail_completeHandler );\n\n\nfunction sendSignInLinkToEmail_completeHandler( event:FirebaseAuthEvent ):void\n{\n    trace( "sendSignInLinkToEmail():complete:" + event.success );\n}\n')),Object(r.b)("p",null,"At this point the user will need to check their email and click on the link in the email."),Object(r.b)("h3",{id:"url"},"URL"),Object(r.b)("p",null,"For the URL we generally suggest you use your Firebase app url (",Object(r.b)("inlineCode",{parentName:"p"},"https://PROJECT_ID.firebaseapp.com"),"). This normally can be found by checking the ",Object(r.b)("em",{parentName:"p"},"Authorized Domains")," in the Firebase Console under ",Object(r.b)("em",{parentName:"p"},"Authentication > Sign in Method")),Object(r.b)("p",null,"Using this method and adding the Dynamic Links extension simplifies the development and integration required. "),Object(r.b)("p",null,"This guide will assume this approach however you can use whatever approach suits you needs to handle the url redirection."),Object(r.b)("h2",{id:"complete-sign-in-with-the-email-link"},"Complete sign in with the email link"),Object(r.b)("h3",{id:"add-dynamic-links"},"Add Dynamic Links"),Object(r.b)("p",null,"Firebase Auth uses Firebase Dynamic Links when sending a link that is meant to be opened in a mobile application. In order to use this feature, Dynamic Links must be configured in the Firebase Console."),Object(r.b)("p",null,"Follow the guide to add the Dynamic Links extension to your application:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(t.a)({parentName:"li"},{href:"../../dynamiclinks/add-the-extension"}),"DynamicLinks"))),Object(r.b)("p",null,"Now you can listen for the user to click on the link in the email "),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-actionscript"}),'FirebaseDynamicLinks.service.addEventListener( \n    DynamicLinkEvent.RECEIVED, \n    dynamicLink_receivedHandler );\n\nfunction dynamicLink_receivedHandler( event:DynamicLinkEvent ):void\n{\n    trace( "dynamicLink_receivedHandler(): " + event.link );\n\n    // This could be the email link \n\n}\n')),Object(r.b)("h3",{id:"verify-link-and-sign-in"},"Verify link and sign in"),Object(r.b)("p",null,"After you receive the link as described above, verify that it is meant for email link authentication and complete the sign in."),Object(r.b)("p",null,'You can check if a link is a "sign in with email link" by using the ',Object(r.b)("inlineCode",{parentName:"p"},"isSignInWithEmailLink()")," function:"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-actionscript"}),'if (FirebaseAuth.service.isSignInWithEmailLink( link ))\n{\n    // This is a "sign in with email link"\n}\n')),Object(r.b)("p",null,"You then can sign in the user using their email and the email link by calling the ",Object(r.b)("inlineCode",{parentName:"p"},"signInWithEmailLink()")," function:"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-actionscript"}),"if (FirebaseAuth.service.isSignInWithEmailLink( link ))\n{\n    // Initiate the sign in process\n    FirebaseAuth.service.signInWithEmailLink( email, link );\n}\n")),Object(r.b)("p",null,"The sign in process will dispatch an event once complete:"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-actionscript"}),'FirebaseAuth.service.addEventListener(\n    FirebaseAuthEvent.SIGNIN_WITH_EMAILLINK_COMPLETE,\n    signInWithEmailLink_completeHandler );\n\nfunction signInWithEmailLink_completeHandler( event:FirebaseAuthEvent ):void\n{\n    trace( "signInWithEmailLink():complete:" + event.success );\n}\n')),Object(r.b)("p",null,"Of course you can use your global ",Object(r.b)("inlineCode",{parentName:"p"},"FirebaseAuthEvent.AUTHSTATE_CHANGED")," to listen for sign in success as well as this handler."),Object(r.b)("h2",{id:"differentiating-emailpassword-from-email-link"},"Differentiating email/password from email link"),Object(r.b)("p",null,"In case you support both password and link-based sign in with email, to differentiate the method of sign in for a password/link user, use ",Object(r.b)("inlineCode",{parentName:"p"},"fetchSignInMethodsForEmail()"),". This is useful for identifier-first flows where the user is first asked to provide their email and then presented with the method of sign-in:"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-actionscript"}),'FirebaseAuth.service.addEventListener(\n        FirebaseAuthMethodsEvent.FETCH_SIGNIN_METHODS_COMPLETE,\n        fetchSignInMethodsForEmail_completeHandler );\n\nFirebaseAuth.service.fetchSignInMethodsForEmail( Config.email );\n        \nfunction fetchSignInMethodsForEmail_completeHandler( event:FirebaseAuthMethodsEvent ):void\n{\n    trace( "fetchSignInMethodsForEmail():complete:" + event.success );\n    if (event.methods != null)\n    {\n        for each (var method:String in event.methods)\n        {\n            if (EmailAuthCredential.EMAIL_LINK_SIGN_IN_METHOD == method)\n            {\n                // User can sign in with email/link\n            }\n            else if (EmailAuthCredential.EMAIL_PASSWORD_SIGN_IN_METHOD == method)\n            {\n                // User can sign in with email/password\n            }\n        }\n    }\n            \n}\n')),Object(r.b)("p",null,"Note: email/password and email/link are considered the same ",Object(r.b)("inlineCode",{parentName:"p"},"EmailAuthProvider")," (same ",Object(r.b)("inlineCode",{parentName:"p"},"PROVIDER_ID"),") with different methods of sign-in."))}d.isMDXComponent=!0},807:function(e,n,i){"use strict";i.d(n,"a",(function(){return b})),i.d(n,"b",(function(){return h}));var t=i(0),a=i.n(t);function r(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function l(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function s(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?l(Object(i),!0).forEach((function(n){r(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function o(e,n){if(null==e)return{};var i,t,a=function(e,n){if(null==e)return{};var i,t,a={},r=Object.keys(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||(a[i]=e[i]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}var c=a.a.createContext({}),d=function(e){var n=a.a.useContext(c),i=n;return e&&(i="function"==typeof e?e(n):s(s({},n),e)),i},b=function(e){var n=d(e.components);return a.a.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},m=a.a.forwardRef((function(e,n){var i=e.components,t=e.mdxType,r=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),b=d(i),m=t,h=b["".concat(l,".").concat(m)]||b[m]||u[m]||r;return i?a.a.createElement(h,s(s({ref:n},c),{},{components:i})):a.a.createElement(h,s({ref:n},c))}));function h(e,n){var i=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var r=i.length,l=new Array(r);l[0]=m;var s={};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);s.originalType=e,s.mdxType="string"==typeof e?e:t,l[1]=s;for(var c=2;c<r;c++)l[c]=i[c];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,i)}m.displayName="MDXCreateElement"}}]);