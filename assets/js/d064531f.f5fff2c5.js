"use strict";(self.webpackChunknativeextensions_documentation=self.webpackChunknativeextensions_documentation||[]).push([[40504],{3905:function(e,n,o){o.d(n,{Zo:function(){return p},kt:function(){return g}});var t=o(67294);function i(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function a(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function r(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?a(Object(o),!0).forEach((function(n){i(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function s(e,n){if(null==e)return{};var o,t,i=function(e,n){if(null==e)return{};var o,t,i={},a=Object.keys(e);for(t=0;t<a.length;t++)o=a[t],n.indexOf(o)>=0||(i[o]=e[o]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)o=a[t],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var l=t.createContext({}),c=function(e){var n=t.useContext(l),o=n;return e&&(o="function"==typeof e?e(n):r(r({},n),e)),o},p=function(e){var n=c(e.components);return t.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var o=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(o),g=i,k=d["".concat(l,".").concat(g)]||d[g]||u[g]||a;return o?t.createElement(k,r(r({ref:n},p),{},{components:o})):t.createElement(k,r({ref:n},p))}));function g(e,n){var o=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=o.length,r=new Array(a);r[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var c=2;c<a;c++)r[c]=o[c];return t.createElement.apply(null,r)}return t.createElement.apply(null,o)}d.displayName="MDXCreateElement"},84027:function(e,n,o){o.r(n),o.d(n,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var t=o(87462),i=o(63366),a=(o(67294),o(3905)),r=["components"],s={title:"Facebook Login",sidebar_label:"Facebook Login"},l=void 0,c={unversionedId:"facebookapi/login/facebook-login",id:"facebookapi/login/facebook-login",title:"Facebook Login",description:"In order to log a user in you will be calling the logInWithConfiguration() function and awaiting a login event. This function takes a LoginConfiguration instance as the parameter. The LoginConfiguration allows you to specify the required configuration for the login request, including permissions and login tracking.",source:"@site/docs/facebookapi/login/facebook-login.md",sourceDirName:"facebookapi/login",slug:"/facebookapi/login/facebook-login",permalink:"/docs/facebookapi/login/facebook-login",tags:[],version:"current",frontMatter:{title:"Facebook Login",sidebar_label:"Facebook Login"},sidebar:"facebookapi",previous:{title:"Add the Extension",permalink:"/docs/facebookapi/login/add-the-extension"},next:{title:"Access Token",permalink:"/docs/facebookapi/login/access-token"}},p=[{value:"Events",id:"events",children:[],level:2},{value:"Existing Login",id:"existing-login",children:[],level:2},{value:"Logout",id:"logout",children:[],level:2},{value:"Permissions",id:"permissions",children:[{value:"When to ask for Permissions",id:"when-to-ask-for-permissions",children:[],level:3},{value:"Revoked Permissions",id:"revoked-permissions",children:[],level:3},{value:"Request More Permissions",id:"request-more-permissions",children:[],level:3}],level:2},{value:"Profile",id:"profile",children:[{value:"Profile Changes",id:"profile-changes",children:[],level:3}],level:2},{value:"Limited Login",id:"limited-login",children:[],level:2}],u={toc:p};function d(e){var n=e.components,o=(0,i.Z)(e,r);return(0,a.kt)("wrapper",(0,t.Z)({},u,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In order to log a user in you will be calling the ",(0,a.kt)("inlineCode",{parentName:"p"},"logInWithConfiguration()")," function and awaiting a login event. This function takes a ",(0,a.kt)("inlineCode",{parentName:"p"},"LoginConfiguration")," instance as the parameter. The ",(0,a.kt)("inlineCode",{parentName:"p"},"LoginConfiguration")," allows you to specify the required configuration for the login request, including permissions and login tracking."),(0,a.kt)("p",null,"The simplest version just specifies the array of permissions:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},'if (FacebookLogin.isSupported)\n{\n    FacebookLogin.instance.logInWithConfiguration( \n        new LoginConfiguration( [ "public_profile", "email" ] )\n    );\n}\n')),(0,a.kt)("p",null,"For the prefined permissions you can see the constants defined in the ",(0,a.kt)("a",{parentName:"p",href:"https://docs.airnativeextensions.com/asdocs/facebookapi/com/distriqt/extension/facebook/login/FacebookPermissions.html"},(0,a.kt)("inlineCode",{parentName:"a"},"FacebookPermissions")," class"),"."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"As of April 24,2018, the ",(0,a.kt)("inlineCode",{parentName:"p"},"pubish_actions")," permission has been removed. Please see the ",(0,a.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/graph-api/changelog/breaking-changes#login-4-24"},"Breaking Changes Changelog")," for more details. To provide a way for your app users to share content to Facebook, you should use Facebook's ",(0,a.kt)("a",{parentName:"p",href:"/docs/facebookapi/share/overview"},"Sharing products")," instead.")),(0,a.kt)("h2",{id:"events"},"Events"),(0,a.kt)("p",null,"After calling ",(0,a.kt)("inlineCode",{parentName:"p"},"logInWithConfiguration()")," one of the following events will be dispatched:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"FacebookLoginEvent.SUCCESS"),": The login was successful and the user is now logged in; "),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"FacebookLoginEvent.CANCEL"),": The user cancelled the login process;"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"FacebookLoginErrorEvent.ERROR"),": There was an error during login, check the event properties for details.")),(0,a.kt)("p",null,"When the user is successully logged in you will have access to the access token and to the requested user details (profile, email etc)."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"FacebookLoginEvent")," class on success contains:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"accessToken"),": An instance of ",(0,a.kt)("inlineCode",{parentName:"li"},"AccessToken")," containing details about the token"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"profile"),": An instance of ",(0,a.kt)("inlineCode",{parentName:"li"},"Profile")," containing details about the current user"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"authToken"),": An instance of ",(0,a.kt)("inlineCode",{parentName:"li"},"AuthenticationToken")," containing details about the login request")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"profile")," may be ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," if the profile information hasn't been retrieved or requested yet. Both will be ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," for a cancel event. The ",(0,a.kt)("inlineCode",{parentName:"p"},"accessToken")," may be ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," if you have specified a limited tracking login."),(0,a.kt)("p",null,"For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},'FacebookLogin.instance.addEventListener( FacebookLoginEvent.SUCCESS, successHandler );\nFacebookLogin.instance.addEventListener( FacebookLoginEvent.CANCEL, cancelHandler );\nFacebookLogin.instance.addEventListener( FacebookLoginErrorEvent.ERROR, errorHandler );\n\nFacebookLogin.instance.logInWithReadPermissions( [ "public_profile", "email" ] );\n\n\nfunction successHandler( event:FacebookLoginEvent ):void\n{\n    trace( "successHandler()" );\n    // You can now access the user\n}\n\nfunction cancelHandler( event:FacebookLoginEvent ):void\n{\n    trace( "cancelHandler()" );\n}\n\nfunction errorHandler( event:FacebookLoginErrorEvent ):void\n{\n    trace( "errorHandler() code :    " + event.errorID  );\n    trace( "errorHandler() message : " + event.text  );\n}\n')),(0,a.kt)("h2",{id:"existing-login"},"Existing Login"),(0,a.kt)("p",null,"You can check if your user is already logged in by calling the ",(0,a.kt)("inlineCode",{parentName:"p"},"isLoggedIn()")," function. This will return ",(0,a.kt)("inlineCode",{parentName:"p"},"true")," if your user is already logged in."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},"if (FacebookLogin.instance.isLoggedIn())\n{\n    // User logged in\n}\n")),(0,a.kt)("p",null,"You can also check for a valid access token, as this will only be available if the user is logged in:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},"var accessToken:AccessToken = FacebookLogin.instance.getAccessToken();\nif (accessToken != null)\n{\n    // User logged in\n}\n")),(0,a.kt)("h2",{id:"logout"},"Logout"),(0,a.kt)("p",null,"To logout the current user call the ",(0,a.kt)("inlineCode",{parentName:"p"},"logout()")," function."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},"FacebookLogin.instance.logout();\n")),(0,a.kt)("h2",{id:"permissions"},"Permissions"),(0,a.kt)("p",null,"When a person logs into your app via Facebook Login you can access a subset of that person's data stored on Facebook. Permissions are how you ask someone if you can access that data. A person's privacy settings combined with what you ask for will determine what you can access."),(0,a.kt)("p",null,"Permissions are strings that are passed along with a login request or an API call. Here are two examples of permissions:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"email")," - Access to a person's primary email address."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"user_likes")," - Access to the list of things a person likes.")),(0,a.kt)("p",null,"You can get the list of granted and denied permissions at any time by using the current ",(0,a.kt)("a",{parentName:"p",href:"/docs/facebookapi/login/access-token"},(0,a.kt)("inlineCode",{parentName:"a"},"AccessToken")),"."),(0,a.kt)("h3",{id:"when-to-ask-for-permissions"},"When to ask for Permissions"),(0,a.kt)("p",null,"During basic login, your app receives access to a person's public profile. To access additional profile information or to publish content to Facebook on their behalf, you need to request additional permissions, see ",(0,a.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/facebook-login/permissions/"},"Permissions with Facebook Login"),"."),(0,a.kt)("p",null,"Your app should manage permissions as follows:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Graph API Requests - Before you send Graph API requests, you should check for necessary permissions and request them if needed.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Missing and Revoked Permissions - Your app needs to deal with missing or revoked permissions errors from Facebook such as by asking for permissions and retrying. See Error-Handling, iOS SDK.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Timing Requests - You will get better conversion if you ask for permissions only when they are needed and provide functionality without requiring all permissions."))),(0,a.kt)("p",null,"Permissions only need to be granted once per app, i.e. permissions granted on one platform are effectively granted on all the platforms your app supports."),(0,a.kt)("h3",{id:"revoked-permissions"},"Revoked Permissions"),(0,a.kt)("p",null,"People can also revoke permissions granted to your app in Facebook's interface at any time after they have logged in. It is important that your app regularly checks which permissions have been granted, especially when launching on a new platform. We provide methods for you to check what permissions are currently\ngranted to your app."),(0,a.kt)("h3",{id:"request-more-permissions"},"Request More Permissions"),(0,a.kt)("p",null,"Use ",(0,a.kt)("inlineCode",{parentName:"p"},"FacebookLogin")," to request additional permissions or request previously declined permissions using the same ",(0,a.kt)("inlineCode",{parentName:"p"},"logInWithReadPermission()")," method. The SDK will see it's a re-request by the availability of the permissions in the current access token."),(0,a.kt)("h2",{id:"profile"},"Profile"),(0,a.kt)("p",null,"Once the user is logged in you can get the user's details through the ",(0,a.kt)("a",{parentName:"p",href:"http://docs.airnativeextensions.com/asdocs/facebookapi/com/distriqt/extension/facebook/login/Profile.html"},(0,a.kt)("inlineCode",{parentName:"a"},"Profile"))," (assuming you requested profile read permissions). "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},"var profile:Profile = FacebookLogin.instance.getProfile();\nif (profile != null)\n{\n    trace( profile.name );\n}\n")),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"http://docs.airnativeextensions.com/asdocs/facebookapi/com/distriqt/extension/facebook/login/Profile.html"},(0,a.kt)("inlineCode",{parentName:"a"},"Profile"))," contains information about the user such as ",(0,a.kt)("inlineCode",{parentName:"p"},"firstName"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"lastName"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"pictureUrl"),"."),(0,a.kt)("h3",{id:"profile-changes"},"Profile Changes"),(0,a.kt)("p",null,"If you need to respond to changes in the user profile during the application session you can listen for the ",(0,a.kt)("inlineCode",{parentName:"p"},"FacebookProfileEvent.CHANGED")," event. This event will be dispatched whenever the profile is updated."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},"FacebookLogin.instance.addEventListener( FacebookProfileEvent.CHANGED, profileChangedHandler );\n\nfunction profileChangedHandler( event:FacebookProfileEvent ):void\n{\n    // Update profile information\n}\n")),(0,a.kt)("p",null,"This can also be useful during certain login scenarios where the profile may not be loaded initially but updated shortly after login. "),(0,a.kt)("h2",{id:"limited-login"},"Limited Login"),(0,a.kt)("p",null,"Limited Login offers a login path that implements steps designed to prevent the fact that a person used Facebook to log in to your app from being used to target advertising or measure advertising effectiveness."),(0,a.kt)("p",null,"Limited Login returns an ",(0,a.kt)("inlineCode",{parentName:"p"},"AuthenticationToken")," that wraps an OpenID Connect token. ",(0,a.kt)("strong",{parentName:"p"},"The ID token cannot be used to request additional data using the Graph API, such as friends, photos, or pages. Doing so requires the use of classic Facebook Login.")),(0,a.kt)("p",null,"A successful login populates a global ",(0,a.kt)("inlineCode",{parentName:"p"},"AuthenticationToken")," instance. You can provide a ",(0,a.kt)("inlineCode",{parentName:"p"},"nonce")," for the login attempt that will be reflected in the return token. In addition, Limited Login populates a shared profile instance that contains the basic information including ID, name, profile picture, and email (if granted by the user)."),(0,a.kt)("p",null,"To use a limited login you must set the login tracking to be ",(0,a.kt)("inlineCode",{parentName:"p"},"LoginTracking.LIMITED")," in the ",(0,a.kt)("inlineCode",{parentName:"p"},"LoginConfiguration")," instance when attempting login. (You will likely want to set a ",(0,a.kt)("inlineCode",{parentName:"p"},"nonce")," value that you can use to validate the login serverside.)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-actionscript"},'var configuration:LoginConfiguration = new LoginConfiguration( [ "public_profile", "email" ] );\n\nconfiguration.setLoginTracking( LoginTracking.LIMITED );\nconfiguration.setNonce("123");\n\n\nFacebookLogin.instance.logInWithConfiguration( configuration );\n')),(0,a.kt)("p",null,"To retrieve the authentication token (OIDC token) you can call the ",(0,a.kt)("inlineCode",{parentName:"p"},"getAuthenticationToken()")," function:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-as3"},"var token:AuthenticationToken = FacebookLogin.instance.getAuthenticationToken();\n\ntrace( token.token );\ntrace( token.nonce );\n")))}d.isMDXComponent=!0}}]);