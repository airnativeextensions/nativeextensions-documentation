
## Extension IDs

The following should be added to your `extensions` node in your application descriptor to identify all the required ANEs in your application:

```xml
<extensions>
	<extensionID>com.distriqt.Core</extensionID>
	<extensionID>com.distriqt.Health</extensionID>
	<extensionID>androidx.appcompat</extensionID>
	<extensionID>androidx.core</extensionID>
	<extensionID>androidx.emoji2</extensionID>
	<extensionID>androidx.vectordrawable</extensionID>
	<extensionID>com.google.guava</extensionID>
	<extensionID>com.jetbrains.kotlin</extensionID>

	<!-- If you are using Health Connect, you will need this extension -->
	<extensionID>androidx.healthconnect</extensionID>

	<!-- If you are using Google Fitness, you will need this extension -->
	<extensionID>com.distriqt.playservices.Fitness</extensionID>
</extensions>
```



## iOS 


### Info Additions 


The following additions are for the `InfoAdditions` node of the iPhone section in your application descriptor:

```xml
<InfoAdditions><![CDATA[

	<key>MinimumOSVersion</key>
	<string>12.0</string>

	<key>UIRequiredDeviceCapabilities</key>
	<array>
		<string>healthkit</string>
	</array>

	<key>NSHealthUpdateUsageDescription</key>
	<string>App needs permission to save samples to the HealthKit store</string>
	
	<key>NSHealthShareUsageDescription</key>
	<string>App needs permission to read samples from the HealthKit store</string>

]]></InfoAdditions>
```


### Entitlements

The following additions are for the `Entitlements` node of the iPhone section in your application descriptor:

```xml
<Entitlements><![CDATA[

	<key>com.apple.developer.healthkit</key>
	<true/>
	<key>com.apple.developer.healthkit.access</key>
	<array>
		<string>health-records</string>
	</array>

]]></Entitlements>
```



## Android 

### Manifest Additions

The Health extension requires a few additions to the manifest to be able to start certain activities. You should add the listing below to your manifest.

:::caution
Ensure you replace:
-  `APPLICATION_PACKAGE` with your AIR application's Java package name, something like `air.com.distriqt.test`. Generally this is your AIR application id prefixed by `air.` unless you have specified no air flair in your build options.
:::


```xml
<manifest android:installLocation="auto">
	<uses-permission android:name="android.permission.INTERNET"/>
	
	<uses-sdk android:minSdkVersion="26" android:targetSdkVersion="34"/>
	
	<queries>
		<package android:name="com.google.android.apps.fitness"/>
		<package android:name="com.google.android.apps.healthdata"/>
	</queries>
	
	<application>

        <activity
            android:name="com.distriqt.extension.health.PermissionsRationaleActivity"
            android:exported="true"
            android:enabled="true">
            <intent-filter>
                <action android:name="androidx.health.ACTION_SHOW_PERMISSIONS_RATIONALE" />
            </intent-filter>
        </activity>

        <activity-alias
            android:name="ViewPermissionUsageActivity"
            android:exported="true"
            android:targetActivity="com.distriqt.extension.health.PermissionsRationaleActivity"
            android:permission="android.permission.START_VIEW_PERMISSION_USAGE">
            <intent-filter>
                <action android:name="android.intent.action.VIEW_PERMISSION_USAGE" />
                <category android:name="android.intent.category.HEALTH_PERMISSIONS" />
            </intent-filter>
        </activity-alias>

		<activity android:name="com.distriqt.core.auth.AuthorisationActivity" android:exported="false" android:theme="@android:style/Theme.Translucent.NoTitleBar"/>
	</application>
</manifest>
```


### Android Gradle Version 

We have updated the required gradle version used to build your application to be higher than the default AIR currently uses (April 2025). 

To specify a higher version add the following to your android node in your application descriptor:

```xml
<android>
    <gradleVersion>8.9</gradleVersion>
    <androidGradlePluginVersion>8.7.3</androidGradlePluginVersion>

  ...
</android>
```

If you don't do this you will see the following error when building your application:

```
Unexpected failure: Unable to run java: com.adobe.air.ADTException: gradle tool failed: 
FAILURE: Build failed with an exception.

...

   > BUG! exception in phase 'semantic analysis' in source unit '_BuildScript_' Unsupported class file major version 65
```

:::note
June 2025: This is not currently automatically handled by `apm` so you will need to add this manually to your application descriptor.

We are working on an update to handle this.
:::



### Permissions 

In addition to the above you will need to add the permissions for the health data you require access to.


With Health Connect, to read and write the step data you need the following permissions:

```xml
<uses-permission android:name="android.permission.health.READ_STEPS"/>
<uses-permission android:name="android.permission.health.WRITE_STEPS"/>
```

With Google Fitness, you will need the following permission:

```xml
<uses-permission android:name="android.permission.ACTIVITY_RECOGNITION"/>
```

