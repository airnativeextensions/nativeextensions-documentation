(window.webpackJsonp=window.webpackJsonp||[]).push([[412],{468:function(e,n,o){"use strict";o.r(n),o.d(n,"frontMatter",(function(){return r})),o.d(n,"metadata",(function(){return s})),o.d(n,"rightToc",(function(){return d})),o.d(n,"default",(function(){return p}));var a=o(2),i=o(6),t=(o(0),o(853)),r={title:"Firebase InApp Messaging",sidebar_label:"Firebase InApp Messaging"},s={unversionedId:"pushnotifications/firebase/firebase-inapp-messaging",id:"pushnotifications/firebase/firebase-inapp-messaging",isDocsHomePage:!1,title:"Firebase InApp Messaging",description:"Important: You must have performed the setup process outlined in Add the Extension and Setup Firebase Cloud Messaging before performing these additional setup steps.",source:"@site/docs/pushnotifications/firebase/firebase-inapp-messaging.md",slug:"/pushnotifications/firebase/firebase-inapp-messaging",permalink:"/docs/pushnotifications/firebase/firebase-inapp-messaging",version:"current",sidebar_label:"Firebase InApp Messaging",sidebar:"pushnotifications",previous:{title:"Firebase Cloud Messaging",permalink:"/docs/pushnotifications/firebase/firebase-cloud-messaging"},next:{title:"Migrating to v10.1",permalink:"/docs/pushnotifications/migrating-to-v10.1"}},d=[{value:"Required ANEs",id:"required-anes",children:[{value:"Android Support",id:"android-support",children:[]},{value:"Square ANEs",id:"square-anes",children:[]}]},{value:"Extension IDs",id:"extension-ids",children:[]},{value:"Manifest Additions",id:"manifest-additions",children:[]}],c={rightToc:d};function p(e){var n=e.components,o=Object(i.a)(e,["components"]);return Object(t.b)("wrapper",Object(a.a)({},c,o,{components:n,mdxType:"MDXLayout"}),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},Object(t.b)("strong",{parentName:"p"},"Important"),": You must have performed the setup process outlined in ",Object(t.b)("a",Object(a.a)({parentName:"p"},{href:"../add-the-extension"}),"Add the Extension")," ",Object(t.b)("strong",{parentName:"p"},"and")," ",Object(t.b)("a",Object(a.a)({parentName:"p"},{href:"firebase-cloud-messaging"}),"Setup Firebase Cloud Messaging")," before performing these additional setup steps.")),Object(t.b)("p",null,Object(t.b)("em",{parentName:"p"},"Firebase In-App Messaging helps you engage your app's active users by sending them targeted, contextual messages that encourage them to use key app features. For example, you could send an in-app message to get users to subscribe, watch a video, complete a level, or buy an item. You can customize messages as cards, banners, modals, or images, and set up triggers so that they appear exactly when they'd benefit your users most.")),Object(t.b)("p",null,Object(t.b)("em",{parentName:"p"},"Use Firebase In-App Messaging to encourage exploration and discovery: highlight a sale or coupon in your ecommerce app, give clues or tips in your game, or prompt a like or share in your social media app.")),Object(t.b)("h2",{id:"required-anes"},"Required ANEs"),Object(t.b)("h3",{id:"android-support"},"Android Support"),Object(t.b)("p",null,"The Android Support libraries encompass the Android Support, Android X and common Google libraries. "),Object(t.b)("p",null,"These libraries are specific to Android. There are no issues including these on all platforms, they are just ",Object(t.b)("strong",{parentName:"p"},"required")," for Android."),Object(t.b)("p",null,"This extension requires the following additional extensions:"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-AndroidSupport/raw/master/lib/io.reactivex.ane"}),"io.reactivex")),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-AndroidSupport/raw/master/lib/io.grpc.ane"}),"io.grpc")),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-AndroidSupport/raw/master/lib/com.google.code.gson.ane"}),"com.google.code.gson")),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-AndroidSupport/raw/master/lib/com.google.guava.ane"}),"com.google.guava"))),Object(t.b)("p",null,"You can access these extensions here: ",Object(t.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/distriqt/ANE-AndroidSupport"}),"https://github.com/distriqt/ANE-AndroidSupport"),"."),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},Object(t.b)("strong",{parentName:"p"},"Note"),": if you have been using the older ",Object(t.b)("inlineCode",{parentName:"p"},"com.distriqt.androidsupport.*")," (Android Support) extensions you should remove these extensions and replace it with the ",Object(t.b)("inlineCode",{parentName:"p"},"androidx")," extensions listed above. This is the new version of the android support libraries and moving forward all our extensions will require AndroidX.")),Object(t.b)("h3",{id:"square-anes"},"Square ANEs"),Object(t.b)("p",null,"Due to several of our ANE's using the ",Object(t.b)("a",Object(a.a)({parentName:"p"},{href:"http://square.github.io/"}),"Square open source libraries")," the libraries have been separated into a separate ANEs allowing you to avoid conflicts and duplicate definitions. This means that you need to include the some of the square native extensions in your application along with this extension."),Object(t.b)("p",null,"You will add these extensions as you do with any other ANE, and you need to ensure it is packaged with your application."),Object(t.b)("p",null,"Firebase InAppMessaging requires the following Square extensions:"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-SquareLibs/raw/master/lib/com.distriqt.square.okhttp.ane"}),Object(t.b)("inlineCode",{parentName:"a"},"com.distriqt.square.okhttp"))),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-SquareLibs/raw/master/lib/com.distriqt.square.okhttp.ane"}),Object(t.b)("inlineCode",{parentName:"a"},"com.distriqt.square.okhttp3"))),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/distriqt/ANE-SquareLibs/raw/master/lib/com.distriqt.square.okhttp.ane"}),Object(t.b)("inlineCode",{parentName:"a"},"com.distriqt.square.picasso")))),Object(t.b)("p",null,"You can access these extensions here: ",Object(t.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/distriqt/ANE-SquareLibs"}),"https://github.com/distriqt/ANE-SquareLibs"),"."),Object(t.b)("h2",{id:"extension-ids"},"Extension IDs"),Object(t.b)("p",null,"The following should be added to your ",Object(t.b)("inlineCode",{parentName:"p"},"extensions")," node in your application descriptor to identify all the required ANEs in your application:"),Object(t.b)("pre",null,Object(t.b)("code",Object(a.a)({parentName:"pre"},{className:"language-xml"}),"<extensions>\n    <extensionID>com.distriqt.PushNotifications</extensionID>\n    <extensionID>com.distriqt.Core</extensionID>\n\n    <extensionID>com.distriqt.playservices.Base</extensionID>\n    <extensionID>com.distriqt.playservices.CloudMessaging</extensionID>\n\n    <extensionID>com.google.firebase.core</extensionID>\n    <extensionID>com.google.android.datatransport</extensionID>\n    <extensionID>com.google.dagger</extensionID>\n    <extensionID>com.google.protobuflite</extensionID>\n    <extensionID>androidx.core</extensionID>\n    <extensionID>androidx.browser</extensionID>\n    <extensionID>androidx.appcompat</extensionID>\n    <extensionID>androidx.cardview</extensionID>\n    <extensionID>androidx.constraintlayout</extensionID>\n    <extensionID>androidx.vectordrawable</extensionID>\n\n    <extensionID>com.distriqt.CustomResources</extensionID>\n\n\n    \x3c!-- InAppMessaging --\x3e\n    <extensionID>com.distriqt.square.okhttp</extensionID>\n    <extensionID>com.distriqt.square.okhttp3</extensionID>\n    <extensionID>com.distriqt.square.picasso</extensionID>\n\n    <extensionID>io.reactivex</extensionID>\n    <extensionID>io.grpc</extensionID>\n    <extensionID>com.google.code.gson</extensionID>\n    <extensionID>com.google.guava</extensionID>\n\n</extensions>\n")),Object(t.b)("h1",{id:"android"},"Android"),Object(t.b)("h2",{id:"manifest-additions"},"Manifest Additions"),Object(t.b)("p",null,"You must add all the Firebase related manifest additions along with several additions for Cloud Messaging and InApp Messaging. "),Object(t.b)("p",null,"You must replace ",Object(t.b)("inlineCode",{parentName:"p"},"APPLICATION_PACKAGE")," with your AIR application's Java package name, something like ",Object(t.b)("inlineCode",{parentName:"p"},"air.com.distriqt.test"),". Generally this is your AIR application id prefixed by ",Object(t.b)("inlineCode",{parentName:"p"},"air.")," unless you have specified no air flair in your build options."),Object(t.b)("p",null,"For InApp Messaging you will need to add the picasso provider:"),Object(t.b)("pre",null,Object(t.b)("code",Object(a.a)({parentName:"pre"},{className:"language-xml"}),'\x3c!-- picasso --\x3e\n<provider\n    android:name="com.squareup.picasso.PicassoProvider"\n    android:authorities="APPLICATION_PACKAGE.com.squareup.picasso"\n    android:exported="false" />\n')),Object(t.b)("p",null,"and update the component discovery service (see below) to include:"),Object(t.b)("pre",null,Object(t.b)("code",Object(a.a)({parentName:"pre"},{className:"language-xml"}),'<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.inappmessaging.display.FirebaseInAppMessagingDisplayRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.inappmessaging.FirebaseInAppMessagingRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.abt.component.AbtRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n')),Object(t.b)("p",null,"The following shows the complete manifest additions node."),Object(t.b)("pre",null,Object(t.b)("code",Object(a.a)({parentName:"pre"},{className:"language-xml"}),'<manifest android:installLocation="auto">\n    \n    <uses-permission android:name="android.permission.INTERNET" />\n    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />\n    <uses-permission android:name="android.permission.WAKE_LOCK" />\n    \n    \x3c!-- OPTIONAL --\x3e\n    <uses-permission android:name="android.permission.VIBRATE"/>\n    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />\n    \n    <uses-permission android:name="com.google.android.finsky.permission.BIND_GET_INSTALL_REFERRER_SERVICE" /> \n    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />\n    <permission android:name="APPLICATION_PACKAGE.permission.C2D_MESSAGE" android:protectionLevel="signature" />\n    <uses-permission android:name="APPLICATION_PACKAGE.permission.C2D_MESSAGE" />\n    \n    <application>\n        <meta-data android:name="com.google.android.gms.version" android:value="@integer/google_play_services_version" />\n\n        <activity android:name="com.google.android.gms.common.api.GoogleApiActivity" \n            android:theme="@android:style/Theme.Translucent.NoTitleBar" \n            android:exported="false"/>\n\n\n        \x3c!-- NOTIFICATIONS --\x3e\n        <receiver android:name="com.distriqt.extension.pushnotifications.notifications.receivers.NotificationReceiver">\n            <intent-filter>\n                <action android:name="APPLICATION_PACKAGE.NOTIFICATION_SELECTED" />\n                <action android:name="APPLICATION_PACKAGE.NOTIFICATION_DELETED" />\n                <action android:name="APPLICATION_PACKAGE.NOTIFICATION_ACTION" />\n                <data android:scheme="dtpn" />\n            </intent-filter>\n            <intent-filter>\n                <action android:name="android.intent.action.BOOT_COMPLETED" />\n            </intent-filter>\n        </receiver>\n        <provider\n            android:name="com.distriqt.extension.pushnotifications.content.FileProvider"\n            android:authorities="APPLICATION_PACKAGE.pushnotificationsfileprovider"\n            android:grantUriPermissions="true"\n            android:exported="false">\n            <meta-data\n                android:name="android.support.FILE_PROVIDER_PATHS"\n                android:resource="@xml/distriqt_pushnotifications_paths" />\n        </provider>\n\n\n\n\n\n        \x3c!-- FIREBASE INAPP MESSAGING --\x3e\n        \x3c!-- picasso --\x3e\n        <provider\n            android:name="com.squareup.picasso.PicassoProvider"\n            android:authorities="APPLICATION_PACKAGE.com.squareup.picasso"\n            android:exported="false" />\n        \n        \n\n\n        \x3c!-- FIREBASE CLOUD MESSAGING --\x3e\n        <meta-data android:name="com.google.firebase.messaging.default_notification_icon" android:resource="@drawable/ic_stat_distriqt" />\n        <meta-data android:name="com.google.firebase.messaging.default_notification_color" android:resource="@color/blue" />\n        <meta-data android:name="com.google.firebase.messaging.default_notification_channel_id" android:value="test_sound_res_channel"/>\n\n        <service android:name="com.distriqt.extension.pushnotifications.fcm.FcmMessagingService">\n            <intent-filter>\n                <action android:name="com.google.firebase.MESSAGING_EVENT"/>\n            </intent-filter>\n        </service>\n        <service\n            android:name="com.distriqt.extension.pushnotifications.fcm.FcmInstanceIDService"\n            android:exported="true">\n            <intent-filter>\n                <action android:name="com.google.firebase.INSTANCE_ID_EVENT"/>\n            </intent-filter>\n        </service>\n        <receiver\n            android:name="com.google.firebase.iid.FirebaseInstanceIdReceiver"\n            android:exported="true"\n            android:permission="com.google.android.c2dm.permission.SEND" >\n            <intent-filter>\n                <action android:name="com.google.android.c2dm.intent.RECEIVE" />\n            </intent-filter>\n        </receiver>\n\n\n\n        \x3c!-- FIREBASE CORE --\x3e\n        <receiver\n            android:name="com.google.android.gms.measurement.AppMeasurementReceiver"\n            android:enabled="true"\n            android:exported="false" >\n        </receiver>\n\n        <service\n            android:name="com.google.android.gms.measurement.AppMeasurementService"\n            android:enabled="true"\n            android:exported="false" />\n        <service\n            android:name="com.google.android.gms.measurement.AppMeasurementJobService"\n            android:enabled="true"\n            android:exported="false"\n            android:permission="android.permission.BIND_JOB_SERVICE" />\n        <service\n            android:name="com.google.firebase.components.ComponentDiscoveryService"\n            android:directBootAware="true"\n            android:exported="false" >\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.analytics.connector.internal.AnalyticsConnectorRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.installations.FirebaseInstallationsRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.dynamicloading.DynamicLoadingRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n\n            \x3c!-- Firebase Cloud Messaging --\x3e\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.iid.Registrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.messaging.FirebaseMessagingRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.datatransport.TransportRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n\n\n            \x3c!-- Firebase InAppMessaging --\x3e\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.inappmessaging.display.FirebaseInAppMessagingDisplayRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.inappmessaging.FirebaseInAppMessagingRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n            <meta-data\n                android:name="com.google.firebase.components:com.google.firebase.abt.component.AbtRegistrar"\n                android:value="com.google.firebase.components.ComponentRegistrar" />\n\n        </service>\n\n        <provider\n            android:name="com.google.firebase.provider.FirebaseInitProvider"\n            android:authorities="APPLICATION_PACKAGE.firebaseinitprovider"\n            android:exported="false"\n            android:initOrder="100" />\n\n\n        \x3c!-- datatransport --\x3e\n        <service\n            android:name="com.google.android.datatransport.runtime.backends.TransportBackendDiscovery"\n            android:exported="false" >\n            <meta-data\n                android:name="backend:com.google.android.datatransport.cct.CctBackendFactory"\n                android:value="cct" />\n        </service>\n        <service\n            android:name="com.google.android.datatransport.runtime.scheduling.jobscheduling.JobInfoSchedulerService"\n            android:exported="false"\n            android:permission="android.permission.BIND_JOB_SERVICE" >\n        </service>\n        <receiver\n            android:name="com.google.android.datatransport.runtime.scheduling.jobscheduling.AlarmManagerSchedulerBroadcastReceiver"\n            android:exported="false" />\n        \n\n    </application>\n    \n</manifest>\n')),Object(t.b)("h4",{id:"component-discovery-service"},"Component Discovery Service"),Object(t.b)("p",null,"The ",Object(t.b)("inlineCode",{parentName:"p"},"com.google.firebase.components.ComponentDiscoveryService")," is particularly important for Firebase configuration."),Object(t.b)("p",null,"The meta-data tags that are added to this service specify the components that should be initialised by Firebase and you must ensure that you have added the appropriate tags for the services you are using."),Object(t.b)("p",null,"Firebase Messaging depends on Analytics so you must at least include the following tags:"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"Analytics:")),Object(t.b)("pre",null,Object(t.b)("code",Object(a.a)({parentName:"pre"},{className:"language-xml"}),'<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.analytics.connector.internal.AnalyticsConnectorRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.installations.FirebaseInstallationsRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.dynamicloading.DynamicLoadingRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n')),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"Cloud Messaging (FCM):")),Object(t.b)("pre",null,Object(t.b)("code",Object(a.a)({parentName:"pre"},{className:"language-xml"}),'<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.iid.Registrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.messaging.FirebaseMessagingRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.datatransport.TransportRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n')),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"InApp Messaging:")),Object(t.b)("pre",null,Object(t.b)("code",Object(a.a)({parentName:"pre"},{className:"language-xml"}),'<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.inappmessaging.display.FirebaseInAppMessagingDisplayRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.inappmessaging.FirebaseInAppMessagingRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n<meta-data\n    android:name="com.google.firebase.components:com.google.firebase.abt.component.AbtRegistrar"\n    android:value="com.google.firebase.components.ComponentRegistrar" />\n')),Object(t.b)("h1",{id:"ios"},"iOS"),Object(t.b)("p",null,"Nothing additional required for iOS."))}p.isMDXComponent=!0},853:function(e,n,o){"use strict";o.d(n,"a",(function(){return m})),o.d(n,"b",(function(){return b}));var a=o(0),i=o.n(a);function t(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function r(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,a)}return o}function s(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function d(e,n){if(null==e)return{};var o,a,i=function(e,n){if(null==e)return{};var o,a,i={},t=Object.keys(e);for(a=0;a<t.length;a++)o=t[a],n.indexOf(o)>=0||(i[o]=e[o]);return i}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(a=0;a<t.length;a++)o=t[a],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var c=i.a.createContext({}),p=function(e){var n=i.a.useContext(c),o=n;return e&&(o="function"==typeof e?e(n):s(s({},n),e)),o},m=function(e){var n=p(e.components);return i.a.createElement(c.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return i.a.createElement(i.a.Fragment,{},n)}},g=i.a.forwardRef((function(e,n){var o=e.components,a=e.mdxType,t=e.originalType,r=e.parentName,c=d(e,["components","mdxType","originalType","parentName"]),m=p(o),g=a,b=m["".concat(r,".").concat(g)]||m[g]||l[g]||t;return o?i.a.createElement(b,s(s({ref:n},c),{},{components:o})):i.a.createElement(b,s({ref:n},c))}));function b(e,n){var o=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var t=o.length,r=new Array(t);r[0]=g;var s={};for(var d in n)hasOwnProperty.call(n,d)&&(s[d]=n[d]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var c=2;c<t;c++)r[c]=o[c];return i.a.createElement.apply(null,r)}return i.a.createElement.apply(null,o)}g.displayName="MDXCreateElement"}}]);